<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Dataframe manipulations | Data Analysis &amp; Visualization using R (1)</title>
  <meta name="description" content="This gitbook accompanies the course Data Analysis &amp; Visualization using R 1 (DAVuR1) of the minor Bioinformatics for Life Science Students. It is organized by the Hanze University of Applied Science." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Dataframe manipulations | Data Analysis &amp; Visualization using R (1)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This gitbook accompanies the course Data Analysis &amp; Visualization using R 1 (DAVuR1) of the minor Bioinformatics for Life Science Students. It is organized by the Hanze University of Applied Science." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Dataframe manipulations | Data Analysis &amp; Visualization using R (1)" />
  
  <meta name="twitter:description" content="This gitbook accompanies the course Data Analysis &amp; Visualization using R 1 (DAVuR1) of the minor Bioinformatics for Life Science Students. It is organized by the Hanze University of Applied Science." />
  

<meta name="author" content="Michiel Noback" />


<meta name="date" content="2020-03-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="scripting.html">
<link rel="next" href="exercises.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DAVuR eBook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Getting started</a></li>
<li class="chapter" data-level="2" data-path="toolbox.html"><a href="toolbox.html"><i class="fa fa-check"></i><b>2</b> The toolbox</a><ul>
<li class="chapter" data-level="2.1" data-path="toolbox.html"><a href="toolbox.html#why-do-statistical-programming"><i class="fa fa-check"></i><b>2.1</b> Why do statistical programming?</a></li>
<li class="chapter" data-level="2.2" data-path="toolbox.html"><a href="toolbox.html#overview-of-the-toolbox"><i class="fa fa-check"></i><b>2.2</b> Overview of the toolbox</a><ul>
<li class="chapter" data-level="2.2.1" data-path="toolbox.html"><a href="toolbox.html#tool-1-the-r-programming-language"><i class="fa fa-check"></i><b>2.2.1</b> Tool 1: The R programming language</a></li>
<li class="chapter" data-level="2.2.2" data-path="toolbox.html"><a href="toolbox.html#tool-2-rstudio-as-development-environment"><i class="fa fa-check"></i><b>2.2.2</b> Tool 2: RStudio as development environment</a></li>
<li class="chapter" data-level="2.2.3" data-path="toolbox.html"><a href="toolbox.html#tool-3-rmarkdown"><i class="fa fa-check"></i><b>2.2.3</b> Tool 3: RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="toolbox.html"><a href="toolbox.html#resources"><i class="fa fa-check"></i><b>2.3</b> Resources</a><ul>
<li class="chapter" data-level="2.3.1" data-path="toolbox.html"><a href="toolbox.html#swirl-course"><i class="fa fa-check"></i><b>2.3.1</b> Swirl course</a></li>
<li class="chapter" data-level="2.3.2" data-path="toolbox.html"><a href="toolbox.html#data-files"><i class="fa fa-check"></i><b>2.3.2</b> Data Files</a></li>
<li class="chapter" data-level="2.3.3" data-path="toolbox.html"><a href="toolbox.html#web-resources-and-references"><i class="fa fa-check"></i><b>2.3.3</b> Web resources and references</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html"><i class="fa fa-check"></i><b>3</b> Basic R - coding basics</a><ul>
<li class="chapter" data-level="3.1" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#first-look-at-vectors-fuctions-and-variables"><i class="fa fa-check"></i><b>3.1</b> First look at vectors, fuctions and variables</a><ul>
<li class="chapter" data-level="3.1.1" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#doing-math-in-the-console"><i class="fa fa-check"></i><b>3.1.1</b> Doing Math in the console</a></li>
<li class="chapter" data-level="3.1.2" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#an-expression-dissected"><i class="fa fa-check"></i><b>3.1.2</b> An expression dissected</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#functions"><i class="fa fa-check"></i><b>3.2</b> Functions</a><ul>
<li class="chapter" data-level="3.2.1" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#getting-help-on-a-function"><i class="fa fa-check"></i><b>3.2.1</b> Getting help on a function</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#variables"><i class="fa fa-check"></i><b>3.3</b> Variables</a></li>
<li class="chapter" data-level="3.4" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#vectors"><i class="fa fa-check"></i><b>3.4</b> Vectors</a><ul>
<li class="chapter" data-level="3.4.1" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#r-is-completely-vector-based"><i class="fa fa-check"></i><b>3.4.1</b> R is completely vector-based</a></li>
<li class="chapter" data-level="3.4.2" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#five-datatype-that-live-in-vectors"><i class="fa fa-check"></i><b>3.4.2</b> Five datatype that live in vectors</a></li>
<li class="chapter" data-level="3.4.3" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#creating-vectors"><i class="fa fa-check"></i><b>3.4.3</b> Creating vectors</a></li>
<li class="chapter" data-level="3.4.4" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#vector-fiddling"><i class="fa fa-check"></i><b>3.4.4</b> Vector fiddling</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#other-operators"><i class="fa fa-check"></i><b>3.5</b> Other operators</a><ul>
<li class="chapter" data-level="3.5.1" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#logical-operators"><i class="fa fa-check"></i><b>3.5.1</b> Logical operators</a></li>
<li class="chapter" data-level="3.5.2" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#modulo"><i class="fa fa-check"></i><b>3.5.2</b> Modulo: <code>%%</code></a></li>
<li class="chapter" data-level="3.5.3" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#integer-division-and-rounding"><i class="fa fa-check"></i><b>3.5.3</b> Integer division <code>%/%</code> and rounding</a></li>
<li class="chapter" data-level="3.5.4" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#the-in-operator"><i class="fa fa-check"></i><b>3.5.4</b> The <code>%in%</code> operator</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#vector-creation-methods"><i class="fa fa-check"></i><b>3.6</b> Vector creation methods</a></li>
<li class="chapter" data-level="3.7" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#selecting-vector-elements"><i class="fa fa-check"></i><b>3.7</b> Selecting vector elements</a></li>
<li class="chapter" data-level="3.8" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#some-coding-style-rules-rules-for-writing-code"><i class="fa fa-check"></i><b>3.8</b> Some coding style rules rules for writing code</a></li>
<li class="chapter" data-level="3.9" data-path="basic-r-coding-basics.html"><a href="basic-r-coding-basics.html#the-best-keyboard-shortcuts-for-rstudio"><i class="fa fa-check"></i><b>3.9</b> The best keyboard shortcuts for RStudio</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-r-plotting-basics.html"><a href="basic-r-plotting-basics.html"><i class="fa fa-check"></i><b>4</b> Basic R - plotting basics</a><ul>
<li class="chapter" data-level="4.1" data-path="basic-r-plotting-basics.html"><a href="basic-r-plotting-basics.html#basic-embedded-plot-types"><i class="fa fa-check"></i><b>4.1</b> Basic embedded plot types</a><ul>
<li class="chapter" data-level="4.1.1" data-path="basic-r-plotting-basics.html"><a href="basic-r-plotting-basics.html#scatter-and-line-plots"><i class="fa fa-check"></i><b>4.1.1</b> Scatter and line plots</a></li>
<li class="chapter" data-level="4.1.2" data-path="basic-r-plotting-basics.html"><a href="basic-r-plotting-basics.html#barplots"><i class="fa fa-check"></i><b>4.1.2</b> Barplots</a></li>
<li class="chapter" data-level="4.1.3" data-path="basic-r-plotting-basics.html"><a href="basic-r-plotting-basics.html#histograms"><i class="fa fa-check"></i><b>4.1.3</b> Histograms</a></li>
<li class="chapter" data-level="4.1.4" data-path="basic-r-plotting-basics.html"><a href="basic-r-plotting-basics.html#density-plot-as-alternative-to-hist"><i class="fa fa-check"></i><b>4.1.4</b> Density plot as alternative to <code>hist()</code></a></li>
<li class="chapter" data-level="4.1.5" data-path="basic-r-plotting-basics.html"><a href="basic-r-plotting-basics.html#boxplots"><i class="fa fa-check"></i><b>4.1.5</b> Boxplots</a></li>
<li class="chapter" data-level="4.1.6" data-path="basic-r-plotting-basics.html"><a href="basic-r-plotting-basics.html#adding-more-data-and-a-legend"><i class="fa fa-check"></i><b>4.1.6</b> Adding more data and a legend</a></li>
<li class="chapter" data-level="4.1.7" data-path="basic-r-plotting-basics.html"><a href="basic-r-plotting-basics.html#helper-lines-and-lm"><i class="fa fa-check"></i><b>4.1.7</b> Helper lines and <code>lm()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="basic-r-plotting-basics.html"><a href="basic-r-plotting-basics.html#graphical-parameters-to-plot"><i class="fa fa-check"></i><b>4.2</b> Graphical parameters to <code>plot()</code></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="complex-datatypes-and-file-reading.html"><a href="complex-datatypes-and-file-reading.html"><i class="fa fa-check"></i><b>5</b> Complex Datatypes and File Reading</a><ul>
<li class="chapter" data-level="5.1" data-path="complex-datatypes-and-file-reading.html"><a href="complex-datatypes-and-file-reading.html#matrices-are-vectors-with-dimensions"><i class="fa fa-check"></i><b>5.1</b> Matrices are vectors with dimensions</a></li>
<li class="chapter" data-level="5.2" data-path="complex-datatypes-and-file-reading.html"><a href="complex-datatypes-and-file-reading.html#factors-nominal-ordinal-scales"><i class="fa fa-check"></i><b>5.2</b> Factors: Nominal &amp; Ordinal scales</a></li>
<li class="chapter" data-level="5.3" data-path="complex-datatypes-and-file-reading.html"><a href="complex-datatypes-and-file-reading.html#lists"><i class="fa fa-check"></i><b>5.3</b> Lists</a></li>
<li class="chapter" data-level="5.4" data-path="complex-datatypes-and-file-reading.html"><a href="complex-datatypes-and-file-reading.html#dataframes"><i class="fa fa-check"></i><b>5.4</b> Dataframes</a><ul>
<li class="chapter" data-level="5.4.1" data-path="complex-datatypes-and-file-reading.html"><a href="complex-datatypes-and-file-reading.html#selections-on-dataframes"><i class="fa fa-check"></i><b>5.4.1</b> Selections on dataframes</a></li>
<li class="chapter" data-level="5.4.2" data-path="complex-datatypes-and-file-reading.html"><a href="complex-datatypes-and-file-reading.html#read-from-file-using-read.table"><i class="fa fa-check"></i><b>5.4.2</b> Read from file using <code>read.table()</code></a></li>
<li class="chapter" data-level="5.4.3" data-path="complex-datatypes-and-file-reading.html"><a href="complex-datatypes-and-file-reading.html#dataframe-manipulations"><i class="fa fa-check"></i><b>5.4.3</b> Dataframe manipulations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functions-1.html"><a href="functions-1.html"><i class="fa fa-check"></i><b>6</b> Functions</a><ul>
<li class="chapter" data-level="6.1" data-path="functions-1.html"><a href="functions-1.html#dealing-with-nas"><i class="fa fa-check"></i><b>6.1</b> Dealing with NAs</a></li>
<li class="chapter" data-level="6.2" data-path="functions-1.html"><a href="functions-1.html#descriptive-statistics"><i class="fa fa-check"></i><b>6.2</b> Descriptive statistics</a></li>
<li class="chapter" data-level="6.3" data-path="functions-1.html"><a href="functions-1.html#general-purpose-functions"><i class="fa fa-check"></i><b>6.3</b> General purpose functions</a></li>
<li class="chapter" data-level="6.4" data-path="functions-1.html"><a href="functions-1.html#convert-numeric-vector-to-factor-cut"><i class="fa fa-check"></i><b>6.4</b> Convert numeric vector to factor: <code>cut()</code></a></li>
<li class="chapter" data-level="6.5" data-path="functions-1.html"><a href="functions-1.html#file-io-revisited"><i class="fa fa-check"></i><b>6.5</b> File I/O revisited</a></li>
<li class="chapter" data-level="6.6" data-path="functions-1.html"><a href="functions-1.html#pattern-matching"><i class="fa fa-check"></i><b>6.6</b> Pattern matching</a><ul>
<li class="chapter" data-level="6.6.1" data-path="functions-1.html"><a href="functions-1.html#regex-syntax"><i class="fa fa-check"></i><b>6.6.1</b> Regex syntax</a></li>
<li class="chapter" data-level="6.6.2" data-path="functions-1.html"><a href="functions-1.html#quantifiers"><i class="fa fa-check"></i><b>6.6.2</b> Quantifiers</a></li>
<li class="chapter" data-level="6.6.3" data-path="functions-1.html"><a href="functions-1.html#some-examples"><i class="fa fa-check"></i><b>6.6.3</b> Some examples</a></li>
<li class="chapter" data-level="6.6.4" data-path="functions-1.html"><a href="functions-1.html#anchoring"><i class="fa fa-check"></i><b>6.6.4</b> Anchoring</a></li>
<li class="chapter" data-level="6.6.5" data-path="functions-1.html"><a href="functions-1.html#metacharacters-special-character-classes"><i class="fa fa-check"></i><b>6.6.5</b> Metacharacters: Special character classes</a></li>
<li class="chapter" data-level="6.6.6" data-path="functions-1.html"><a href="functions-1.html#locating-and-extracting"><i class="fa fa-check"></i><b>6.6.6</b> Locating and Extracting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="scripting.html"><a href="scripting.html"><i class="fa fa-check"></i><b>7</b> Scripting</a><ul>
<li class="chapter" data-level="7.1" data-path="scripting.html"><a href="scripting.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="scripting.html"><a href="scripting.html#flow-control"><i class="fa fa-check"></i><b>7.2</b> Flow control</a><ul>
<li class="chapter" data-level="7.2.1" data-path="scripting.html"><a href="scripting.html#conditional-execution-with-ifelse"><i class="fa fa-check"></i><b>7.2.1</b> Conditional execution with <code>if/else</code></a></li>
<li class="chapter" data-level="7.2.2" data-path="scripting.html"><a href="scripting.html#iteration-with-for"><i class="fa fa-check"></i><b>7.2.2</b> Iteration with <code>for(){}</code></a></li>
<li class="chapter" data-level="7.2.3" data-path="scripting.html"><a href="scripting.html#conditional-iteration-with-while"><i class="fa fa-check"></i><b>7.2.3</b> Conditional iteration with <code>while(){}</code></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="scripting.html"><a href="scripting.html#creating-functions"><i class="fa fa-check"></i><b>7.3</b> Creating functions</a><ul>
<li class="chapter" data-level="7.3.1" data-path="scripting.html"><a href="scripting.html#errors-and-warnings"><i class="fa fa-check"></i><b>7.3.1</b> Errors and warnings</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="scripting.html"><a href="scripting.html#scripting-1"><i class="fa fa-check"></i><b>7.4</b> Scripting</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html"><i class="fa fa-check"></i><b>8</b> Dataframe manipulations</a><ul>
<li class="chapter" data-level="8.1" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#the-apply-family-of-functions"><i class="fa fa-check"></i><b>8.1</b> The <code>apply()</code> family of functions</a><ul>
<li class="chapter" data-level="8.1.1" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#apply-apply-functions-over-array-margins"><i class="fa fa-check"></i><b>8.1.1</b> <code>apply()</code>: Apply Functions Over Array Margins</a></li>
<li class="chapter" data-level="8.1.2" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#lapply-apply-a-function-over-a-list-or-vector"><i class="fa fa-check"></i><b>8.1.2</b> <code>lapply()</code>: Apply a Function over a List or Vector</a></li>
<li class="chapter" data-level="8.1.3" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#sapply-apply-a-function-over-a-list-or-vector-and-simplify"><i class="fa fa-check"></i><b>8.1.3</b> <code>sapply()</code>: Apply a Function over a List or Vector and Simplify</a></li>
<li class="chapter" data-level="8.1.4" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#tapply-apply-a-function-over-a-ragged-array"><i class="fa fa-check"></i><b>8.1.4</b> <code>tapply()</code>: Apply a Function Over a Ragged Array</a></li>
<li class="chapter" data-level="8.1.5" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#split-divide-into-groups-and-reassemble"><i class="fa fa-check"></i><b>8.1.5</b> <code>split()</code>: Divide into Groups and Reassemble</a></li>
<li class="chapter" data-level="8.1.6" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#aggregate-compute-summary-statistics-of-data-subsets"><i class="fa fa-check"></i><b>8.1.6</b> <code>aggregate()</code>: Compute Summary Statistics of Data Subsets</a></li>
<li class="chapter" data-level="8.1.7" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#many-roads-lead-to-rome"><i class="fa fa-check"></i><b>8.1.7</b> Many roads lead to Rome</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#usecases"><i class="fa fa-check"></i><b>8.2</b> Example Use Cases</a><ul>
<li class="chapter" data-level="8.2.1" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#dfselection"><i class="fa fa-check"></i><b>8.2.1</b> Dataframe Selections</a></li>
<li class="chapter" data-level="8.2.2" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#apply"><i class="fa fa-check"></i><b>8.2.2</b> Apply</a></li>
<li class="chapter" data-level="8.2.3" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#embeddeddf"><i class="fa fa-check"></i><b>8.2.3</b> Processing Embedded Dataframes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>9</b> Exercises</a><ul>
<li class="chapter" data-level="9.1" data-path="exercises.html"><a href="exercises.html#basic-r"><i class="fa fa-check"></i><b>9.1</b> Basic R</a><ul>
<li class="chapter" data-level="9.1.1" data-path="exercises.html"><a href="exercises.html#math-in-the-console"><i class="fa fa-check"></i><b>9.1.1</b> Math in the console</a></li>
<li class="chapter" data-level="9.1.2" data-path="exercises.html"><a href="exercises.html#first-look-at-functions"><i class="fa fa-check"></i><b>9.1.2</b> First look at functions</a></li>
<li class="chapter" data-level="9.1.3" data-path="exercises.html"><a href="exercises.html#variables-1"><i class="fa fa-check"></i><b>9.1.3</b> Variables</a></li>
<li class="chapter" data-level="" data-path="exercises.html"><a href="exercises.html#plotting-rules"><i class="fa fa-check"></i>Plotting rules</a></li>
<li class="chapter" data-level="9.1.4" data-path="exercises.html"><a href="exercises.html#stair-walking-and-heart-rate"><i class="fa fa-check"></i><b>9.1.4</b> Stair walking and heart rate</a></li>
<li class="chapter" data-level="9.1.5" data-path="exercises.html"><a href="exercises.html#more-subjects"><i class="fa fa-check"></i><b>9.1.5</b> More subjects</a></li>
<li class="chapter" data-level="9.1.6" data-path="exercises.html"><a href="exercises.html#chickens-on-a-diet"><i class="fa fa-check"></i><b>9.1.6</b> Chickens on a diet</a></li>
<li class="chapter" data-level="9.1.7" data-path="exercises.html"><a href="exercises.html#chicken-bar-plot"><i class="fa fa-check"></i><b>9.1.7</b> Chicken bar plot</a></li>
<li class="chapter" data-level="9.1.8" data-path="exercises.html"><a href="exercises.html#discoveries"><i class="fa fa-check"></i><b>9.1.8</b> Discoveries</a></li>
<li class="chapter" data-level="9.1.9" data-path="exercises.html"><a href="exercises.html#lung-cancer"><i class="fa fa-check"></i><b>9.1.9</b> Lung cancer</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="exercises.html"><a href="exercises.html#complex-datatypes"><i class="fa fa-check"></i><b>9.2</b> Complex datatypes</a><ul>
<li class="chapter" data-level="9.2.1" data-path="exercises.html"><a href="exercises.html#creating-factors"><i class="fa fa-check"></i><b>9.2.1</b> Creating factors</a></li>
<li class="chapter" data-level="9.2.2" data-path="exercises.html"><a href="exercises.html#a-dictionary-with-a-named-vector"><i class="fa fa-check"></i><b>9.2.2</b> A dictionary with a named vector</a></li>
<li class="chapter" data-level="9.2.3" data-path="exercises.html"><a href="exercises.html#airquality"><i class="fa fa-check"></i><b>9.2.3</b> airquality</a></li>
<li class="chapter" data-level="9.2.4" data-path="exercises.html"><a href="exercises.html#bird-observations"><i class="fa fa-check"></i><b>9.2.4</b> Bird observations</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="exercises.html"><a href="exercises.html#regular-expressions"><i class="fa fa-check"></i><b>9.3</b> Regular Expressions</a><ul>
<li class="chapter" data-level="9.3.1" data-path="exercises.html"><a href="exercises.html#restriction-enzymes-1"><i class="fa fa-check"></i><b>9.3.1</b> Restriction enzymes</a></li>
<li class="chapter" data-level="9.3.2" data-path="exercises.html"><a href="exercises.html#prosite-patterns-1"><i class="fa fa-check"></i><b>9.3.2</b> Prosite Patterns</a></li>
<li class="chapter" data-level="9.3.3" data-path="exercises.html"><a href="exercises.html#fasta-headers"><i class="fa fa-check"></i><b>9.3.3</b> Fasta Headers</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="exercises.html"><a href="exercises.html#scripting-2"><i class="fa fa-check"></i><b>9.4</b> Scripting</a><ul>
<li class="chapter" data-level="9.4.1" data-path="exercises.html"><a href="exercises.html#illegal-reproductions"><i class="fa fa-check"></i><b>9.4.1</b> Illegal reproductions</a></li>
<li class="chapter" data-level="9.4.2" data-path="exercises.html"><a href="exercises.html#interquantile-ranges"><i class="fa fa-check"></i><b>9.4.2</b> Interquantile ranges</a></li>
<li class="chapter" data-level="9.4.3" data-path="exercises.html"><a href="exercises.html#vector-distance"><i class="fa fa-check"></i><b>9.4.3</b> Vector distance</a></li>
<li class="chapter" data-level="9.4.4" data-path="exercises.html"><a href="exercises.html#gc-percentage-of-dna"><i class="fa fa-check"></i><b>9.4.4</b> G/C percentage of DNA</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="exercises.html"><a href="exercises.html#function-apply-and-its-relatives"><i class="fa fa-check"></i><b>9.5</b> Function <code>apply</code> and its relatives</a><ul>
<li class="chapter" data-level="9.5.1" data-path="exercises.html"><a href="exercises.html#whale-selenium"><i class="fa fa-check"></i><b>9.5.1</b> Whale selenium</a></li>
<li class="chapter" data-level="9.5.2" data-path="exercises.html"><a href="exercises.html#chickweight"><i class="fa fa-check"></i><b>9.5.2</b> ChickWeight</a></li>
<li class="chapter" data-level="9.5.3" data-path="exercises.html"><a href="exercises.html#food-constituents"><i class="fa fa-check"></i><b>9.5.3</b> Food constituents</a></li>
<li class="chapter" data-level="9.5.4" data-path="exercises.html"><a href="exercises.html#bird-observations-revisited"><i class="fa fa-check"></i><b>9.5.4</b> Bird observations revisited</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="exercise-solutions.html"><a href="exercise-solutions.html"><i class="fa fa-check"></i><b>10</b> Exercise solutions</a><ul>
<li class="chapter" data-level="10.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#basic-r-1"><i class="fa fa-check"></i><b>10.1</b> Basic R</a><ul>
<li class="chapter" data-level="10.1.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#math-in-the-console-1"><i class="fa fa-check"></i><b>10.1.1</b> Math in the console</a></li>
<li class="chapter" data-level="10.1.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#first-look-at-functions-1"><i class="fa fa-check"></i><b>10.1.2</b> First look at functions</a></li>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#plotting-rules-1"><i class="fa fa-check"></i>Plotting rules</a></li>
<li class="chapter" data-level="10.1.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#stair-walking-and-heart-rate-1"><i class="fa fa-check"></i><b>10.1.3</b> Stair walking and heart rate</a></li>
<li class="chapter" data-level="10.1.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#more-subjects-1"><i class="fa fa-check"></i><b>10.1.4</b> More subjects</a></li>
<li class="chapter" data-level="10.1.5" data-path="exercise-solutions.html"><a href="exercise-solutions.html#chickens-on-a-diet-1"><i class="fa fa-check"></i><b>10.1.5</b> Chickens on a diet</a></li>
<li class="chapter" data-level="10.1.6" data-path="exercise-solutions.html"><a href="exercise-solutions.html#chicken-bar-plot-1"><i class="fa fa-check"></i><b>10.1.6</b> Chicken bar plot</a></li>
<li class="chapter" data-level="10.1.7" data-path="exercise-solutions.html"><a href="exercise-solutions.html#discoveries-1"><i class="fa fa-check"></i><b>10.1.7</b> Discoveries</a></li>
<li class="chapter" data-level="10.1.8" data-path="exercise-solutions.html"><a href="exercise-solutions.html#lung-cancer-1"><i class="fa fa-check"></i><b>10.1.8</b> Lung cancer</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#complex-datatypes-1"><i class="fa fa-check"></i><b>10.2</b> Complex datatypes</a><ul>
<li class="chapter" data-level="10.2.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#creating-factors-1"><i class="fa fa-check"></i><b>10.2.1</b> Creating factors</a></li>
<li class="chapter" data-level="10.2.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#a-dictionary-with-a-named-vector-1"><i class="fa fa-check"></i><b>10.2.2</b> A dictionary with a named vector</a></li>
<li class="chapter" data-level="10.2.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#airquality-1"><i class="fa fa-check"></i><b>10.2.3</b> airquality</a></li>
<li class="chapter" data-level="10.2.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#bird-observations-1"><i class="fa fa-check"></i><b>10.2.4</b> Bird observations</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#regular-expressions-1"><i class="fa fa-check"></i><b>10.3</b> Regular Expressions</a><ul>
<li class="chapter" data-level="10.3.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#restriction-enzymes-2"><i class="fa fa-check"></i><b>10.3.1</b> Restriction enzymes</a></li>
<li class="chapter" data-level="10.3.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#prosite-patterns-2"><i class="fa fa-check"></i><b>10.3.2</b> Prosite Patterns</a></li>
<li class="chapter" data-level="10.3.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#fasta-headers-1"><i class="fa fa-check"></i><b>10.3.3</b> Fasta Headers</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#scripting-3"><i class="fa fa-check"></i><b>10.4</b> Scripting</a><ul>
<li class="chapter" data-level="10.4.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#illegal-reproductions-1"><i class="fa fa-check"></i><b>10.4.1</b> Illegal reproductions</a></li>
<li class="chapter" data-level="10.4.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#interquantile-ranges-1"><i class="fa fa-check"></i><b>10.4.2</b> Interquantile ranges</a></li>
<li class="chapter" data-level="10.4.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#vector-distance-1"><i class="fa fa-check"></i><b>10.4.3</b> Vector distance</a></li>
<li class="chapter" data-level="10.4.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#gc-percentage-of-dna-1"><i class="fa fa-check"></i><b>10.4.4</b> G/C percentage of DNA</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="exercise-solutions.html"><a href="exercise-solutions.html#function-apply-and-its-relatives-1"><i class="fa fa-check"></i><b>10.5</b> Function <code>apply</code> and its relatives</a><ul>
<li class="chapter" data-level="10.5.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#whale-selenium-1"><i class="fa fa-check"></i><b>10.5.1</b> Whale selenium</a></li>
<li class="chapter" data-level="10.5.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#chickweight-1"><i class="fa fa-check"></i><b>10.5.2</b> ChickWeight</a></li>
<li class="chapter" data-level="10.5.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#food-constituents-1"><i class="fa fa-check"></i><b>10.5.3</b> Food constituents</a></li>
<li class="chapter" data-level="10.5.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#bird-observations-revisited-1"><i class="fa fa-check"></i><b>10.5.4</b> Bird observations revisited</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis &amp; Visualization using R (1)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dataframe-manipulations-1" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Dataframe manipulations</h1>
<p>Dataframes are ubiquitous in R-based data analyses. Many R functions and packages are tailored specifically for DF manipulations - you have already seen <code>cbind()</code>, <code>rbind()</code> and <code>subset()</code>.<br />
In this presentation, we’ll explore a few new functions and techniques for working with DFs:</p>
<ul>
<li><code>apply()</code></li>
<li><code>lapply()</code></li>
<li><code>sapply()</code></li>
<li><code>tapply()</code></li>
<li><code>aggregate()</code></li>
<li><code>split()</code></li>
</ul>
<div id="the-apply-family-of-functions" class="section level2">
<h2><span class="header-section-number">8.1</span> The <code>apply()</code> family of functions</h2>
<p>Looping with <code>for</code> may be tempting, but highly discouraged in R because its inefficient. Ususally one of these functions will do it better:</p>
<ul>
<li><code>apply</code>: Apply a function over the “margins” of a dataframe - rows or columns or both</li>
<li><code>lapply</code>: Loop over a list and evaluate a function on each element; returns a list of the same length</li>
<li><code>sapply</code>: Same as lapply but try to simplify the result</li>
<li><code>tapply</code>: Apply a function over subsets of a vector (read: split with a factor)</li>
</ul>
<p>There are more but these are the important ones.</p>
<div id="apply-apply-functions-over-array-margins" class="section level3">
<h3><span class="header-section-number">8.1.1</span> <code>apply()</code>: Apply Functions Over Array Margins</h3>
<ul>
<li>Suppose you want to know the means of all columns of a dataframe.</li>
<li><code>apply()</code> needs to know
<ol style="list-style-type: decimal">
<li>what DF to apply to (<code>X</code>)</li>
<li>over which margin(s) - columns and/or rows (<code>MARGIN</code>)</li>
<li>what function to apply (<code>FUN</code>)</li>
</ol></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(<span class="dt">X =</span> cars, <span class="dt">MARGIN =</span> <span class="dv">2</span>, <span class="dt">FUN =</span> mean) <span class="co"># apply over columns</span></code></pre>
<pre><code>## speed  dist 
## 15.40 42.98</code></pre>
<p>Here, a function is applied to both columns and rows</p>
<pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">y =</span> <span class="dv">6</span><span class="op">:</span><span class="dv">10</span>)
minus_one_squared &lt;-<span class="st"> </span><span class="cf">function</span>(x) (x<span class="dv">-1</span>)<span class="op">^</span><span class="dv">2</span>
<span class="kw">apply</span>(<span class="dt">X =</span> df, <span class="dt">MARGIN =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">FUN =</span> minus_one_squared)</code></pre>
<pre><code>##       x  y
## [1,]  0 25
## [2,]  1 36
## [3,]  4 49
## [4,]  9 64
## [5,] 16 81</code></pre>
<p>(Ok, that was a bit lame: <code>minus_one_squared(df)</code> does the same)</p>
<p>The Body Mass Index, or BMI, is calculated as <span class="math inline">\((weight / height ^ 2) * 703\)</span> where weight is in pounds and height in inches. Here it is calculated for the build in dataset <code>women</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(women, <span class="dt">n=</span><span class="dv">3</span>)</code></pre>
<pre><code>##   height weight
## 1     58    115
## 2     59    117
## 3     60    120</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">women<span class="op">$</span>bmi &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="dt">X =</span> women, 
                   <span class="dt">MARGIN =</span> <span class="dv">1</span>, 
                   <span class="dt">FUN =</span> <span class="cf">function</span>(x) (x[<span class="dv">2</span>] <span class="op">/</span><span class="st"> </span>x[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="dv">703</span>)
<span class="kw">head</span>(women, <span class="dt">n=</span><span class="dv">4</span>)</code></pre>
<pre><code>##   height weight   bmi
## 1     58    115 24.03
## 2     59    117 23.63
## 3     60    120 23.43
## 4     61    123 23.24</code></pre>
<div id="pass-arguments-to-the-applied-function" class="section level4 unnumbered">
<h4>Pass arguments to the applied function</h4>
<p>Sometimes the applied function needs to have other arguments passed besides the row or column. The <code>...</code> argument to <code>apply()</code> makes this possible (type <code>?apply</code> to see more info)</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># function sums and powers up</span>
spwr &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">p =</span> <span class="dv">2</span>) {<span class="kw">sum</span>(x)<span class="op">^</span>p}
<span class="co"># a simple dataframe</span>
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">b =</span> <span class="dv">6</span><span class="op">:</span><span class="dv">10</span>)
df</code></pre>
<pre><code>##   a  b
## 1 1  6
## 2 2  7
## 3 3  8
## 4 4  9
## 5 5 10</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># spwr will use the default value for p (p = 2)</span>
<span class="kw">apply</span>(<span class="dt">X =</span> df, <span class="dt">MARGIN =</span> <span class="dv">1</span>, <span class="dt">FUN =</span> spwr) </code></pre>
<pre><code>## [1]  49  81 121 169 225</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># pass power p = 3 to function spwr (argument names omitted)</span>
<span class="kw">apply</span>(df, <span class="dv">1</span>, spwr, <span class="dt">p =</span> <span class="dv">3</span>) </code></pre>
<pre><code>## [1]  343  729 1331 2197 3375</code></pre>
<p>Note: The <code>...</code> argument works for all <code>..apply..</code> functions.</p>
</div>
</div>
<div id="lapply-apply-a-function-over-a-list-or-vector" class="section level3">
<h3><span class="header-section-number">8.1.2</span> <code>lapply()</code>: Apply a Function over a List or Vector</h3>
<p>Function <code>lapply()</code> applies a function to all elements of a list and returns a list with the same length, each element the result of applying the function</p>
<pre class="sourceCode r"><code class="sourceCode r">myNumbers =<span class="st"> </span><span class="kw">list</span>(
    <span class="dt">one =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>), 
    <span class="dt">two =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">1</span>), 
    <span class="dt">three =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">9</span>))
<span class="kw">lapply</span>(<span class="dt">X =</span> myNumbers, <span class="dt">FUN =</span> mean)</code></pre>
<pre><code>## $one
## [1] 2.667
## 
## $two
## [1] 3
## 
## $three
## [1] 7</code></pre>
<p>Here is the same list, but now with <code>sqrt()</code> applied. Notice how the nature of the applied function influences the result.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lapply</span>(<span class="dt">X =</span> myNumbers, <span class="dt">FUN =</span> sqrt)</code></pre>
<pre><code>## $one
## [1] 1.000 1.732 2.000
## 
## $two
## [1] 1.732 1.414 2.449 1.000
## 
## $three
## [1] 2.236 2.646 2.449 2.828 3.000</code></pre>
</div>
<div id="sapply-apply-a-function-over-a-list-or-vector-and-simplify" class="section level3">
<h3><span class="header-section-number">8.1.3</span> <code>sapply()</code>: Apply a Function over a List or Vector and Simplify</h3>
<p>When using the same example as above, but with <code>sapply</code>, you get a vector returned. Note that the resulting vector is a named vector, a convenient feature of <code>sapply</code></p>
<pre class="sourceCode r"><code class="sourceCode r">myNumbers =<span class="st"> </span><span class="kw">list</span>(
    <span class="dt">one =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>),
    <span class="dt">two =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">1</span>),
    <span class="dt">three =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">9</span>))
<span class="kw">sapply</span>(<span class="dt">X =</span> myNumbers, <span class="dt">FUN =</span> mean)</code></pre>
<pre><code>##   one   two three 
## 2.667 3.000 7.000</code></pre>
<p>When the result can not be simplified, you get the same list as with <code>lapply()</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(<span class="dt">X =</span> myNumbers, <span class="dt">FUN =</span> sqrt)</code></pre>
<pre><code>## $one
## [1] 1.000 1.732 2.000
## 
## $two
## [1] 1.732 1.414 2.449 1.000
## 
## $three
## [1] 2.236 2.646 2.449 2.828 3.000</code></pre>
<div id="wasnt-a-dataframe-also-a-list" class="section level4">
<h4><span class="header-section-number">8.1.3.1</span> wasn’t a dataframe also a list?</h4>
<p>Yes! It is also list(ish). Both <code>lapply()</code> and <code>sapply()</code> work just fine on dataframes:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lapply</span>(<span class="dt">X =</span> cars, <span class="dt">FUN =</span> mean)</code></pre>
<pre><code>## $speed
## [1] 15.4
## 
## $dist
## [1] 42.98</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(<span class="dt">X =</span> cars, <span class="dt">FUN =</span> mean) </code></pre>
<pre><code>## speed  dist 
## 15.40 42.98</code></pre>
<p>By the way, sapply and lapply also work with vectors.</p>
</div>
</div>
<div id="tapply-apply-a-function-over-a-ragged-array" class="section level3">
<h3><span class="header-section-number">8.1.4</span> <code>tapply()</code>: Apply a Function Over a Ragged Array</h3>
<p>What <code>tapply()</code> does is apply a function over subsets of a vector; it splits a vector into groups according to the levels in a second vector and applies the given function to each group.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(<span class="dt">X =</span> chickwts<span class="op">$</span>weight, <span class="dt">INDEX =</span> chickwts<span class="op">$</span>feed, <span class="dt">FUN =</span> sd)</code></pre>
<pre><code>##    casein horsebean   linseed  meatmeal   soybean sunflower 
##     64.43     38.63     52.24     64.90     54.13     48.84</code></pre>
</div>
<div id="split-divide-into-groups-and-reassemble" class="section level3">
<h3><span class="header-section-number">8.1.5</span> <code>split()</code>: Divide into Groups and Reassemble</h3>
<p>This is similar to <code>tapply()</code> in the sense that is uses a factor to split its first argument. But where <code>tapply()</code> splits a vector, <code>split()</code> splits a dataframe - into <em>list of dataframes</em>.
You use <code>split()</code> when a dataframe needs to be divided depending on the value of some grouping variable.<br />
Here we have the response of Treated (T) and Untreated (UT) subjects</p>
<pre class="sourceCode r"><code class="sourceCode r">myData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
    <span class="dt">response =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">2</span>),
    <span class="dt">treatment =</span> <span class="kw">factor</span>(
        <span class="kw">c</span>(<span class="st">&quot;UT&quot;</span>, <span class="st">&quot;T&quot;</span>, <span class="st">&quot;UT&quot;</span>, <span class="st">&quot;UT&quot;</span>, <span class="st">&quot;T&quot;</span>, <span class="st">&quot;UT&quot;</span>, <span class="st">&quot;T&quot;</span>, <span class="st">&quot;T&quot;</span>, <span class="st">&quot;UT&quot;</span>, <span class="st">&quot;T&quot;</span>, <span class="st">&quot;T&quot;</span>, <span class="st">&quot;UT&quot;</span>)))
splData &lt;-<span class="st"> </span><span class="kw">split</span>(<span class="dt">x =</span> myData, <span class="dt">f =</span> myData<span class="op">$</span>treatment)
<span class="kw">str</span>(splData)</code></pre>
<pre><code>## List of 2
##  $ T :&#39;data.frame&#39;:  6 obs. of  2 variables:
##   ..$ response : num [1:6] 8 9 6 7 6 5
##   ..$ treatment: Factor w/ 2 levels &quot;T&quot;,&quot;UT&quot;: 1 1 1 1 1 1
##  $ UT:&#39;data.frame&#39;:  6 obs. of  2 variables:
##   ..$ response : num [1:6] 5 4 5 3 3 2
##   ..$ treatment: Factor w/ 2 levels &quot;T&quot;,&quot;UT&quot;: 2 2 2 2 2 2</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(splData<span class="op">$</span>T<span class="op">$</span>response, splData<span class="op">$</span>UT<span class="op">$</span>response, 
        <span class="dt">names =</span> <span class="kw">c</span>(<span class="st">&quot;Treated&quot;</span>, <span class="st">&quot;Untreated&quot;</span>))</code></pre>
<p><img src="davur_ebook_files/figure-html/split_demo1-1.png" width="672" /></p>
<p>Note that this trivial example could also have been done with <code>boxplot(myData$response ~ myData$treatment)</code>.</p>
<p>Here you can see that <code>split()</code> also works with vectors.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">split</span>(<span class="dt">x =</span> <span class="kw">rnorm</span>(<span class="dv">10</span>), <span class="dt">f =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;sick&quot;</span>, <span class="st">&quot;healthy&quot;</span>), <span class="dt">each=</span><span class="dv">5</span>))</code></pre>
<pre><code>## $healthy
## [1] -0.35028  1.37414 -0.29972  0.09764  0.38119
## 
## $sick
## [1]  1.1886  1.0599  1.3368 -0.3672 -0.3043</code></pre>
</div>
<div id="aggregate-compute-summary-statistics-of-data-subsets" class="section level3">
<h3><span class="header-section-number">8.1.6</span> <code>aggregate()</code>: Compute Summary Statistics of Data Subsets</h3>
<p>Splits the data into subsets, computes summary statistics for each, and returns the result in a convenient form.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">aggregate</span>(<span class="dt">formula =</span> Temp <span class="op">~</span><span class="st"> </span>Month, <span class="dt">data =</span> airquality, <span class="dt">FUN =</span> mean)</code></pre>
<pre><code>##       Month  Temp
## 1       May 65.55
## 2      June 79.10
## 3      July 83.90
## 4    August 83.97
## 5 September 76.90</code></pre>
<p>Aggregate has two usage techniques:</p>
<ul>
<li><p>with a formula:<br />
<strong><code>aggregate(formula, data, FUN, ...)</code></strong></p></li>
<li><p>with a list:<br />
<strong><code>aggregate(x, by, FUN, ...)</code></strong></p></li>
</ul>
<p>I really like <code>aggregate()</code>, especially the first form. That is, until I got to know the <code>dplyr</code> package.</p>
<p>Both forms of <code>aggregate()</code> will be demonstrated</p>
<div id="aggregate-with-formula" class="section level4 unnumbered">
<h4>Aggregate with formula</h4>
<p>The left part of the formula accepts one, several or all columns as dependent variables.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">##two dependents</span>
<span class="kw">aggregate</span>(<span class="kw">cbind</span>(Temp, Ozone) <span class="op">~</span><span class="st"> </span>Month, <span class="dt">data =</span> airquality, <span class="dt">FUN =</span> mean)</code></pre>
<pre><code>##       Month  Temp Ozone
## 1       May 66.73 23.62
## 2      June 78.22 29.44
## 3      July 83.88 59.12
## 4    August 83.96 59.96
## 5 September 76.90 31.45</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">##all</span>
<span class="kw">aggregate</span>(. <span class="op">~</span><span class="st"> </span>Month, <span class="dt">data =</span> airquality, <span class="dt">FUN =</span> mean)</code></pre>
<pre><code>##       Month Ozone Solar.R   Wind  Temp   Day foo    bar
## 1       May 24.12   182.0 11.504 66.46 16.08   1 0.3333
## 2      June 29.44   184.2 12.178 78.22 14.33   1 0.3333
## 3      July 59.12   216.4  8.523 83.88 16.23   1 0.8077
## 4    August 60.00   173.1  8.861 83.70 17.17   1 0.6957
## 5 September 31.45   168.2 10.076 76.90 15.10   1 0.3448</code></pre>
<p>The right part can also accept multiple independent variables</p>
<pre class="sourceCode r"><code class="sourceCode r">airquality<span class="op">$</span>Temp_factor &lt;-<span class="st"> </span><span class="kw">cut</span>(airquality<span class="op">$</span>Temp, <span class="dt">breaks =</span> <span class="dv">2</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>))
<span class="kw">aggregate</span>(Ozone <span class="op">~</span><span class="st"> </span>Month <span class="op">+</span><span class="st"> </span>Temp_factor, <span class="dt">data =</span> airquality, <span class="dt">FUN =</span> mean)</code></pre>
<pre><code>##        Month Temp_factor Ozone
## 1        May         low 18.92
## 2       June         low 20.50
## 3       July         low 13.00
## 4     August         low 16.00
## 5  September         low 17.62
## 6        May        high 80.00
## 7       June        high 36.60
## 8       July        high 62.96
## 9     August        high 63.62
## 10 September        high 48.46</code></pre>
</div>
<div id="the-by-list...-form" class="section level4 unnumbered">
<h4>The <code>by = list(...)</code> form</h4>
<p>This is the other form of aggregate. It is more elaborate in my opinion because you need te spell out all vectors you want to work on.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">aggregate</span>(<span class="dt">x =</span> chickwts<span class="op">$</span>weight, <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">feed =</span> chickwts<span class="op">$</span>feed), <span class="dt">FUN =</span> mean)</code></pre>
<pre><code>##        feed     x
## 1    casein 323.6
## 2 horsebean 160.2
## 3   linseed 218.8
## 4  meatmeal 276.9
## 5   soybean 246.4
## 6 sunflower 328.9</code></pre>
<p>Here is another example:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">aggregate</span>(<span class="dt">x =</span> airquality<span class="op">$</span>Wind, 
          <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">month =</span> airquality<span class="op">$</span>Month, <span class="dt">temperature =</span> airquality<span class="op">$</span>Temp_factor), 
          <span class="dt">FUN =</span> mean)</code></pre>
<pre><code>##        month temperature      x
## 1        May         low 11.714
## 2       June         low  9.855
## 3       July         low 10.600
## 4     August         low 11.433
## 5  September         low 11.394
## 6        May        high 10.300
## 7       June        high 10.505
## 8       July        high  8.828
## 9     August        high  8.511
## 10 September        high  8.793</code></pre>
<p>But it is better to wrap it in <code>with()</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(airquality, <span class="kw">aggregate</span>(<span class="dt">x =</span> Wind, 
                           <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">month =</span> Month, <span class="dt">temperature =</span> Temp_factor), 
                           <span class="dt">FUN =</span> mean))</code></pre>
</div>
</div>
<div id="many-roads-lead-to-rome" class="section level3">
<h3><span class="header-section-number">8.1.7</span> Many roads lead to Rome</h3>
<p>The next series of examples are all essentially the same. The message is: there is more than one way to do it!</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">aggregate</span>(weight <span class="op">~</span><span class="st"> </span>feed, <span class="dt">data =</span> chickwts, <span class="dt">FUN =</span> mean)</code></pre>
<pre><code>##        feed weight
## 1    casein  323.6
## 2 horsebean  160.2
## 3   linseed  218.8
## 4  meatmeal  276.9
## 5   soybean  246.4
## 6 sunflower  328.9</code></pre>
<p>same as</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">aggregate</span>(<span class="dt">x =</span> chickwts<span class="op">$</span>weight, <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">feed =</span> chickwts<span class="op">$</span>feed), <span class="dt">FUN =</span> mean), <span class="dt">n=</span><span class="dv">3</span>)</code></pre>
<pre><code>##        feed     x
## 1    casein 323.6
## 2 horsebean 160.2
## 3   linseed 218.8</code></pre>
<p>same as</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(chickwts<span class="op">$</span>weight, chickwts<span class="op">$</span>feed, mean)</code></pre>
<pre><code>##    casein horsebean   linseed  meatmeal   soybean sunflower 
##     323.6     160.2     218.8     276.9     246.4     328.9</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(chickwts, <span class="kw">tapply</span>(weight, feed, mean))</code></pre>
<pre><code>##    casein horsebean   linseed  meatmeal   soybean sunflower 
##     323.6     160.2     218.8     276.9     246.4     328.9</code></pre>
<p>same as</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(<span class="kw">split</span>(chickwts, chickwts<span class="op">$</span>feed), <span class="cf">function</span>(x){<span class="kw">mean</span>(x<span class="op">$</span>weight)})</code></pre>
<pre><code>##    casein horsebean   linseed  meatmeal   soybean sunflower 
##     323.6     160.2     218.8     276.9     246.4     328.9</code></pre>
<p>And this is the topic of the next course:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">group_by</span>(chickwts, feed) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean_weigth =</span> <span class="kw">mean</span>(weight))</code></pre>
<pre><code>## # A tibble: 6 x 2
##   feed      mean_weigth
##   &lt;fct&gt;           &lt;dbl&gt;
## 1 casein           324.
## 2 horsebean        160.
## 3 linseed          219.
## 4 meatmeal         277.
## 5 soybean          246.
## 6 sunflower        329.</code></pre>
</div>
</div>
<div id="usecases" class="section level2">
<h2><span class="header-section-number">8.2</span> Example Use Cases</h2>
<p>In this chapter, some example use cases will be presented demonstrating some concept or function.
The topics for these use cases are selected because they appear to be harder to comprehend for my students, are a bit out of scope for the lectures, or because they are simply too extensive to fit into a few slides of a presentation.</p>
<div id="dfselection" class="section level3">
<h3><span class="header-section-number">8.2.1</span> Dataframe Selections</h3>
<p>R offers a wealth of methods to make selection on dataframes by columns, rows, or both.</p>
<p>We’ll explore the <code>iris</code> dataset, a dataframe holding morphological data on several species of plants from the genus <em>Iris</em>:</p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(iris, <span class="dv">10</span>))</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.6</td>
<td align="right">3.4</td>
<td align="right">1.4</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.0</td>
<td align="right">3.4</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.4</td>
<td align="right">2.9</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.1</td>
<td align="left">setosa</td>
</tr>
</tbody>
</table>
<p>There are only three species in this dataset</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(iris<span class="op">$</span>Species)</code></pre>
<pre><code>## 
##     setosa versicolor  virginica 
##         50         50         50</code></pre>
<p>but how do they relate to each other with repect to Sepal length?</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(iris, <span class="kw">boxplot</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Species,
                   <span class="dt">ylab =</span> <span class="st">&quot;Sepal length (cm)&quot;</span>,
                   <span class="dt">xlab =</span> <span class="st">&quot;Iris species&quot;</span>))</code></pre>
<p><img src="davur_ebook_files/figure-html/boxplot_sepal_length-1.png" width="672" /></p>
<p>Now suppose I want to get the data from <em>virginica</em> plants that have a Sepal length smaller than the largest Sepal length of <em>setosa</em> plants?
First of course we’ll need the maximum of the <em>setosa</em> plants:</p>
<pre class="sourceCode r"><code class="sourceCode r">max.setosa &lt;-<span class="st"> </span><span class="kw">max</span>(iris[iris<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;setosa&quot;</span>, <span class="st">&quot;Sepal.Length&quot;</span>])
max.setosa</code></pre>
<pre><code>## [1] 5.8</code></pre>
<p>Which plant is it? Let’s use the subset function to find out.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">subset</span>(<span class="dt">x =</span> iris,
       <span class="dt">subset =</span> (Species <span class="op">==</span><span class="st"> &quot;setosa&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Sepal.Length <span class="op">==</span><span class="st"> </span>max.setosa))</code></pre>
<pre><code>##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 15          5.8           4          1.2         0.2  setosa</code></pre>
<p>Now filter out the <em>virginica</em> plants that have a Sepal length smaller than this value. I’ll show two approaches, one with logical indexing and one with <code>subset</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">##get a logical for small plants</span>
logi.small.sepal &lt;-<span class="st"> </span>iris<span class="op">$</span>Sepal.Length <span class="op">&lt;</span><span class="st"> </span>max.setosa
logi.small.sepal</code></pre>
<pre><code>##   [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [12]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [23]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [34]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##  [45]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE  TRUE FALSE
##  [56]  TRUE FALSE  TRUE FALSE  TRUE  TRUE FALSE FALSE FALSE  TRUE FALSE
##  [67]  TRUE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [78] FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE  TRUE FALSE FALSE FALSE
##  [89]  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE
## [100]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE
## [111] FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [122]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [133] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [144] FALSE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">##get a logical for virginica plants</span>
logi.virginica &lt;-<span class="st"> </span>iris<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;virginica&quot;</span>
logi.virginica</code></pre>
<pre><code>##   [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [12] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [23] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [34] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [45] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [56] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [67] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [78] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [89] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [100] FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## [111]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## [122]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## [133]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
## [144]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">##combine the two via a boolean operation</span>
logi.both &lt;-<span class="st"> </span>logi.small.sepal <span class="op">&amp;</span><span class="st"> </span>logi.virginica
logi.both</code></pre>
<pre><code>##   [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [12] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [23] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [34] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [45] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [56] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [67] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [78] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
##  [89] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [100] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE
## [111] FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [122]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [133] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [144] FALSE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">##use it as a selector on the rows of the iris DF</span>
iris[logi.both, ]</code></pre>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
## 107          4.9         2.5          4.5         1.7 virginica
## 114          5.7         2.5          5.0         2.0 virginica
## 122          5.6         2.8          4.9         2.0 virginica</code></pre>
<p>Of course, you will usually perform this selection in one statement, but the operations carried out by R will be exactly the same (but without creating any variables of course):</p>
<pre class="sourceCode r"><code class="sourceCode r">iris[iris<span class="op">$</span>Sepal.Length <span class="op">&lt;</span><span class="st"> </span>max.setosa <span class="op">&amp;</span><span class="st"> </span>iris<span class="op">$</span>Species <span class="op">==</span><span class="st"> &quot;virginica&quot;</span>, ]</code></pre>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
## 107          4.9         2.5          4.5         1.7 virginica
## 114          5.7         2.5          5.0         2.0 virginica
## 122          5.6         2.8          4.9         2.0 virginica</code></pre>
<p>The function <code>subset</code> will do the same behind the scenes, but your code may be more to your liking:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">subset</span>(<span class="dt">x =</span> iris,
       <span class="dt">subset =</span> Sepal.Length <span class="op">&lt;</span><span class="st"> </span>max.setosa <span class="op">&amp;</span><span class="st"> </span>Species <span class="op">==</span><span class="st"> &quot;virginica&quot;</span>)</code></pre>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
## 107          4.9         2.5          4.5         1.7 virginica
## 114          5.7         2.5          5.0         2.0 virginica
## 122          5.6         2.8          4.9         2.0 virginica</code></pre>
<p>By the way, <strong>beware to use only one boolean and: &amp;, not &amp;&amp;</strong>. This will not give an error but only an empty result set</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">subset</span>(<span class="dt">x =</span> iris,
       <span class="dt">subset =</span> Sepal.Length <span class="op">&lt;</span><span class="st"> </span>max.setosa <span class="op">&amp;&amp;</span><span class="st"> </span>Species <span class="op">==</span><span class="st"> &quot;virginica&quot;</span>)</code></pre>
<pre><code>## [1] Sepal.Length Sepal.Width  Petal.Length Petal.Width  Species     
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<blockquote>
<p>&amp; and &amp;&amp; indicate logical AND and | and || indicate logical OR. The shorter form performs elementwise comparisons in much the same way as arithmetic operators. The longer form evaluates left to right examining only the first element of each vector. Evaluation proceeds only until the result is determined. The longer form is appropriate for programming control-flow and typically preferred in if clauses.</p>
</blockquote>
<p>Can you figure out why using <code>&amp;&amp;</code> would give an empty set in the above case?</p>
<p>See <a href="http://stat.ethz.ch/R-manual/R-patched/library/base/html/Logic.html">The R manual</a> for details.</p>
</div>
<div id="apply" class="section level3">
<h3><span class="header-section-number">8.2.2</span> Apply</h3>
<p>Consider the <code>women</code> dataset, holding height and weight of a population sample of 15 women:</p>
<pre class="sourceCode r"><code class="sourceCode r">knitr<span class="op">::</span><span class="kw">kable</span>(women)</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">height</th>
<th align="right">weight</th>
<th align="right">bmi</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">58</td>
<td align="right">115</td>
<td align="right">24.03</td>
</tr>
<tr class="even">
<td align="right">59</td>
<td align="right">117</td>
<td align="right">23.63</td>
</tr>
<tr class="odd">
<td align="right">60</td>
<td align="right">120</td>
<td align="right">23.43</td>
</tr>
<tr class="even">
<td align="right">61</td>
<td align="right">123</td>
<td align="right">23.24</td>
</tr>
<tr class="odd">
<td align="right">62</td>
<td align="right">126</td>
<td align="right">23.04</td>
</tr>
<tr class="even">
<td align="right">63</td>
<td align="right">129</td>
<td align="right">22.85</td>
</tr>
<tr class="odd">
<td align="right">64</td>
<td align="right">132</td>
<td align="right">22.66</td>
</tr>
<tr class="even">
<td align="right">65</td>
<td align="right">135</td>
<td align="right">22.46</td>
</tr>
<tr class="odd">
<td align="right">66</td>
<td align="right">139</td>
<td align="right">22.43</td>
</tr>
<tr class="even">
<td align="right">67</td>
<td align="right">142</td>
<td align="right">22.24</td>
</tr>
<tr class="odd">
<td align="right">68</td>
<td align="right">146</td>
<td align="right">22.20</td>
</tr>
<tr class="even">
<td align="right">69</td>
<td align="right">150</td>
<td align="right">22.15</td>
</tr>
<tr class="odd">
<td align="right">70</td>
<td align="right">154</td>
<td align="right">22.09</td>
</tr>
<tr class="even">
<td align="right">71</td>
<td align="right">159</td>
<td align="right">22.17</td>
</tr>
<tr class="odd">
<td align="right">72</td>
<td align="right">164</td>
<td align="right">22.24</td>
</tr>
</tbody>
</table>
<p>To calculate the average height and the average weight of this sample, one could of course simply do</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(women, {
    <span class="kw">print</span>(<span class="kw">mean</span>(height))
    <span class="kw">print</span>(<span class="kw">mean</span>(weight))
})</code></pre>
<pre><code>## [1] 65
## [1] 136.7</code></pre>
<p>However, when your dataset has (a lot) more columns, repeating this will be quite tedious…unless you use a <code>for</code> loop</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(women)) {
    <span class="kw">print</span>(<span class="kw">mean</span>(women[,i]))
}</code></pre>
<pre><code>## [1] 65
## [1] 136.7
## [1] 22.72</code></pre>
<p>Enter <code>apply()</code>, a very nice function to do this in a handy one-liner</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(<span class="dt">X =</span> women, <span class="dt">MARGIN =</span> <span class="dv">2</span>, <span class="dt">FUN =</span> mean)</code></pre>
<pre><code>## height weight    bmi 
##  65.00 136.73  22.72</code></pre>
<p>The arguments I supplied to <code>apply</code>have the following purpose:</p>
<ol style="list-style-type: decimal">
<li><code>X = women</code> specifies the data to be processed</li>
<li><code>MARGIN = 2</code> specifies wether columns or rows shoud be processed; 1 = rows and 2 = columns</li>
<li><code>FUN = mean</code> speciefies the function to be applied to the given dataframe</li>
</ol>
<p>Not only gives apply the the exact same result (of course, duh), but this approach has several advantages:</p>
<ul>
<li><code>apply</code> returns a named vector where the elements are named the same as the corresponding columns of the original dataframe</li>
<li><code>apply</code> is computationally more efficient than the other approaches</li>
<li>it requires less code; a good programmer types as little as possible - except for Java programmers of course :-)</li>
</ul>
<p>If you really have strongh feelings about typing no more than strictly required, you can of course also omit the method parameters:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(women, <span class="dv">2</span>, mean)</code></pre>
<pre><code>## height weight    bmi 
##  65.00 136.73  22.72</code></pre>
<p>But if you are just starting out with R, I suggest you invest those few character strokes for readability later on.</p>
<p>The above example dealt with columns. For instance, if you want to calculate the BMI of these women, you’ll need to target the rows.
The BMI formula is
<span class="math display">\[weight/height^2*703\]</span></p>
<p>where weight is in pounds and height is in inches.</p>
<p>This formula is implemented in the following function.</p>
<pre class="sourceCode r"><code class="sourceCode r">bmi &lt;-<span class="st"> </span><span class="cf">function</span>(height, weight) {
    (weight <span class="op">/</span><span class="st"> </span>height<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="dv">703</span>
}
<span class="kw">bmi</span>(<span class="dv">65</span>, <span class="dv">150</span>)</code></pre>
<pre><code>## [1] 24.96</code></pre>
<p>You can also apply the formula to the <code>women</code> dataset:</p>
<pre class="sourceCode r"><code class="sourceCode r">women<span class="op">$</span>bmi1 &lt;-<span class="st"> </span><span class="kw">apply</span>(
    <span class="dt">X =</span> women, 
    <span class="dt">MARGIN =</span> <span class="dv">1</span>, 
    <span class="dt">FUN =</span> <span class="cf">function</span>(x){(x[<span class="dv">2</span>] <span class="op">/</span><span class="st"> </span>x[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="dv">703</span>})
<span class="kw">head</span>(women, <span class="dt">n =</span> <span class="dv">4</span>)</code></pre>
<pre><code>##   height weight   bmi  bmi1
## 1     58    115 24.03 24.03
## 2     59    117 23.63 23.63
## 3     60    120 23.43 23.43
## 4     61    123 23.24 23.24</code></pre>
<p>if you like to use your own formula (it’s always a good idea to write logic only once and reuse it in different places), you’ll still need to wrap it inside an anonymous function call:</p>
<pre class="sourceCode r"><code class="sourceCode r">women<span class="op">$</span>bmi2 &lt;-<span class="st"> </span><span class="kw">apply</span>(
    <span class="dt">X =</span> women, 
    <span class="dt">MARGIN =</span> <span class="dv">1</span>, 
    <span class="dt">FUN =</span> <span class="cf">function</span>(x){<span class="kw">bmi</span>(x[<span class="dv">1</span>], x[<span class="dv">2</span>])})
<span class="kw">head</span>(women, <span class="dt">n =</span> <span class="dv">4</span>)</code></pre>
<pre><code>##   height weight   bmi  bmi1  bmi2
## 1     58    115 24.03 24.03 24.03
## 2     59    117 23.63 23.63 23.63
## 3     60    120 23.43 23.43 23.43
## 4     61    123 23.24 23.24 23.24</code></pre>
</div>
<div id="embeddeddf" class="section level3">
<h3><span class="header-section-number">8.2.3</span> Processing Embedded Dataframes</h3>
<p>Suppose you have imported some data that has a structure like this</p>
<pre class="sourceCode r"><code class="sourceCode r">genes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gene A&quot;</span>, <span class="st">&quot;gene B&quot;</span>, <span class="st">&quot;gene C&quot;</span>, <span class="st">&quot;gene D&quot;</span>)
positions &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;chr01:128757:129667&quot;</span>, 
               <span class="st">&quot;chr01:366389:486990&quot;</span>,
               <span class="st">&quot;chr02:8986463:9100856&quot;</span>,
               <span class="st">&quot;chr03:53536:87201&quot;</span>)
my.genome &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">gene =</span> genes, <span class="dt">position =</span> positions)
my.genome</code></pre>
<pre><code>##     gene              position
## 1 gene A   chr01:128757:129667
## 2 gene B   chr01:366389:486990
## 3 gene C chr02:8986463:9100856
## 4 gene D     chr03:53536:87201</code></pre>
<p>The problem here is that the second column, <code>positions</code>, of type <code>character</code>, actually holds three different variables: the chromosome identifyer, the start position and the stop position on the chromosome. To be able to perform analyses of chromosomal contents, or positional contexts, we will need to split this column into separate columns, each holding exactly one variable of the correct type (<code>factor</code>, <code>integer</code> and <code>integer</code>).</p>
<p>When I first encountered this type of problem (it is a <em>challenge</em> actually, some teachers would object, not a <em>problem</em>…), my first thought was “easy, simply apply a split and bind as three columns”.</p>
<p>Let’s have a look at how the <code>strsplit</code> function works in splitting strings</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">strsplit</span>(<span class="dt">x =</span> positions[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">split =</span> <span class="st">&quot;:&quot;</span>)</code></pre>
<pre><code>## [[1]]
## [1] &quot;chr01&quot;  &quot;128757&quot; &quot;129667&quot;
## 
## [[2]]
## [1] &quot;chr01&quot;  &quot;366389&quot; &quot;486990&quot;</code></pre>
<p>As you can see, strsplit generates a list of vectors, with each vector corresponding to the string at the same index of the original character vector.
So, easy, I thought. Simply assign these elements to three new columns of the original dataframe (assuming every split character results in a vector of three). I first created the columns, defined my splitter function and then used apply to get the job done</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## create columns</span>
my.genome[, <span class="kw">c</span>(<span class="st">&quot;chromosome&quot;</span>, <span class="st">&quot;start&quot;</span>, <span class="st">&quot;stop&quot;</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span>
<span class="co">## define splitter function</span>
loc.splitter &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
    <span class="co">## strsplit returns a list!</span>
    <span class="kw">strsplit</span>(x[<span class="st">&quot;position&quot;</span>], <span class="st">&quot;:&quot;</span>)[[<span class="dv">1</span>]]
}
<span class="co">## use apply to fill the columns</span>
my.genome[, <span class="dv">3</span><span class="op">:</span><span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="dt">X =</span> my.genome,
                          <span class="dt">MARGIN =</span> <span class="dv">1</span>,
                          <span class="dt">FUN =</span> loc.splitter)
my.genome</code></pre>
<pre><code>##     gene              position chromosome   start    stop
## 1 gene A   chr01:128757:129667      chr01  366389 9100856
## 2 gene B   chr01:366389:486990     128757  486990   chr03
## 3 gene C chr02:8986463:9100856     129667   chr02   53536
## 4 gene D     chr03:53536:87201      chr01 8986463   87201</code></pre>
<p>Whoa, what happened here?! This was not what I had in mind. Can you figure out what happened?</p>
<p>…</p>
<p>I did figure it out (eventually…). The applied function returned three elements at a time, and I had apply fill three columns of my dataframe. And that is exactly what R did, fill the three columns, but not by row but by column! Have a look at the output from apply and you can see:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(<span class="dt">X =</span> my.genome,
      <span class="dt">MARGIN =</span> <span class="dv">1</span>,
      <span class="dt">FUN =</span> loc.splitter)</code></pre>
<pre><code>##      [,1]     [,2]     [,3]      [,4]   
## [1,] &quot;chr01&quot;  &quot;chr01&quot;  &quot;chr02&quot;   &quot;chr03&quot;
## [2,] &quot;128757&quot; &quot;366389&quot; &quot;8986463&quot; &quot;53536&quot;
## [3,] &quot;129667&quot; &quot;486990&quot; &quot;9100856&quot; &quot;87201&quot;</code></pre>
<p>Fortunately, R has a function to transpose this kind of structure (a matrix actually): the <code>t()</code> function, so that is what I did:</p>
<pre class="sourceCode r"><code class="sourceCode r">my.genome[, <span class="dv">3</span><span class="op">:</span><span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(<span class="dt">X =</span> my.genome,
                            <span class="dt">MARGIN =</span> <span class="dv">1</span>,
                            <span class="dt">FUN =</span> loc.splitter))
my.genome</code></pre>
<pre><code>##     gene              position chromosome   start    stop
## 1 gene A   chr01:128757:129667      chr01  128757  129667
## 2 gene B   chr01:366389:486990      chr01  366389  486990
## 3 gene C chr02:8986463:9100856      chr02 8986463 9100856
## 4 gene D     chr03:53536:87201      chr03   53536   87201</code></pre>
<p>Yeah, that’s what I’m talking about! (Feeling very happy with myself…until I googled this problem). I found out there are a gazillion solutions to this problem, but only one of them is very very simple, because it uses a function you know really well: <code>read.table</code>, but not with the <code>file =</code> argument but with <code>text =</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">my.genome &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">gene =</span> genes, <span class="dt">position =</span> positions)
my.genome &lt;-<span class="st"> </span><span class="kw">cbind</span>(
    my.genome,
    <span class="kw">read.table</span>(
        <span class="dt">text =</span> <span class="kw">as.character</span>(my.genome<span class="op">$</span>position),
        <span class="dt">sep =</span> <span class="st">&quot;:&quot;</span>))
<span class="kw">colnames</span>(my.genome) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">colnames</span>(my.genome)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="st">&quot;chr&quot;</span>, <span class="st">&quot;start&quot;</span>, <span class="st">&quot;stop&quot;</span>)
my.genome</code></pre>
<pre><code>##     gene              position   chr   start    stop
## 1 gene A   chr01:128757:129667 chr01  128757  129667
## 2 gene B   chr01:366389:486990 chr01  366389  486990
## 3 gene C chr02:8986463:9100856 chr02 8986463 9100856
## 4 gene D     chr03:53536:87201 chr03   53536   87201</code></pre>
<p>That’s it. The lessons learned here:</p>
<ul>
<li>Always know that GIYF (Google Is Your Friend)</li>
<li>When reading tables, also those embedded within others, use <code>read.table</code></li>
<li>You really learn a lot by fiddling about with data</li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="scripting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exercises.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["davur_ebook.pdf", "davur_ebook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
