<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Exercise solutions | Data Analysis &amp; Visualization using R (1)</title>
  <meta name="description" content="This gitbook accompanies the course Data Analysis &amp; Visualization using R 1 (DAVuR1) of the minor Bioinformatics for Life Science Students. It is organized by the Hanze University of Applied Science." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Exercise solutions | Data Analysis &amp; Visualization using R (1)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This gitbook accompanies the course Data Analysis &amp; Visualization using R 1 (DAVuR1) of the minor Bioinformatics for Life Science Students. It is organized by the Hanze University of Applied Science." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Exercise solutions | Data Analysis &amp; Visualization using R (1)" />
  
  <meta name="twitter:description" content="This gitbook accompanies the course Data Analysis &amp; Visualization using R 1 (DAVuR1) of the minor Bioinformatics for Life Science Students. It is organized by the Hanze University of Applied Science." />
  

<meta name="author" content="Michiel Noback" />


<meta name="date" content="2020-10-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exercises.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DAVuR eBook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Getting started</a></li>
<li class="chapter" data-level="2" data-path="toolbox.html"><a href="toolbox.html"><i class="fa fa-check"></i><b>2</b> The toolbox</a><ul>
<li class="chapter" data-level="2.1" data-path="toolbox.html"><a href="toolbox.html#embarking-on-data-science"><i class="fa fa-check"></i><b>2.1</b> Embarking on Data Science</a></li>
<li class="chapter" data-level="2.2" data-path="toolbox.html"><a href="toolbox.html#why-do-statistical-programming"><i class="fa fa-check"></i><b>2.2</b> Why do statistical programming?</a><ul>
<li class="chapter" data-level="" data-path="toolbox.html"><a href="toolbox.html#overview-of-the-toolbox"><i class="fa fa-check"></i>Overview of the toolbox</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="toolbox.html"><a href="toolbox.html#tool-1-the-r-programming-language"><i class="fa fa-check"></i><b>2.3</b> Tool 1: The R programming language</a></li>
<li class="chapter" data-level="2.4" data-path="toolbox.html"><a href="toolbox.html#tool-2-rstudio-as-development-environment"><i class="fa fa-check"></i><b>2.4</b> Tool 2: RStudio as development environment</a></li>
<li class="chapter" data-level="2.5" data-path="toolbox.html"><a href="toolbox.html#tool-3-r-markdown"><i class="fa fa-check"></i><b>2.5</b> Tool 3: R Markdown</a></li>
<li class="chapter" data-level="2.6" data-path="toolbox.html"><a href="toolbox.html#resources"><i class="fa fa-check"></i><b>2.6</b> Resources</a><ul>
<li class="chapter" data-level="" data-path="toolbox.html"><a href="toolbox.html#swirl-course"><i class="fa fa-check"></i>Swirl course</a></li>
<li class="chapter" data-level="" data-path="toolbox.html"><a href="toolbox.html#data-files"><i class="fa fa-check"></i>Data Files</a></li>
<li class="chapter" data-level="" data-path="toolbox.html"><a href="toolbox.html#web-resources-and-references"><i class="fa fa-check"></i>Web resources and references</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-r-coding.html"><a href="basic-r-coding.html"><i class="fa fa-check"></i><b>3</b> Basic R - coding</a><ul>
<li class="chapter" data-level="3.1" data-path="basic-r-coding.html"><a href="basic-r-coding.html#first-look-at-vectors-fuctions-and-variables"><i class="fa fa-check"></i><b>3.1</b> First look at vectors, fuctions and variables</a><ul>
<li class="chapter" data-level="3.1.1" data-path="basic-r-coding.html"><a href="basic-r-coding.html#doing-math-in-the-console"><i class="fa fa-check"></i><b>3.1.1</b> Doing Math in the console</a></li>
<li class="chapter" data-level="3.1.2" data-path="basic-r-coding.html"><a href="basic-r-coding.html#an-expression-dissected"><i class="fa fa-check"></i><b>3.1.2</b> An expression dissected</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="basic-r-coding.html"><a href="basic-r-coding.html#functions"><i class="fa fa-check"></i><b>3.2</b> Functions</a><ul>
<li class="chapter" data-level="3.2.1" data-path="basic-r-coding.html"><a href="basic-r-coding.html#getting-help-on-a-function"><i class="fa fa-check"></i><b>3.2.1</b> Getting help on a function</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basic-r-coding.html"><a href="basic-r-coding.html#variables"><i class="fa fa-check"></i><b>3.3</b> Variables</a></li>
<li class="chapter" data-level="3.4" data-path="basic-r-coding.html"><a href="basic-r-coding.html#vectors"><i class="fa fa-check"></i><b>3.4</b> Vectors</a><ul>
<li class="chapter" data-level="3.4.1" data-path="basic-r-coding.html"><a href="basic-r-coding.html#r-is-completely-vector-based"><i class="fa fa-check"></i><b>3.4.1</b> R is completely vector-based</a></li>
<li class="chapter" data-level="3.4.2" data-path="basic-r-coding.html"><a href="basic-r-coding.html#five-datatype-that-live-in-vectors"><i class="fa fa-check"></i><b>3.4.2</b> Five datatype that live in vectors</a></li>
<li class="chapter" data-level="3.4.3" data-path="basic-r-coding.html"><a href="basic-r-coding.html#creating-vectors"><i class="fa fa-check"></i><b>3.4.3</b> Creating vectors</a></li>
<li class="chapter" data-level="3.4.4" data-path="basic-r-coding.html"><a href="basic-r-coding.html#vector-fiddling"><i class="fa fa-check"></i><b>3.4.4</b> Vector fiddling</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="basic-r-coding.html"><a href="basic-r-coding.html#other-operators"><i class="fa fa-check"></i><b>3.5</b> Other operators</a><ul>
<li class="chapter" data-level="3.5.1" data-path="basic-r-coding.html"><a href="basic-r-coding.html#logical-operators"><i class="fa fa-check"></i><b>3.5.1</b> Logical operators</a></li>
<li class="chapter" data-level="3.5.2" data-path="basic-r-coding.html"><a href="basic-r-coding.html#modulo"><i class="fa fa-check"></i><b>3.5.2</b> Modulo: <code>%%</code></a></li>
<li class="chapter" data-level="3.5.3" data-path="basic-r-coding.html"><a href="basic-r-coding.html#integer-division-and-rounding"><i class="fa fa-check"></i><b>3.5.3</b> Integer division <code>%/%</code> and rounding</a></li>
<li class="chapter" data-level="3.5.4" data-path="basic-r-coding.html"><a href="basic-r-coding.html#the-in-operator"><i class="fa fa-check"></i><b>3.5.4</b> The <code>%in%</code> operator</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="basic-r-coding.html"><a href="basic-r-coding.html#vector-creation-methods"><i class="fa fa-check"></i><b>3.6</b> Vector creation methods</a></li>
<li class="chapter" data-level="3.7" data-path="basic-r-coding.html"><a href="basic-r-coding.html#selecting-vector-elements"><i class="fa fa-check"></i><b>3.7</b> Selecting vector elements</a></li>
<li class="chapter" data-level="3.8" data-path="basic-r-coding.html"><a href="basic-r-coding.html#some-coding-style-rules-rules-for-writing-code"><i class="fa fa-check"></i><b>3.8</b> Some coding style rules rules for writing code</a></li>
<li class="chapter" data-level="3.9" data-path="basic-r-coding.html"><a href="basic-r-coding.html#the-best-keyboard-shortcuts-for-rstudio"><i class="fa fa-check"></i><b>3.9</b> The best keyboard shortcuts for RStudio</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-r-plotting.html"><a href="basic-r-plotting.html"><i class="fa fa-check"></i><b>4</b> Basic R - plotting</a><ul>
<li class="chapter" data-level="4.1" data-path="basic-r-plotting.html"><a href="basic-r-plotting.html#basic-embedded-plot-types"><i class="fa fa-check"></i><b>4.1</b> Basic embedded plot types</a><ul>
<li class="chapter" data-level="4.1.1" data-path="basic-r-plotting.html"><a href="basic-r-plotting.html#scatter-and-line-plots"><i class="fa fa-check"></i><b>4.1.1</b> Scatter and line plots</a></li>
<li class="chapter" data-level="4.1.2" data-path="basic-r-plotting.html"><a href="basic-r-plotting.html#barplots"><i class="fa fa-check"></i><b>4.1.2</b> Barplots</a></li>
<li class="chapter" data-level="4.1.3" data-path="basic-r-plotting.html"><a href="basic-r-plotting.html#histograms"><i class="fa fa-check"></i><b>4.1.3</b> Histograms</a></li>
<li class="chapter" data-level="4.1.4" data-path="basic-r-plotting.html"><a href="basic-r-plotting.html#density-plot-as-alternative-to-hist"><i class="fa fa-check"></i><b>4.1.4</b> Density plot as alternative to <code>hist()</code></a></li>
<li class="chapter" data-level="4.1.5" data-path="basic-r-plotting.html"><a href="basic-r-plotting.html#boxplots"><i class="fa fa-check"></i><b>4.1.5</b> Boxplots</a></li>
<li class="chapter" data-level="4.1.6" data-path="basic-r-plotting.html"><a href="basic-r-plotting.html#adding-more-data-and-a-legend"><i class="fa fa-check"></i><b>4.1.6</b> Adding more data and a legend</a></li>
<li class="chapter" data-level="4.1.7" data-path="basic-r-plotting.html"><a href="basic-r-plotting.html#helper-lines-and-lm"><i class="fa fa-check"></i><b>4.1.7</b> Helper lines and <code>lm()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="basic-r-plotting.html"><a href="basic-r-plotting.html#graphical-parameters-to-plot"><i class="fa fa-check"></i><b>4.2</b> Graphical parameters to <code>plot()</code></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="complex-datatypes-and-file-reading.html"><a href="complex-datatypes-and-file-reading.html"><i class="fa fa-check"></i><b>5</b> Complex Datatypes and File Reading</a><ul>
<li class="chapter" data-level="5.1" data-path="complex-datatypes-and-file-reading.html"><a href="complex-datatypes-and-file-reading.html#matrices-are-vectors-with-dimensions"><i class="fa fa-check"></i><b>5.1</b> Matrices are vectors with dimensions</a></li>
<li class="chapter" data-level="5.2" data-path="complex-datatypes-and-file-reading.html"><a href="complex-datatypes-and-file-reading.html#factors-nominal-ordinal-scales"><i class="fa fa-check"></i><b>5.2</b> Factors: Nominal &amp; Ordinal scales</a></li>
<li class="chapter" data-level="5.3" data-path="complex-datatypes-and-file-reading.html"><a href="complex-datatypes-and-file-reading.html#lists"><i class="fa fa-check"></i><b>5.3</b> Lists</a></li>
<li class="chapter" data-level="5.4" data-path="complex-datatypes-and-file-reading.html"><a href="complex-datatypes-and-file-reading.html#dataframes"><i class="fa fa-check"></i><b>5.4</b> Dataframes</a><ul>
<li class="chapter" data-level="5.4.1" data-path="complex-datatypes-and-file-reading.html"><a href="complex-datatypes-and-file-reading.html#selections-on-dataframes"><i class="fa fa-check"></i><b>5.4.1</b> Selections on dataframes</a></li>
<li class="chapter" data-level="5.4.2" data-path="complex-datatypes-and-file-reading.html"><a href="complex-datatypes-and-file-reading.html#read-from-file-using-read.table"><i class="fa fa-check"></i><b>5.4.2</b> Read from file using <code>read.table()</code></a></li>
<li class="chapter" data-level="5.4.3" data-path="complex-datatypes-and-file-reading.html"><a href="complex-datatypes-and-file-reading.html#dataframe-manipulations"><i class="fa fa-check"></i><b>5.4.3</b> Dataframe manipulations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functions-1.html"><a href="functions-1.html"><i class="fa fa-check"></i><b>6</b> Functions</a><ul>
<li class="chapter" data-level="6.1" data-path="functions-1.html"><a href="functions-1.html#dealing-with-nas"><i class="fa fa-check"></i><b>6.1</b> Dealing with NAs</a></li>
<li class="chapter" data-level="6.2" data-path="functions-1.html"><a href="functions-1.html#descriptive-statistics"><i class="fa fa-check"></i><b>6.2</b> Descriptive statistics</a></li>
<li class="chapter" data-level="6.3" data-path="functions-1.html"><a href="functions-1.html#general-purpose-functions"><i class="fa fa-check"></i><b>6.3</b> General purpose functions</a></li>
<li class="chapter" data-level="6.4" data-path="functions-1.html"><a href="functions-1.html#convert-numeric-vector-to-factor-cut"><i class="fa fa-check"></i><b>6.4</b> Convert numeric vector to factor: <code>cut()</code></a></li>
<li class="chapter" data-level="6.5" data-path="functions-1.html"><a href="functions-1.html#file-io-revisited"><i class="fa fa-check"></i><b>6.5</b> File I/O revisited</a></li>
<li class="chapter" data-level="6.6" data-path="functions-1.html"><a href="functions-1.html#pattern-matching"><i class="fa fa-check"></i><b>6.6</b> Pattern matching</a><ul>
<li class="chapter" data-level="6.6.1" data-path="functions-1.html"><a href="functions-1.html#regex-syntax"><i class="fa fa-check"></i><b>6.6.1</b> Regex syntax</a></li>
<li class="chapter" data-level="6.6.2" data-path="functions-1.html"><a href="functions-1.html#quantifiers"><i class="fa fa-check"></i><b>6.6.2</b> Quantifiers</a></li>
<li class="chapter" data-level="6.6.3" data-path="functions-1.html"><a href="functions-1.html#some-examples"><i class="fa fa-check"></i><b>6.6.3</b> Some examples</a></li>
<li class="chapter" data-level="6.6.4" data-path="functions-1.html"><a href="functions-1.html#anchoring"><i class="fa fa-check"></i><b>6.6.4</b> Anchoring</a></li>
<li class="chapter" data-level="6.6.5" data-path="functions-1.html"><a href="functions-1.html#metacharacters-special-character-classes"><i class="fa fa-check"></i><b>6.6.5</b> Metacharacters: Special character classes</a></li>
<li class="chapter" data-level="6.6.6" data-path="functions-1.html"><a href="functions-1.html#locating-and-extracting"><i class="fa fa-check"></i><b>6.6.6</b> Locating and Extracting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="scripting.html"><a href="scripting.html"><i class="fa fa-check"></i><b>7</b> Scripting</a><ul>
<li class="chapter" data-level="7.1" data-path="scripting.html"><a href="scripting.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="scripting.html"><a href="scripting.html#flow-control"><i class="fa fa-check"></i><b>7.2</b> Flow control</a><ul>
<li class="chapter" data-level="7.2.1" data-path="scripting.html"><a href="scripting.html#conditional-execution-with-ifelse"><i class="fa fa-check"></i><b>7.2.1</b> Conditional execution with <code>if/else</code></a></li>
<li class="chapter" data-level="7.2.2" data-path="scripting.html"><a href="scripting.html#iteration-with-for"><i class="fa fa-check"></i><b>7.2.2</b> Iteration with <code>for(){}</code></a></li>
<li class="chapter" data-level="7.2.3" data-path="scripting.html"><a href="scripting.html#conditional-iteration-with-while"><i class="fa fa-check"></i><b>7.2.3</b> Conditional iteration with <code>while(){}</code></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="scripting.html"><a href="scripting.html#creating-functions"><i class="fa fa-check"></i><b>7.3</b> Creating functions</a><ul>
<li class="chapter" data-level="7.3.1" data-path="scripting.html"><a href="scripting.html#errors-and-warnings"><i class="fa fa-check"></i><b>7.3.1</b> Errors and warnings</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="scripting.html"><a href="scripting.html#scripting-1"><i class="fa fa-check"></i><b>7.4</b> Scripting</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html"><i class="fa fa-check"></i><b>8</b> Dataframe manipulations</a><ul>
<li class="chapter" data-level="8.1" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#the-apply-family-of-functions"><i class="fa fa-check"></i><b>8.1</b> The <code>apply()</code> family of functions</a><ul>
<li class="chapter" data-level="8.1.1" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#apply-apply-functions-over-array-margins"><i class="fa fa-check"></i><b>8.1.1</b> <code>apply()</code>: Apply Functions Over Array Margins</a></li>
<li class="chapter" data-level="8.1.2" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#lapply-apply-a-function-over-a-list-or-vector"><i class="fa fa-check"></i><b>8.1.2</b> <code>lapply()</code>: Apply a Function over a List or Vector</a></li>
<li class="chapter" data-level="8.1.3" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#sapply-apply-a-function-over-a-list-or-vector-and-simplify"><i class="fa fa-check"></i><b>8.1.3</b> <code>sapply()</code>: Apply a Function over a List or Vector and Simplify</a></li>
<li class="chapter" data-level="8.1.4" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#tapply-apply-a-function-over-a-ragged-array"><i class="fa fa-check"></i><b>8.1.4</b> <code>tapply()</code>: Apply a Function Over a Ragged Array</a></li>
<li class="chapter" data-level="8.1.5" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#split-divide-into-groups-and-reassemble"><i class="fa fa-check"></i><b>8.1.5</b> <code>split()</code>: Divide into Groups and Reassemble</a></li>
<li class="chapter" data-level="8.1.6" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#aggregate-compute-summary-statistics-of-data-subsets"><i class="fa fa-check"></i><b>8.1.6</b> <code>aggregate()</code>: Compute Summary Statistics of Data Subsets</a></li>
<li class="chapter" data-level="8.1.7" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#many-roads-lead-to-rome"><i class="fa fa-check"></i><b>8.1.7</b> Many roads lead to Rome</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#usecases"><i class="fa fa-check"></i><b>8.2</b> Example Use Cases</a><ul>
<li class="chapter" data-level="8.2.1" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#dfselection"><i class="fa fa-check"></i><b>8.2.1</b> Dataframe Selections</a></li>
<li class="chapter" data-level="8.2.2" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#apply"><i class="fa fa-check"></i><b>8.2.2</b> Apply</a></li>
<li class="chapter" data-level="8.2.3" data-path="dataframe-manipulations-1.html"><a href="dataframe-manipulations-1.html#embeddeddf"><i class="fa fa-check"></i><b>8.2.3</b> Processing Embedded Dataframes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>9</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="9.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#introduction-1"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#eda-of-the-yeast-dataset"><i class="fa fa-check"></i><b>9.2</b> EDA of the Yeast dataset</a><ul>
<li class="chapter" data-level="9.2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#introduction-2"><i class="fa fa-check"></i><b>9.2.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-loading-and-prepping"><i class="fa fa-check"></i><b>9.2.2</b> Data loading and prepping</a></li>
<li class="chapter" data-level="9.2.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-verification"><i class="fa fa-check"></i><b>9.2.3</b> Data verification</a></li>
<li class="chapter" data-level="9.2.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#attribute-summaries"><i class="fa fa-check"></i><b>9.2.4</b> Attribute summaries</a></li>
<li class="chapter" data-level="9.2.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#attribute-relationships"><i class="fa fa-check"></i><b>9.2.5</b> Attribute relationships</a></li>
<li class="chapter" data-level="9.2.6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#correlations-to-the-dependent-variable"><i class="fa fa-check"></i><b>9.2.6</b> Correlations to the dependent variable</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>10</b> Exercises</a><ul>
<li class="chapter" data-level="10.1" data-path="exercises.html"><a href="exercises.html#getting-started-1"><i class="fa fa-check"></i><b>10.1</b> Getting started</a><ul>
<li class="chapter" data-level="10.1.1" data-path="exercises.html"><a href="exercises.html#install-the-tools"><i class="fa fa-check"></i><b>10.1.1</b> Install the tools</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="exercises.html"><a href="exercises.html#toolbox-1"><i class="fa fa-check"></i><b>10.2</b> Toolbox</a><ul>
<li class="chapter" data-level="10.2.1" data-path="exercises.html"><a href="exercises.html#résumé"><i class="fa fa-check"></i><b>10.2.1</b> Résumé</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="exercises.html"><a href="exercises.html#basic-r"><i class="fa fa-check"></i><b>10.3</b> Basic R</a><ul>
<li class="chapter" data-level="10.3.1" data-path="exercises.html"><a href="exercises.html#math-in-the-console"><i class="fa fa-check"></i><b>10.3.1</b> Math in the console</a></li>
<li class="chapter" data-level="10.3.2" data-path="exercises.html"><a href="exercises.html#first-look-at-functions"><i class="fa fa-check"></i><b>10.3.2</b> First look at functions</a></li>
<li class="chapter" data-level="10.3.3" data-path="exercises.html"><a href="exercises.html#variables-1"><i class="fa fa-check"></i><b>10.3.3</b> Variables</a></li>
<li class="chapter" data-level="10.3.4" data-path="exercises.html"><a href="exercises.html#vectors-1"><i class="fa fa-check"></i><b>10.3.4</b> Vectors</a></li>
<li class="chapter" data-level="10.3.5" data-path="exercises.html"><a href="exercises.html#stair-walking-and-heart-rate"><i class="fa fa-check"></i><b>10.3.5</b> Stair walking and heart rate</a></li>
<li class="chapter" data-level="10.3.6" data-path="exercises.html"><a href="exercises.html#more-subjects"><i class="fa fa-check"></i><b>10.3.6</b> More subjects</a></li>
<li class="chapter" data-level="10.3.7" data-path="exercises.html"><a href="exercises.html#chickens-on-a-diet"><i class="fa fa-check"></i><b>10.3.7</b> Chickens on a diet</a></li>
<li class="chapter" data-level="10.3.8" data-path="exercises.html"><a href="exercises.html#chicken-bar-plot"><i class="fa fa-check"></i><b>10.3.8</b> Chicken bar plot</a></li>
<li class="chapter" data-level="10.3.9" data-path="exercises.html"><a href="exercises.html#discoveries"><i class="fa fa-check"></i><b>10.3.9</b> Discoveries</a></li>
<li class="chapter" data-level="10.3.10" data-path="exercises.html"><a href="exercises.html#lung-cancer"><i class="fa fa-check"></i><b>10.3.10</b> Lung cancer</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="exercises.html"><a href="exercises.html#complex-datatypes"><i class="fa fa-check"></i><b>10.4</b> Complex datatypes</a><ul>
<li class="chapter" data-level="10.4.1" data-path="exercises.html"><a href="exercises.html#creating-factors"><i class="fa fa-check"></i><b>10.4.1</b> Creating factors</a></li>
<li class="chapter" data-level="10.4.2" data-path="exercises.html"><a href="exercises.html#a-dictionary-with-a-named-vector"><i class="fa fa-check"></i><b>10.4.2</b> A dictionary with a named vector</a></li>
<li class="chapter" data-level="10.4.3" data-path="exercises.html"><a href="exercises.html#protein-concentrations-with-lowry"><i class="fa fa-check"></i><b>10.4.3</b> Protein concentrations with Lowry</a></li>
<li class="chapter" data-level="10.4.4" data-path="exercises.html"><a href="exercises.html#hplc-data"><i class="fa fa-check"></i><b>10.4.4</b> HPLC data</a></li>
<li class="chapter" data-level="10.4.5" data-path="exercises.html"><a href="exercises.html#airquality"><i class="fa fa-check"></i><b>10.4.5</b> Airquality</a></li>
<li class="chapter" data-level="10.4.6" data-path="exercises.html"><a href="exercises.html#file-reading-practice"><i class="fa fa-check"></i><b>10.4.6</b> File reading practice</a></li>
<li class="chapter" data-level="10.4.7" data-path="exercises.html"><a href="exercises.html#bird-observations"><i class="fa fa-check"></i><b>10.4.7</b> Bird observations</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="exercises.html"><a href="exercises.html#functions-2"><i class="fa fa-check"></i><b>10.5</b> Functions</a><ul>
<li class="chapter" data-level="10.5.1" data-path="exercises.html"><a href="exercises.html#the-cut-function-i"><i class="fa fa-check"></i><b>10.5.1</b> The <code>cut()</code> function I</a></li>
<li class="chapter" data-level="10.5.2" data-path="exercises.html"><a href="exercises.html#the-cut-function-ii"><i class="fa fa-check"></i><b>10.5.2</b> The <code>cut()</code> function II</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="exercises.html"><a href="exercises.html#regular-expressions"><i class="fa fa-check"></i><b>10.6</b> Regular Expressions</a><ul>
<li class="chapter" data-level="10.6.1" data-path="exercises.html"><a href="exercises.html#restriction-enzymes-1"><i class="fa fa-check"></i><b>10.6.1</b> Restriction enzymes</a></li>
<li class="chapter" data-level="10.6.2" data-path="exercises.html"><a href="exercises.html#prosite-patterns-1"><i class="fa fa-check"></i><b>10.6.2</b> Prosite Patterns</a></li>
<li class="chapter" data-level="10.6.3" data-path="exercises.html"><a href="exercises.html#fasta-headers"><i class="fa fa-check"></i><b>10.6.3</b> Fasta Headers</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="exercises.html"><a href="exercises.html#scripting-2"><i class="fa fa-check"></i><b>10.7</b> Scripting</a><ul>
<li class="chapter" data-level="10.7.1" data-path="exercises.html"><a href="exercises.html#illegal-reproductions"><i class="fa fa-check"></i><b>10.7.1</b> Illegal reproductions</a></li>
<li class="chapter" data-level="10.7.2" data-path="exercises.html"><a href="exercises.html#count-odd-and-even-numbers"><i class="fa fa-check"></i><b>10.7.2</b> Count odd and even numbers</a></li>
<li class="chapter" data-level="10.7.3" data-path="exercises.html"><a href="exercises.html#add-column-compared-to-mean"><i class="fa fa-check"></i><b>10.7.3</b> Add column compared to mean</a></li>
<li class="chapter" data-level="10.7.4" data-path="exercises.html"><a href="exercises.html#interquantile-ranges"><i class="fa fa-check"></i><b>10.7.4</b> Interquantile ranges</a></li>
<li class="chapter" data-level="10.7.5" data-path="exercises.html"><a href="exercises.html#vector-distance"><i class="fa fa-check"></i><b>10.7.5</b> Vector distance</a></li>
<li class="chapter" data-level="10.7.6" data-path="exercises.html"><a href="exercises.html#quadratic-equation-solver"><i class="fa fa-check"></i><b>10.7.6</b> Quadratic equation solver</a></li>
<li class="chapter" data-level="10.7.7" data-path="exercises.html"><a href="exercises.html#gc-percentage-of-dna"><i class="fa fa-check"></i><b>10.7.7</b> G/C percentage of DNA</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="exercises.html"><a href="exercises.html#function-apply-and-its-relatives"><i class="fa fa-check"></i><b>10.8</b> Function <code>apply</code> and its relatives</a><ul>
<li class="chapter" data-level="10.8.1" data-path="exercises.html"><a href="exercises.html#whale-selenium"><i class="fa fa-check"></i><b>10.8.1</b> Whale selenium</a></li>
<li class="chapter" data-level="10.8.2" data-path="exercises.html"><a href="exercises.html#chickweight"><i class="fa fa-check"></i><b>10.8.2</b> ChickWeight</a></li>
<li class="chapter" data-level="10.8.3" data-path="exercises.html"><a href="exercises.html#food-constituents"><i class="fa fa-check"></i><b>10.8.3</b> Food constituents</a></li>
<li class="chapter" data-level="10.8.4" data-path="exercises.html"><a href="exercises.html#urine-properties"><i class="fa fa-check"></i><b>10.8.4</b> Urine properties</a></li>
<li class="chapter" data-level="10.8.5" data-path="exercises.html"><a href="exercises.html#bird-observations-revisited"><i class="fa fa-check"></i><b>10.8.5</b> Bird observations revisited</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="exercise-solutions.html"><a href="exercise-solutions.html"><i class="fa fa-check"></i><b>11</b> Exercise solutions</a><ul>
<li class="chapter" data-level="11.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#getting-started-2"><i class="fa fa-check"></i><b>11.1</b> Getting started</a><ul>
<li class="chapter" data-level="11.1.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#install-the-tools-1"><i class="fa fa-check"></i><b>11.1.1</b> Install the tools</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#toolbox-2"><i class="fa fa-check"></i><b>11.2</b> Toolbox</a><ul>
<li class="chapter" data-level="11.2.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#résumé-1"><i class="fa fa-check"></i><b>11.2.1</b> Résumé</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#basic-r-1"><i class="fa fa-check"></i><b>11.3</b> Basic R</a><ul>
<li class="chapter" data-level="11.3.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#math-in-the-console-1"><i class="fa fa-check"></i><b>11.3.1</b> Math in the console</a></li>
<li class="chapter" data-level="11.3.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#first-look-at-functions-1"><i class="fa fa-check"></i><b>11.3.2</b> First look at functions</a></li>
<li class="chapter" data-level="11.3.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#variables-2"><i class="fa fa-check"></i><b>11.3.3</b> Variables</a></li>
<li class="chapter" data-level="11.3.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#vectors-2"><i class="fa fa-check"></i><b>11.3.4</b> Vectors</a></li>
<li class="chapter" data-level="11.3.5" data-path="exercise-solutions.html"><a href="exercise-solutions.html#stair-walking-and-heart-rate-1"><i class="fa fa-check"></i><b>11.3.5</b> Stair walking and heart rate</a></li>
<li class="chapter" data-level="11.3.6" data-path="exercise-solutions.html"><a href="exercise-solutions.html#more-subjects-1"><i class="fa fa-check"></i><b>11.3.6</b> More subjects</a></li>
<li class="chapter" data-level="11.3.7" data-path="exercise-solutions.html"><a href="exercise-solutions.html#chickens-on-a-diet-1"><i class="fa fa-check"></i><b>11.3.7</b> Chickens on a diet</a></li>
<li class="chapter" data-level="11.3.8" data-path="exercise-solutions.html"><a href="exercise-solutions.html#chicken-bar-plot-1"><i class="fa fa-check"></i><b>11.3.8</b> Chicken bar plot</a></li>
<li class="chapter" data-level="11.3.9" data-path="exercise-solutions.html"><a href="exercise-solutions.html#discoveries-1"><i class="fa fa-check"></i><b>11.3.9</b> Discoveries</a></li>
<li class="chapter" data-level="11.3.10" data-path="exercise-solutions.html"><a href="exercise-solutions.html#lung-cancer-1"><i class="fa fa-check"></i><b>11.3.10</b> Lung cancer</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#complex-datatypes-1"><i class="fa fa-check"></i><b>11.4</b> Complex datatypes</a><ul>
<li class="chapter" data-level="11.4.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#creating-factors-1"><i class="fa fa-check"></i><b>11.4.1</b> Creating factors</a></li>
<li class="chapter" data-level="11.4.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#a-dictionary-with-a-named-vector-1"><i class="fa fa-check"></i><b>11.4.2</b> A dictionary with a named vector</a></li>
<li class="chapter" data-level="11.4.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#protein-concentrations-with-lowry-1"><i class="fa fa-check"></i><b>11.4.3</b> Protein concentrations with Lowry</a></li>
<li class="chapter" data-level="11.4.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#hplc-data-1"><i class="fa fa-check"></i><b>11.4.4</b> HPLC data</a></li>
<li class="chapter" data-level="11.4.5" data-path="exercise-solutions.html"><a href="exercise-solutions.html#airquality-1"><i class="fa fa-check"></i><b>11.4.5</b> Airquality</a></li>
<li class="chapter" data-level="11.4.6" data-path="exercise-solutions.html"><a href="exercise-solutions.html#file-reading-practice-1"><i class="fa fa-check"></i><b>11.4.6</b> File reading practice</a></li>
<li class="chapter" data-level="11.4.7" data-path="exercise-solutions.html"><a href="exercise-solutions.html#bird-observations-1"><i class="fa fa-check"></i><b>11.4.7</b> Bird observations</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="exercise-solutions.html"><a href="exercise-solutions.html#functions-3"><i class="fa fa-check"></i><b>11.5</b> Functions</a><ul>
<li class="chapter" data-level="11.5.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#the-cut-function-i-1"><i class="fa fa-check"></i><b>11.5.1</b> The <code>cut()</code> function I</a></li>
<li class="chapter" data-level="11.5.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#the-cut-function-ii-1"><i class="fa fa-check"></i><b>11.5.2</b> The <code>cut()</code> function II</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="exercise-solutions.html"><a href="exercise-solutions.html#regular-expressions-1"><i class="fa fa-check"></i><b>11.6</b> Regular Expressions</a><ul>
<li class="chapter" data-level="11.6.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#restriction-enzymes-2"><i class="fa fa-check"></i><b>11.6.1</b> Restriction enzymes</a></li>
<li class="chapter" data-level="11.6.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#prosite-patterns-2"><i class="fa fa-check"></i><b>11.6.2</b> Prosite Patterns</a></li>
<li class="chapter" data-level="11.6.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#fasta-headers-1"><i class="fa fa-check"></i><b>11.6.3</b> Fasta Headers</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="exercise-solutions.html"><a href="exercise-solutions.html#scripting-3"><i class="fa fa-check"></i><b>11.7</b> Scripting</a><ul>
<li class="chapter" data-level="11.7.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#illegal-reproductions-1"><i class="fa fa-check"></i><b>11.7.1</b> Illegal reproductions</a></li>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#find-match-locations-1"><i class="fa fa-check"></i>Find match locations</a></li>
<li class="chapter" data-level="11.7.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#count-odd-and-even-numbers-1"><i class="fa fa-check"></i><b>11.7.2</b> Count odd and even numbers</a></li>
<li class="chapter" data-level="11.7.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#add-column-compared-to-mean-1"><i class="fa fa-check"></i><b>11.7.3</b> Add column compared to mean</a></li>
<li class="chapter" data-level="11.7.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#interquantile-ranges-1"><i class="fa fa-check"></i><b>11.7.4</b> Interquantile ranges</a></li>
<li class="chapter" data-level="11.7.5" data-path="exercise-solutions.html"><a href="exercise-solutions.html#vector-distance-1"><i class="fa fa-check"></i><b>11.7.5</b> Vector distance</a></li>
<li class="chapter" data-level="11.7.6" data-path="exercise-solutions.html"><a href="exercise-solutions.html#quadratic-equation-solver-1"><i class="fa fa-check"></i><b>11.7.6</b> Quadratic equation solver</a></li>
<li class="chapter" data-level="11.7.7" data-path="exercise-solutions.html"><a href="exercise-solutions.html#gc-percentage-of-dna-1"><i class="fa fa-check"></i><b>11.7.7</b> G/C percentage of DNA</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="exercise-solutions.html"><a href="exercise-solutions.html#function-apply-and-its-relatives-1"><i class="fa fa-check"></i><b>11.8</b> Function <code>apply</code> and its relatives</a><ul>
<li class="chapter" data-level="11.8.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#whale-selenium-1"><i class="fa fa-check"></i><b>11.8.1</b> Whale selenium</a></li>
<li class="chapter" data-level="11.8.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#chickweight-1"><i class="fa fa-check"></i><b>11.8.2</b> ChickWeight</a></li>
<li class="chapter" data-level="11.8.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#food-constituents-1"><i class="fa fa-check"></i><b>11.8.3</b> Food constituents</a></li>
<li class="chapter" data-level="11.8.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#urine-properties-1"><i class="fa fa-check"></i><b>11.8.4</b> Urine properties</a></li>
<li class="chapter" data-level="11.8.5" data-path="exercise-solutions.html"><a href="exercise-solutions.html#bird-observations-revisited-1"><i class="fa fa-check"></i><b>11.8.5</b> Bird observations revisited</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis &amp; Visualization using R (1)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercise-solutions" class="section level1">
<h1><span class="header-section-number">Chapter 11</span> Exercise solutions</h1>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="exercise-solutions.html#cb551-1"></a><span class="co">#this is for rounding numbers in this session</span></span>
<span id="cb551-2"><a href="exercise-solutions.html#cb551-2"></a><span class="kw">options</span>(<span class="dt">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<div id="getting-started-2" class="section level2">
<h2><span class="header-section-number">11.1</span> Getting started</h2>
<div id="install-the-tools-1" class="section level3">
<h3><span class="header-section-number">11.1.1</span> Install the tools</h3>
<p>No solution for this one.</p>
</div>
</div>
<div id="toolbox-2" class="section level2">
<h2><span class="header-section-number">11.2</span> Toolbox</h2>
<div id="résumé-1" class="section level3">
<h3><span class="header-section-number">11.2.1</span> Résumé</h3>
<p>No solution for this one.</p>
</div>
</div>
<div id="basic-r-1" class="section level2">
<h2><span class="header-section-number">11.3</span> Basic R</h2>
<div id="math-in-the-console-1" class="section level3">
<h3><span class="header-section-number">11.3.1</span> Math in the console</h3>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="exercise-solutions.html#cb552-1"></a><span class="dv">31</span> <span class="op">+</span><span class="st"> </span><span class="dv">11</span></span>
<span id="cb552-2"><a href="exercise-solutions.html#cb552-2"></a><span class="dv">66</span> <span class="op">-</span><span class="st"> </span><span class="dv">24</span></span>
<span id="cb552-3"><a href="exercise-solutions.html#cb552-3"></a><span class="dv">126</span> <span class="op">/</span><span class="st"> </span><span class="dv">3</span></span>
<span id="cb552-4"><a href="exercise-solutions.html#cb552-4"></a><span class="dv">12</span><span class="op">^</span><span class="dv">2</span> </span>
<span id="cb552-5"><a href="exercise-solutions.html#cb552-5"></a><span class="dv">256</span><span class="op">**</span><span class="fl">0.5</span></span>
<span id="cb552-6"><a href="exercise-solutions.html#cb552-6"></a>(<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span><span class="op">^</span><span class="fl">0.5</span>))<span class="op">/</span>(<span class="dv">5</span><span class="op">^</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 42
## [1] 42
## [1] 42
## [1] 144
## [1] 16
## [1] 0.164</code></pre>
</div>
<div id="first-look-at-functions-1" class="section level3">
<h3><span class="header-section-number">11.3.2</span> First look at functions</h3>
<p><strong>A</strong><br />
Answer: <code>paste()</code> and <code>paste0()</code>. The difference lies in the <em>separator</em>, which is an empty string in <code>paste0()</code> and one space in <code>paste()</code>. Moreover, the separator can be configured in <code>paste()</code> using the <code>sep =</code> parameter.</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="exercise-solutions.html#cb554-1"></a><span class="kw">paste</span>(<span class="st">&quot;welcome &quot;</span>, <span class="st">&quot;to &quot;</span>, <span class="st">&quot;R&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;welcome to R&quot;</code></pre>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="exercise-solutions.html#cb556-1"></a><span class="kw">paste0</span>(<span class="st">&quot;welcome &quot;</span>, <span class="st">&quot;to &quot;</span>, <span class="st">&quot;R&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;welcome to R&quot;</code></pre>
<p><strong>B</strong><br />
Answer: <code>abs()</code> returns the <em>absolute</em> value. Simply put, a number with the minus sign removed if present.</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="exercise-solutions.html#cb558-1"></a><span class="kw">abs</span>(<span class="op">-</span><span class="dv">20</span>)</span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="exercise-solutions.html#cb560-1"></a><span class="kw">abs</span>(<span class="dv">20</span>)</span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<p><strong>C</strong><br />
Answer: it combines (<strong>c</strong>oncatenates) its arguments into a single vector. The first example creates a “character” (text data) and the second a “numeric” (numeric data).</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="exercise-solutions.html#cb562-1"></a><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">&quot;a&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;a&quot;</code></pre>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="exercise-solutions.html#cb564-1"></a><span class="kw">class</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">&quot;a&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="exercise-solutions.html#cb566-1"></a><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="exercise-solutions.html#cb568-1"></a><span class="kw">class</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p><strong>D</strong></p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="exercise-solutions.html#cb570-1"></a><span class="co">#install it. Note the quotes</span></span>
<span id="cb570-2"><a href="exercise-solutions.html#cb570-2"></a><span class="kw">install.packages</span>(<span class="st">&quot;RColorBrewer&quot;</span>)</span>
<span id="cb570-3"><a href="exercise-solutions.html#cb570-3"></a><span class="co">#load it into your session. Note the absence of quotes</span></span>
<span id="cb570-4"><a href="exercise-solutions.html#cb570-4"></a><span class="kw">library</span>(RColorBrewer)</span></code></pre></div>
<p><strong>E</strong></p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="exercise-solutions.html#cb571-1"></a><span class="kw">ceiling</span>(numberz)</span>
<span id="cb571-2"><a href="exercise-solutions.html#cb571-2"></a><span class="kw">trunc</span>(numberz) <span class="co"># or signif(numberz, 3)</span></span>
<span id="cb571-3"><a href="exercise-solutions.html#cb571-3"></a><span class="kw">round</span>(numberz, <span class="dv">3</span>)</span>
<span id="cb571-4"><a href="exercise-solutions.html#cb571-4"></a><span class="kw">floor</span>(numberz)</span></code></pre></div>
<p><strong>F</strong></p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="exercise-solutions.html#cb572-1"></a><span class="kw">strsplit</span>(names, <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<p><strong>G</strong></p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="exercise-solutions.html#cb573-1"></a><span class="kw">unique</span>(birds)</span></code></pre></div>
</div>
<div id="variables-2" class="section level3">
<h3><span class="header-section-number">11.3.3</span> Variables</h3>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="exercise-solutions.html#cb574-1"></a>x &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb574-2"><a href="exercise-solutions.html#cb574-2"></a>y &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb574-3"><a href="exercise-solutions.html#cb574-3"></a>z &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb574-4"><a href="exercise-solutions.html#cb574-4"></a></span>
<span id="cb574-5"><a href="exercise-solutions.html#cb574-5"></a>x <span class="op">+</span><span class="st"> </span>y</span></code></pre></div>
<pre><code>## [1] 30</code></pre>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="exercise-solutions.html#cb576-1"></a>x<span class="op">^</span>z</span></code></pre></div>
<pre><code>## [1] 8000</code></pre>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="exercise-solutions.html#cb578-1"></a><span class="co">#OR</span></span>
<span id="cb578-2"><a href="exercise-solutions.html#cb578-2"></a><span class="co">#x**z</span></span>
<span id="cb578-3"><a href="exercise-solutions.html#cb578-3"></a>q &lt;-<span class="st"> </span>x <span class="op">*</span><span class="st"> </span>y <span class="op">*</span><span class="st"> </span>z</span>
<span id="cb578-4"><a href="exercise-solutions.html#cb578-4"></a><span class="kw">sqrt</span>(q)</span></code></pre></div>
<pre><code>## [1] 24.5</code></pre>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="exercise-solutions.html#cb580-1"></a>q<span class="op">/</span>pi</span></code></pre></div>
<pre><code>## [1] 191</code></pre>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="exercise-solutions.html#cb582-1"></a><span class="kw">log10</span>(x <span class="op">*</span><span class="st"> </span>y)</span></code></pre></div>
<pre><code>## [1] 2.3</code></pre>
</div>
<div id="vectors-2" class="section level3">
<h3><span class="header-section-number">11.3.4</span> Vectors</h3>
<div id="circles-1" class="section level4 unnumbered">
<h4>Circles</h4>
<p>The circumference of a circle is <span class="math inline">\(2\pi\cdot r\)</span>, its surface <span class="math inline">\(4\pi \cdot r^2\)</span> and its volume <span class="math inline">\(4/3 \pi\cdot r^3\)</span>.
Given this vector of circle radiuses,</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="exercise-solutions.html#cb584-1"></a>radiuses &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, pi, <span class="dv">4</span>)</span></code></pre></div>
<p><strong>A</strong><br />
Calculate their cirumference.</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="exercise-solutions.html#cb585-1"></a><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>radiuses</span></code></pre></div>
<pre><code>## [1]  0.00  6.28 12.57 19.74 25.13</code></pre>
<p><strong>B</strong><br />
Calculate their surface.</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="exercise-solutions.html#cb587-1"></a><span class="dv">4</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>radiuses<span class="op">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1]   0.0  12.6  50.3 124.0 201.1</code></pre>
<p><strong>C</strong><br />
Calculate their volume.</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="exercise-solutions.html#cb589-1"></a><span class="dv">4</span><span class="op">/</span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>radiuses<span class="op">^</span><span class="dv">3</span></span></code></pre></div>
<pre><code>## [1]   0.00   4.19  33.51 129.88 268.08</code></pre>
</div>
<div id="creating-vectors-2" class="section level4 unnumbered">
<h4>Creating vectors</h4>
<p>Create the following vectors, as efficiently as possible. The functions <code>rep()</code>, <code>seq()</code> and <code>paste0()</code> and the colon operator <code>:</code> can be used, in any combination.</p>
<p><strong>A</strong><br />
<code>[1] 1 2 5 1 2 5</code></p>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="exercise-solutions.html#cb591-1"></a><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>), <span class="dt">times =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 5 1 2 5</code></pre>
<p><strong>B</strong><br />
<code>[1] 9 9 9 8 8 8 7 7 7 6 6 6 5 5 5</code></p>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="exercise-solutions.html#cb593-1"></a><span class="kw">rep</span>(<span class="dv">9</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">each =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  [1] 9 9 9 8 8 8 7 7 7 6 6 6 5 5 5</code></pre>
<p><strong>C</strong><br />
<code>[1] 1 1 1 4 4 4 9 9 9 1 1 1 4 4 4 9 9 9</code></p>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="exercise-solutions.html#cb595-1"></a><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">9</span>), <span class="dt">times =</span> <span class="dv">2</span>, <span class="dt">each =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  [1] 1 1 1 4 4 4 9 9 9 1 1 1 4 4 4 9 9 9</code></pre>
<p><strong>D</strong><br />
<code>[1] "1a" "2b" "3c" "4d" "5e" "1a" "2b" "3c" "4d" "5e"</code></p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="exercise-solutions.html#cb597-1"></a><span class="kw">rep</span>(<span class="kw">paste0</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, letters[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]), <span class="dt">times =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;1a&quot; &quot;2b&quot; &quot;3c&quot; &quot;4d&quot; &quot;5e&quot; &quot;1a&quot; &quot;2b&quot; &quot;3c&quot; &quot;4d&quot; &quot;5e&quot;</code></pre>
<p><strong>E</strong><br />
<code>[1] "0z"   "0.2y" "0.4x" "0.6w" "0.8v" "1u"</code></p>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="exercise-solutions.html#cb599-1"></a><span class="kw">paste0</span>(<span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">6</span>), letters[<span class="dv">26</span><span class="op">:</span><span class="dv">21</span>])</span></code></pre></div>
<pre><code>## [1] &quot;0z&quot;   &quot;0.2y&quot; &quot;0.4x&quot; &quot;0.6w&quot; &quot;0.8v&quot; &quot;1u&quot;</code></pre>
<p><strong>F</strong><br />
<code>[1] "505" "404" "303" "202" "101" "000"</code></p>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="exercise-solutions.html#cb601-1"></a><span class="kw">paste0</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span><span class="op">:</span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] &quot;505&quot; &quot;404&quot; &quot;303&quot; &quot;202&quot; &quot;101&quot; &quot;000&quot;</code></pre>
<p><strong>G [Challenge]</strong><br />
<code>[1] "0.5A5.0" "0.4B4.0" "0.3C3.0" "0.2D2.0" "0.1E1.0"</code></p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="exercise-solutions.html#cb603-1"></a><span class="kw">paste0</span>(<span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">0.5</span>, <span class="dt">to =</span> <span class="fl">0.1</span>, <span class="dt">by =</span> <span class="fl">-0.1</span>),  LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dv">5</span><span class="op">:</span><span class="dv">1</span>, <span class="st">&quot;.0&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;0.5A5.0&quot; &quot;0.4B4.0&quot; &quot;0.3C3.0&quot; &quot;0.2D2.0&quot; &quot;0.1E1.0&quot;</code></pre>
</div>
</div>
<div id="stair-walking-and-heart-rate-1" class="section level3">
<h3><span class="header-section-number">11.3.5</span> Stair walking and heart rate</h3>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="exercise-solutions.html#cb605-1"></a><span class="co">#number of steps on the stairs</span></span>
<span id="cb605-2"><a href="exercise-solutions.html#cb605-2"></a>stair_height &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>)</span>
<span id="cb605-3"><a href="exercise-solutions.html#cb605-3"></a><span class="co">#heart rate after ascending the stairs</span></span>
<span id="cb605-4"><a href="exercise-solutions.html#cb605-4"></a>heart_rate &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">66</span>, <span class="dv">65</span>, <span class="dv">67</span>, <span class="dv">69</span>, <span class="dv">73</span>, <span class="dv">79</span>, <span class="dv">86</span>, <span class="dv">97</span>)</span>
<span id="cb605-5"><a href="exercise-solutions.html#cb605-5"></a><span class="kw">plot</span>(heart_rate <span class="op">~</span><span class="st"> </span>stair_height,</span>
<span id="cb605-6"><a href="exercise-solutions.html#cb605-6"></a>      <span class="dt">main =</span> <span class="st">&quot;Heart rate versus stair height&quot;</span>,</span>
<span id="cb605-7"><a href="exercise-solutions.html#cb605-7"></a>      <span class="dt">xlab =</span> <span class="st">&quot;number of steps&quot;</span>,</span>
<span id="cb605-8"><a href="exercise-solutions.html#cb605-8"></a>      <span class="dt">ylab =</span> <span class="st">&quot;heart rate (beats/minute)&quot;</span>,</span>
<span id="cb605-9"><a href="exercise-solutions.html#cb605-9"></a>      <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb605-10"><a href="exercise-solutions.html#cb605-10"></a>      <span class="dt">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb605-11"><a href="exercise-solutions.html#cb605-11"></a>      <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/stair-walking-exp-1-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="more-subjects-1" class="section level3">
<h3><span class="header-section-number">11.3.6</span> More subjects</h3>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="exercise-solutions.html#cb606-1"></a><span class="co">#number of steps on the stairs</span></span>
<span id="cb606-2"><a href="exercise-solutions.html#cb606-2"></a>stair_height &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>)</span>
<span id="cb606-3"><a href="exercise-solutions.html#cb606-3"></a><span class="co">#heart rates for subjects with normal weight</span></span>
<span id="cb606-4"><a href="exercise-solutions.html#cb606-4"></a>heart_rate_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">66</span>, <span class="dv">65</span>, <span class="dv">67</span>, <span class="dv">69</span>, <span class="dv">73</span>, <span class="dv">79</span>, <span class="dv">86</span>, <span class="dv">97</span>)</span>
<span id="cb606-5"><a href="exercise-solutions.html#cb606-5"></a>heart_rate_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">61</span>, <span class="dv">61</span>, <span class="dv">63</span>, <span class="dv">68</span>, <span class="dv">74</span>, <span class="dv">81</span>, <span class="dv">89</span>, <span class="dv">104</span>)</span>
<span id="cb606-6"><a href="exercise-solutions.html#cb606-6"></a><span class="co">#heart rates for obese subjects</span></span>
<span id="cb606-7"><a href="exercise-solutions.html#cb606-7"></a>heart_rate_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">58</span>, <span class="dv">60</span>, <span class="dv">67</span>, <span class="dv">71</span>, <span class="dv">78</span>, <span class="dv">89</span>, <span class="dv">104</span>, <span class="dv">121</span>)</span>
<span id="cb606-8"><a href="exercise-solutions.html#cb606-8"></a>heart_rate_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">69</span>, <span class="dv">73</span>, <span class="dv">77</span>, <span class="dv">83</span>, <span class="dv">88</span>, <span class="dv">96</span>, <span class="dv">102</span>, <span class="dv">127</span>)</span>
<span id="cb606-9"><a href="exercise-solutions.html#cb606-9"></a><span class="kw">plot</span>(<span class="dt">x =</span> stair_height,</span>
<span id="cb606-10"><a href="exercise-solutions.html#cb606-10"></a>    <span class="dt">y =</span> heart_rate_<span class="dv">1</span>,</span>
<span id="cb606-11"><a href="exercise-solutions.html#cb606-11"></a>    <span class="dt">main =</span> <span class="st">&quot;Heart rate vs stair height&quot;</span>,</span>
<span id="cb606-12"><a href="exercise-solutions.html#cb606-12"></a>    <span class="dt">xlab =</span> <span class="st">&quot;number of steps&quot;</span>,</span>
<span id="cb606-13"><a href="exercise-solutions.html#cb606-13"></a>    <span class="dt">ylab =</span> <span class="st">&quot;heart rate (beats/min.)&quot;</span>,</span>
<span id="cb606-14"><a href="exercise-solutions.html#cb606-14"></a>    <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb606-15"><a href="exercise-solutions.html#cb606-15"></a>    <span class="dt">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb606-16"><a href="exercise-solutions.html#cb606-16"></a>    <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>,</span>
<span id="cb606-17"><a href="exercise-solutions.html#cb606-17"></a>    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">55</span>, <span class="dv">130</span>))</span>
<span id="cb606-18"><a href="exercise-solutions.html#cb606-18"></a><span class="kw">points</span>(<span class="dt">x =</span> stair_height,</span>
<span id="cb606-19"><a href="exercise-solutions.html#cb606-19"></a>    <span class="dt">y =</span> heart_rate_<span class="dv">2</span>,</span>
<span id="cb606-20"><a href="exercise-solutions.html#cb606-20"></a>    <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>,</span>
<span id="cb606-21"><a href="exercise-solutions.html#cb606-21"></a>    <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb606-22"><a href="exercise-solutions.html#cb606-22"></a>    <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb606-23"><a href="exercise-solutions.html#cb606-23"></a><span class="kw">points</span>(<span class="dt">x =</span> stair_height,</span>
<span id="cb606-24"><a href="exercise-solutions.html#cb606-24"></a>    <span class="dt">y =</span> heart_rate_<span class="dv">3</span>,</span>
<span id="cb606-25"><a href="exercise-solutions.html#cb606-25"></a>    <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb606-26"><a href="exercise-solutions.html#cb606-26"></a>    <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb606-27"><a href="exercise-solutions.html#cb606-27"></a>    <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb606-28"><a href="exercise-solutions.html#cb606-28"></a><span class="kw">points</span>(<span class="dt">x =</span> stair_height,</span>
<span id="cb606-29"><a href="exercise-solutions.html#cb606-29"></a>    <span class="dt">y =</span> heart_rate_<span class="dv">4</span>,</span>
<span id="cb606-30"><a href="exercise-solutions.html#cb606-30"></a>    <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb606-31"><a href="exercise-solutions.html#cb606-31"></a>    <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb606-32"><a href="exercise-solutions.html#cb606-32"></a>    <span class="dt">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/stair-walking-exp-2-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Yes! there is a better more efficient way to do this, but we have not dealt with that yet.</p>
</div>
<div id="chickens-on-a-diet-1" class="section level3">
<h3><span class="header-section-number">11.3.7</span> Chickens on a diet</h3>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="exercise-solutions.html#cb607-1"></a>time &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">16</span>, <span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">21</span>)</span>
<span id="cb607-2"><a href="exercise-solutions.html#cb607-2"></a>chick_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">42</span>, <span class="dv">51</span>, <span class="dv">59</span>, <span class="dv">64</span>, <span class="dv">76</span>, <span class="dv">93</span>, <span class="dv">106</span>, <span class="dv">125</span>, <span class="dv">149</span>, <span class="dv">171</span>, <span class="dv">199</span>, <span class="dv">205</span>)</span>
<span id="cb607-3"><a href="exercise-solutions.html#cb607-3"></a>chick_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">40</span>, <span class="dv">49</span>, <span class="dv">58</span>, <span class="dv">72</span>, <span class="dv">84</span>, <span class="dv">103</span>, <span class="dv">122</span>, <span class="dv">138</span>, <span class="dv">162</span>, <span class="dv">187</span>, <span class="dv">209</span>, <span class="dv">215</span>)</span>
<span id="cb607-4"><a href="exercise-solutions.html#cb607-4"></a>chick_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">42</span>, <span class="dv">53</span>, <span class="dv">62</span>, <span class="dv">73</span>, <span class="dv">85</span>, <span class="dv">102</span>, <span class="dv">123</span>, <span class="dv">138</span>, <span class="dv">170</span>, <span class="dv">204</span>, <span class="dv">235</span>, <span class="dv">256</span>)</span>
<span id="cb607-5"><a href="exercise-solutions.html#cb607-5"></a>chick_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">41</span>, <span class="dv">49</span>, <span class="dv">61</span>, <span class="dv">74</span>, <span class="dv">98</span>, <span class="dv">109</span>, <span class="dv">128</span>, <span class="dv">154</span>, <span class="dv">192</span>, <span class="dv">232</span>, <span class="dv">280</span>, <span class="dv">290</span>)</span>
<span id="cb607-6"><a href="exercise-solutions.html#cb607-6"></a></span>
<span id="cb607-7"><a href="exercise-solutions.html#cb607-7"></a><span class="kw">plot</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> chick_<span class="dv">1</span>,</span>
<span id="cb607-8"><a href="exercise-solutions.html#cb607-8"></a>         <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb607-9"><a href="exercise-solutions.html#cb607-9"></a>         <span class="dt">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb607-10"><a href="exercise-solutions.html#cb607-10"></a>         <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb607-11"><a href="exercise-solutions.html#cb607-11"></a>         <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">40</span>, <span class="dv">300</span>))</span>
<span id="cb607-12"><a href="exercise-solutions.html#cb607-12"></a><span class="kw">points</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> chick_<span class="dv">2</span>,</span>
<span id="cb607-13"><a href="exercise-solutions.html#cb607-13"></a>         <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb607-14"><a href="exercise-solutions.html#cb607-14"></a>         <span class="dt">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb607-15"><a href="exercise-solutions.html#cb607-15"></a>         <span class="dt">lty =</span> <span class="dv">3</span>,</span>
<span id="cb607-16"><a href="exercise-solutions.html#cb607-16"></a>         <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb607-17"><a href="exercise-solutions.html#cb607-17"></a><span class="kw">points</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> chick_<span class="dv">3</span>,</span>
<span id="cb607-18"><a href="exercise-solutions.html#cb607-18"></a>         <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb607-19"><a href="exercise-solutions.html#cb607-19"></a>         <span class="dt">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb607-20"><a href="exercise-solutions.html#cb607-20"></a>         <span class="dt">lty =</span> <span class="dv">1</span>,</span>
<span id="cb607-21"><a href="exercise-solutions.html#cb607-21"></a>         <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb607-22"><a href="exercise-solutions.html#cb607-22"></a><span class="kw">points</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> chick_<span class="dv">4</span>,</span>
<span id="cb607-23"><a href="exercise-solutions.html#cb607-23"></a>         <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb607-24"><a href="exercise-solutions.html#cb607-24"></a>         <span class="dt">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb607-25"><a href="exercise-solutions.html#cb607-25"></a>         <span class="dt">lty =</span> <span class="dv">3</span>,</span>
<span id="cb607-26"><a href="exercise-solutions.html#cb607-26"></a>         <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/chicken-diets1-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="chicken-bar-plot-1" class="section level3">
<h3><span class="header-section-number">11.3.8</span> Chicken bar plot</h3>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="exercise-solutions.html#cb608-1"></a>maxima &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">max</span>(chick_<span class="dv">1</span>), <span class="kw">max</span>(chick_<span class="dv">2</span>), <span class="kw">max</span>(chick_<span class="dv">3</span>), <span class="kw">max</span>(chick_<span class="dv">4</span>))</span>
<span id="cb608-2"><a href="exercise-solutions.html#cb608-2"></a></span>
<span id="cb608-3"><a href="exercise-solutions.html#cb608-3"></a><span class="kw">barplot</span>(maxima,</span>
<span id="cb608-4"><a href="exercise-solutions.html#cb608-4"></a>    <span class="dt">names =</span> <span class="kw">c</span>(<span class="st">&quot;Chick 1&quot;</span>,<span class="st">&quot;Chick 2&quot;</span>,<span class="st">&quot;Chick 3&quot;</span>,<span class="st">&quot;Chick 4&quot;</span>),</span>
<span id="cb608-5"><a href="exercise-solutions.html#cb608-5"></a>    <span class="dt">ylab =</span> <span class="st">&quot;Maximum weight (grams)&quot;</span>,</span>
<span id="cb608-6"><a href="exercise-solutions.html#cb608-6"></a>    <span class="dt">col =</span> <span class="st">&quot;gold&quot;</span>,</span>
<span id="cb608-7"><a href="exercise-solutions.html#cb608-7"></a>    <span class="dt">main =</span> <span class="st">&quot;Maximum chick weights&quot;</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/chicken-diets2-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="discoveries-1" class="section level3">
<h3><span class="header-section-number">11.3.9</span> Discoveries</h3>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="exercise-solutions.html#cb609-1"></a><span class="kw">barplot</span>(<span class="kw">table</span>(discoveries),</span>
<span id="cb609-2"><a href="exercise-solutions.html#cb609-2"></a>    <span class="dt">main =</span> <span class="st">&quot;great discoveries per year&quot;</span>,</span>
<span id="cb609-3"><a href="exercise-solutions.html#cb609-3"></a>    <span class="dt">xlab =</span> <span class="st">&quot;number of discoveries&quot;</span>,</span>
<span id="cb609-4"><a href="exercise-solutions.html#cb609-4"></a>    <span class="dt">ylab =</span> <span class="st">&quot;frequency&quot;</span>,</span>
<span id="cb609-5"><a href="exercise-solutions.html#cb609-5"></a>    <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/discoveries-1-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="exercise-solutions.html#cb610-1"></a><span class="kw">summary</span>(discoveries)</span></code></pre></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="exercise-solutions.html#cb611-1"></a><span class="kw">plot</span>(discoveries,</span>
<span id="cb611-2"><a href="exercise-solutions.html#cb611-2"></a>         <span class="dt">xlab =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb611-3"><a href="exercise-solutions.html#cb611-3"></a>         <span class="dt">ylab =</span> <span class="st">&quot;number of discoveries&quot;</span>,</span>
<span id="cb611-4"><a href="exercise-solutions.html#cb611-4"></a>         <span class="dt">main =</span> <span class="st">&quot;Great discoveries&quot;</span>,</span>
<span id="cb611-5"><a href="exercise-solutions.html#cb611-5"></a>         <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb611-6"><a href="exercise-solutions.html#cb611-6"></a>         <span class="dt">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/discoveries-3-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="lung-cancer-1" class="section level3">
<h3><span class="header-section-number">11.3.10</span> Lung cancer</h3>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="exercise-solutions.html#cb612-1"></a>total.col &lt;-<span class="st"> &quot;red&quot;</span></span>
<span id="cb612-2"><a href="exercise-solutions.html#cb612-2"></a>m.col &lt;-<span class="st"> &quot;blue&quot;</span></span>
<span id="cb612-3"><a href="exercise-solutions.html#cb612-3"></a>f.col &lt;-<span class="st"> &quot;green&quot;</span></span>
<span id="cb612-4"><a href="exercise-solutions.html#cb612-4"></a><span class="kw">plot</span>(ldeaths,</span>
<span id="cb612-5"><a href="exercise-solutions.html#cb612-5"></a>         <span class="dt">main =</span> <span class="st">&quot;deaths from lung cancer&quot;</span>,</span>
<span id="cb612-6"><a href="exercise-solutions.html#cb612-6"></a>         <span class="dt">xlab =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb612-7"><a href="exercise-solutions.html#cb612-7"></a>         <span class="dt">ylab =</span> <span class="st">&quot;number&quot;</span>,</span>
<span id="cb612-8"><a href="exercise-solutions.html#cb612-8"></a>         <span class="dt">col =</span> total.col,</span>
<span id="cb612-9"><a href="exercise-solutions.html#cb612-9"></a>         <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4000</span>),</span>
<span id="cb612-10"><a href="exercise-solutions.html#cb612-10"></a>         <span class="dt">lwd =</span> <span class="dv">2</span></span>
<span id="cb612-11"><a href="exercise-solutions.html#cb612-11"></a>)</span>
<span id="cb612-12"><a href="exercise-solutions.html#cb612-12"></a><span class="kw">lines</span>(fdeaths, <span class="dt">col =</span> f.col, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb612-13"><a href="exercise-solutions.html#cb612-13"></a><span class="kw">lines</span>(mdeaths, <span class="dt">col =</span> m.col, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb612-14"><a href="exercise-solutions.html#cb612-14"></a><span class="kw">legend</span>(</span>
<span id="cb612-15"><a href="exercise-solutions.html#cb612-15"></a>    <span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb612-16"><a href="exercise-solutions.html#cb612-16"></a>    <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;total&quot;</span>, <span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>), </span>
<span id="cb612-17"><a href="exercise-solutions.html#cb612-17"></a>    <span class="dt">col =</span> <span class="kw">c</span>(total.col, f.col, m.col), </span>
<span id="cb612-18"><a href="exercise-solutions.html#cb612-18"></a>    <span class="dt">lty =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/lung-cancer-1-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="exercise-solutions.html#cb613-1"></a><span class="kw">boxplot</span>(</span>
<span id="cb613-2"><a href="exercise-solutions.html#cb613-2"></a>    fdeaths, mdeaths, ldeaths</span>
<span id="cb613-3"><a href="exercise-solutions.html#cb613-3"></a>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/lung-cancer-2-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>ANSWER: You can see a single outlier in the <code>fdeaths</code> set. We can identify the year by finding out when this occurred:</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="exercise-solutions.html#cb614-1"></a><span class="kw">max</span>(fdeaths) <span class="co">## 1141</span></span></code></pre></div>
<pre><code>## [1] 1141</code></pre>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="exercise-solutions.html#cb616-1"></a><span class="kw">which</span>(fdeaths <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(fdeaths)) <span class="co">## index 26</span></span></code></pre></div>
<pre><code>## [1] 26</code></pre>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="exercise-solutions.html#cb618-1"></a>fdeaths</span></code></pre></div>
<pre><code>##       Jan  Feb  Mar  Apr  May  Jun  Jul  Aug  Sep  Oct  Nov  Dec
## 1974  901  689  827  677  522  406  441  393  387  582  578  666
## 1975  830  752  785  664  467  438  421  412  343  440  531  771
## 1976  767 1141  896  532  447  420  376  330  357  445  546  764
## 1977  862  660  663  643  502  392  411  348  387  385  411  638
## 1978  796  853  737  546  530  446  431  362  387  430  425  679
## 1979  821  785  727  612  478  429  405  379  393  411  487  574</code></pre>
<p>So this was February 1976. A quick Google search turned up a pdf document “CDC Influenza Surveillance” that states</p>
<blockquote>
<p>“The 1975-1976 influenza season was noteworthy because of several events. a) An H3N2 influenza virus (A/Victoria/3/75), isolated first in April 1975, caused a wide- spread epidemic late in the influenza season in the United States. Based on pneumonia- and influenza-associated mortality which peaked in February and March 1976, this was the most severe epidemic experienced by the United States since the 1968-1969 Hong Kong epidemic.”</p>
</blockquote>
<p>(<a href="https://stacks.cdc.gov/view/cdc/287/cdc_287_DS1.pdf">direct link</a>)</p>
<p>As you may know, (lung) cancer patients are especially vulnerable for influenza infections.</p>
</div>
</div>
<div id="complex-datatypes-1" class="section level2">
<h2><span class="header-section-number">11.4</span> Complex datatypes</h2>
<div id="creating-factors-1" class="section level3">
<h3><span class="header-section-number">11.4.1</span> Creating factors</h3>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="exercise-solutions.html#cb620-1"></a>animal_risk &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb620-2"><a href="exercise-solutions.html#cb620-2"></a>animal_risk_factor &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="dt">x =</span> animal_risk,</span>
<span id="cb620-3"><a href="exercise-solutions.html#cb620-3"></a>                             <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb620-4"><a href="exercise-solutions.html#cb620-4"></a>                             <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;harmless&quot;</span>, <span class="st">&quot;risky&quot;</span>, <span class="st">&quot;dangerous&quot;</span>, <span class="st">&quot;deadly&quot;</span>),</span>
<span id="cb620-5"><a href="exercise-solutions.html#cb620-5"></a>                             <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</span>
<span id="cb620-6"><a href="exercise-solutions.html#cb620-6"></a><span class="kw">barplot</span>(<span class="kw">table</span>(animal_risk_factor))</span></code></pre></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="exercise-solutions.html#cb621-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb621-2"><a href="exercise-solutions.html#cb621-2"></a>wealth_male &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], </span>
<span id="cb621-3"><a href="exercise-solutions.html#cb621-3"></a>                 <span class="dt">size =</span> <span class="dv">1000</span>,</span>
<span id="cb621-4"><a href="exercise-solutions.html#cb621-4"></a>                 <span class="dt">replace=</span> <span class="ot">TRUE</span>, </span>
<span id="cb621-5"><a href="exercise-solutions.html#cb621-5"></a>                 <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.7</span>, <span class="fl">0.17</span>, <span class="fl">0.12</span>, <span class="fl">0.01</span>))</span>
<span id="cb621-6"><a href="exercise-solutions.html#cb621-6"></a>wealth_female &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], </span>
<span id="cb621-7"><a href="exercise-solutions.html#cb621-7"></a>                 <span class="dt">size =</span> <span class="dv">1000</span>,</span>
<span id="cb621-8"><a href="exercise-solutions.html#cb621-8"></a>                 <span class="dt">replace=</span> <span class="ot">TRUE</span>, </span>
<span id="cb621-9"><a href="exercise-solutions.html#cb621-9"></a>                 <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.8</span>, <span class="fl">0.15</span>, <span class="fl">0.497</span>, <span class="fl">0.003</span>))</span>
<span id="cb621-10"><a href="exercise-solutions.html#cb621-10"></a></span>
<span id="cb621-11"><a href="exercise-solutions.html#cb621-11"></a>wealth_labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;poor&quot;</span>, <span class="st">&quot;middle class&quot;</span>, <span class="st">&quot;wealthy&quot;</span>, <span class="st">&quot;rich&quot;</span>)</span>
<span id="cb621-12"><a href="exercise-solutions.html#cb621-12"></a></span>
<span id="cb621-13"><a href="exercise-solutions.html#cb621-13"></a>wealth_male_f &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="dt">x =</span> wealth_male,</span>
<span id="cb621-14"><a href="exercise-solutions.html#cb621-14"></a>                        <span class="dt">levels =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>],</span>
<span id="cb621-15"><a href="exercise-solutions.html#cb621-15"></a>                        <span class="dt">labels =</span> wealth_labels,</span>
<span id="cb621-16"><a href="exercise-solutions.html#cb621-16"></a>                        <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</span>
<span id="cb621-17"><a href="exercise-solutions.html#cb621-17"></a></span>
<span id="cb621-18"><a href="exercise-solutions.html#cb621-18"></a>wealth_female_f &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="dt">x =</span> wealth_female,</span>
<span id="cb621-19"><a href="exercise-solutions.html#cb621-19"></a>                        <span class="dt">levels =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>],</span>
<span id="cb621-20"><a href="exercise-solutions.html#cb621-20"></a>                        <span class="dt">labels =</span> wealth_labels,</span>
<span id="cb621-21"><a href="exercise-solutions.html#cb621-21"></a>                        <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</span>
<span id="cb621-22"><a href="exercise-solutions.html#cb621-22"></a></span>
<span id="cb621-23"><a href="exercise-solutions.html#cb621-23"></a><span class="co">#combine</span></span>
<span id="cb621-24"><a href="exercise-solutions.html#cb621-24"></a>wealth_all_f &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(wealth_male_f, wealth_female_f),</span>
<span id="cb621-25"><a href="exercise-solutions.html#cb621-25"></a>                        <span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,</span>
<span id="cb621-26"><a href="exercise-solutions.html#cb621-26"></a>                        <span class="dt">labels =</span> wealth_labels,</span>
<span id="cb621-27"><a href="exercise-solutions.html#cb621-27"></a>                        <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</span>
<span id="cb621-28"><a href="exercise-solutions.html#cb621-28"></a></span>
<span id="cb621-29"><a href="exercise-solutions.html#cb621-29"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(wealth_all_f)) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></span></code></pre></div>
<pre><code>## wealth_all_f
##         poor middle class      wealthy         rich 
##        63.65        12.45        23.35         0.55</code></pre>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="exercise-solutions.html#cb623-1"></a><span class="co">#getting this data right may be a bit of a challenge...</span></span>
<span id="cb623-2"><a href="exercise-solutions.html#cb623-2"></a>bar_data &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">table</span>(wealth_female_f), <span class="kw">table</span>(wealth_male_f))</span>
<span id="cb623-3"><a href="exercise-solutions.html#cb623-3"></a><span class="kw">rownames</span>(bar_data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>)</span>
<span id="cb623-4"><a href="exercise-solutions.html#cb623-4"></a></span>
<span id="cb623-5"><a href="exercise-solutions.html#cb623-5"></a><span class="kw">barplot</span>(bar_data, <span class="dt">beside =</span> T, <span class="dt">legend =</span> <span class="kw">rownames</span>(bar_data))</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
</div>
<div id="a-dictionary-with-a-named-vector-1" class="section level3">
<h3><span class="header-section-number">11.4.2</span> A dictionary with a named vector</h3>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="exercise-solutions.html#cb624-1"></a>codons &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;G&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;S&quot;</span>)</span>
<span id="cb624-2"><a href="exercise-solutions.html#cb624-2"></a><span class="kw">names</span>(codons) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;GGA&quot;</span>, <span class="st">&quot;CCU&quot;</span>, <span class="st">&quot;AAA&quot;</span>, <span class="st">&quot;AGU&quot;</span>)</span>
<span id="cb624-3"><a href="exercise-solutions.html#cb624-3"></a></span>
<span id="cb624-4"><a href="exercise-solutions.html#cb624-4"></a>my_DNA &lt;-<span class="st"> &quot;GGACCUAAAAGU&quot;</span></span>
<span id="cb624-5"><a href="exercise-solutions.html#cb624-5"></a>my_prot &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb624-6"><a href="exercise-solutions.html#cb624-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="kw">nchar</span>(my_DNA), <span class="dt">by =</span> <span class="dv">3</span>)) {</span>
<span id="cb624-7"><a href="exercise-solutions.html#cb624-7"></a>        codon &lt;-<span class="st"> </span><span class="kw">substr</span>(my_DNA, i, i<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb624-8"><a href="exercise-solutions.html#cb624-8"></a>        my_prot &lt;-<span class="st"> </span><span class="kw">paste0</span>(my_prot, codons[codon])</span>
<span id="cb624-9"><a href="exercise-solutions.html#cb624-9"></a>}</span>
<span id="cb624-10"><a href="exercise-solutions.html#cb624-10"></a><span class="kw">print</span>(my_prot)</span></code></pre></div>
<pre><code>## [1] &quot;GPKS&quot;</code></pre>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="exercise-solutions.html#cb626-1"></a>nuc_weights &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">491.2</span>, <span class="fl">467.2</span>, <span class="fl">507.2</span>, <span class="fl">482.2</span>)</span>
<span id="cb626-2"><a href="exercise-solutions.html#cb626-2"></a><span class="kw">names</span>(nuc_weights) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;G&#39;</span>, <span class="st">&#39;U&#39;</span>)</span>
<span id="cb626-3"><a href="exercise-solutions.html#cb626-3"></a></span>
<span id="cb626-4"><a href="exercise-solutions.html#cb626-4"></a>mol_weight &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb626-5"><a href="exercise-solutions.html#cb626-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nchar</span>(my_DNA)) {</span>
<span id="cb626-6"><a href="exercise-solutions.html#cb626-6"></a>        nuc &lt;-<span class="st"> </span><span class="kw">substr</span>(my_DNA, i, i);</span>
<span id="cb626-7"><a href="exercise-solutions.html#cb626-7"></a>        <span class="kw">print</span>(nuc)</span>
<span id="cb626-8"><a href="exercise-solutions.html#cb626-8"></a>        mol_weight &lt;-<span class="st"> </span>mol_weight <span class="op">+</span><span class="st"> </span>nuc_weights[nuc]</span>
<span id="cb626-9"><a href="exercise-solutions.html#cb626-9"></a>}</span>
<span id="cb626-10"><a href="exercise-solutions.html#cb626-10"></a>mol_weight</span></code></pre></div>
</div>
<div id="protein-concentrations-with-lowry-1" class="section level3">
<h3><span class="header-section-number">11.4.3</span> Protein concentrations with Lowry</h3>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="exercise-solutions.html#cb627-1"></a>bsa_conc &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,    <span class="dv">0</span>,  <span class="fl">0.025</span>,  <span class="fl">0.025</span>,  <span class="fl">0.075</span>,  <span class="fl">0.075</span>,  <span class="fl">0.125</span>,  <span class="fl">0.125</span>)</span></code></pre></div>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="exercise-solutions.html#cb628-1"></a>OD750 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.063</span>,   <span class="fl">0.033</span>,  <span class="fl">0.16</span>,   <span class="fl">0.181</span>,  <span class="fl">0.346</span>,  <span class="fl">0.352</span>,  <span class="fl">0.491</span>,  <span class="fl">0.488</span>)</span></code></pre></div>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="exercise-solutions.html#cb629-1"></a>dilution &lt;-<span class="st"> </span><span class="kw">data.frame</span>(bsa_conc, OD750)</span></code></pre></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="exercise-solutions.html#cb630-1"></a><span class="kw">names</span>(dilution) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;prot_conc&quot;</span>, <span class="st">&quot;absorption&quot;</span>)</span></code></pre></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="exercise-solutions.html#cb631-1"></a>bsa_conc2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.175</span>,   <span class="fl">0.175</span>,  <span class="fl">0.25</span>,   <span class="fl">0.25</span>)</span>
<span id="cb631-2"><a href="exercise-solutions.html#cb631-2"></a>OD750_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.597</span>, <span class="fl">0.595</span>,  <span class="fl">0.743</span>,  <span class="fl">0.742</span>)</span></code></pre></div>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="exercise-solutions.html#cb632-1"></a>df_temp &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;prot_conc&quot;</span> =<span class="st"> </span>bsa_conc2,</span>
<span id="cb632-2"><a href="exercise-solutions.html#cb632-2"></a>                      <span class="st">&quot;absorption&quot;</span> =<span class="st"> </span>OD750_<span class="dv">2</span>)</span></code></pre></div>
<p><strong>D</strong></p>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="exercise-solutions.html#cb633-1"></a>dilution &lt;-<span class="st"> </span><span class="kw">rbind</span>(dilution, df_temp)</span></code></pre></div>
<p><strong>E</strong></p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="exercise-solutions.html#cb634-1"></a><span class="co"># Your code here</span></span>
<span id="cb634-2"><a href="exercise-solutions.html#cb634-2"></a><span class="kw">plot</span>(dilution<span class="op">$</span>abs <span class="op">~</span><span class="st"> </span>dilution<span class="op">$</span>prot_conc,</span>
<span id="cb634-3"><a href="exercise-solutions.html#cb634-3"></a>     <span class="dt">main =</span> <span class="st">&quot;Absorbance as a function of protein concentration&quot;</span>,</span>
<span id="cb634-4"><a href="exercise-solutions.html#cb634-4"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Protein concentration (mg/ml)&quot;</span>,</span>
<span id="cb634-5"><a href="exercise-solutions.html#cb634-5"></a>     <span class="dt">ylab =</span> <span class="st">&quot;Absorbance at 750 nm (AU)&quot;</span>,</span>
<span id="cb634-6"><a href="exercise-solutions.html#cb634-6"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb634-7"><a href="exercise-solutions.html#cb634-7"></a>     <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>),</span>
<span id="cb634-8"><a href="exercise-solutions.html#cb634-8"></a>     <span class="dt">pch =</span> <span class="dv">19</span>,</span>
<span id="cb634-9"><a href="exercise-solutions.html#cb634-9"></a>     <span class="dt">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb634-10"><a href="exercise-solutions.html#cb634-10"></a>     <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<p><strong>F</strong></p>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="exercise-solutions.html#cb635-1"></a>even &lt;-<span class="st"> </span>dilution[<span class="kw">c</span>(T, F), ]</span>
<span id="cb635-2"><a href="exercise-solutions.html#cb635-2"></a>odd &lt;-<span class="st"> </span>dilution[<span class="kw">c</span>(F, T), ]</span>
<span id="cb635-3"><a href="exercise-solutions.html#cb635-3"></a>dilution_duplo &lt;-<span class="st"> </span><span class="kw">cbind</span>(odd, even)</span>
<span id="cb635-4"><a href="exercise-solutions.html#cb635-4"></a>dilution_duplo</span></code></pre></div>
<pre><code>##    prot_conc absorption prot_conc absorption
## 2      0.000      0.033     0.000      0.063
## 4      0.025      0.181     0.025      0.160
## 6      0.075      0.352     0.075      0.346
## 8      0.125      0.488     0.125      0.491
## 10     0.175      0.595     0.175      0.597
## 12     0.250      0.742     0.250      0.743</code></pre>
<p><strong>G</strong></p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="exercise-solutions.html#cb637-1"></a>dilution_duplo[, <span class="dv">3</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb637-2"><a href="exercise-solutions.html#cb637-2"></a><span class="kw">names</span>(dilution_duplo) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;prot_conc&quot;</span>, <span class="st">&quot;abs1&quot;</span>, <span class="st">&quot;abs2&quot;</span>)</span>
<span id="cb637-3"><a href="exercise-solutions.html#cb637-3"></a>dilution_duplo</span></code></pre></div>
<pre><code>##    prot_conc  abs1  abs2
## 2      0.000 0.033 0.063
## 4      0.025 0.181 0.160
## 6      0.075 0.352 0.346
## 8      0.125 0.488 0.491
## 10     0.175 0.595 0.597
## 12     0.250 0.742 0.743</code></pre>
<p><strong>H</strong></p>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="exercise-solutions.html#cb639-1"></a>dilution_duplo<span class="op">$</span>mean &lt;-<span class="st"> </span>(dilution_duplo<span class="op">$</span>abs1 <span class="op">+</span><span class="st"> </span>dilution_duplo<span class="op">$</span>abs2) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb639-2"><a href="exercise-solutions.html#cb639-2"></a>dilution_duplo</span></code></pre></div>
<pre><code>##    prot_conc  abs1  abs2  mean
## 2      0.000 0.033 0.063 0.048
## 4      0.025 0.181 0.160 0.170
## 6      0.075 0.352 0.346 0.349
## 8      0.125 0.488 0.491 0.489
## 10     0.175 0.595 0.597 0.596
## 12     0.250 0.742 0.743 0.742</code></pre>
<p><strong>I</strong></p>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="exercise-solutions.html#cb641-1"></a><span class="kw">barplot</span>(dilution_duplo<span class="op">$</span>mean <span class="op">~</span><span class="st"> </span>dilution_duplo<span class="op">$</span>prot_conc,</span>
<span id="cb641-2"><a href="exercise-solutions.html#cb641-2"></a>     <span class="dt">main =</span> <span class="st">&quot;Absorbance as a function of protein concentration&quot;</span>,</span>
<span id="cb641-3"><a href="exercise-solutions.html#cb641-3"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Protein concentration (mg/ml)&quot;</span>,</span>
<span id="cb641-4"><a href="exercise-solutions.html#cb641-4"></a>     <span class="dt">ylab =</span> <span class="st">&quot;Absorbance 750nm (AU)&quot;</span>,</span>
<span id="cb641-5"><a href="exercise-solutions.html#cb641-5"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb641-6"><a href="exercise-solutions.html#cb641-6"></a>     <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
</div>
<div id="hplc-data-1" class="section level3">
<h3><span class="header-section-number">11.4.4</span> HPLC data</h3>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="exercise-solutions.html#cb642-1"></a>co &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">100</span>,    <span class="dv">100</span>,    <span class="dv">75</span>, <span class="dv">75</span>, <span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">25</span>, <span class="dv">25</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb642-2"><a href="exercise-solutions.html#cb642-2"></a>pa &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1969017</span>,    <span class="dv">1858012</span>,    <span class="dv">1399762</span>,    <span class="dv">1449423</span>,    <span class="dv">963014</span>, <span class="dv">832137</span>, <span class="dv">467856</span>, <span class="dv">562012</span>, <span class="dv">200123</span>, <span class="dv">145545</span>, <span class="dv">94567</span>,  <span class="dv">64752</span>)</span></code></pre></div>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="exercise-solutions.html#cb643-1"></a><span class="co"># Your code here</span></span>
<span id="cb643-2"><a href="exercise-solutions.html#cb643-2"></a>hplc_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;conc&quot;</span> =<span class="st"> </span>co, <span class="st">&quot;peak_area&quot;</span> =<span class="st"> </span>pa)</span></code></pre></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="exercise-solutions.html#cb644-1"></a><span class="co"># Your code here</span></span>
<span id="cb644-2"><a href="exercise-solutions.html#cb644-2"></a>hplc_data &lt;-<span class="st"> </span>hplc_data[<span class="kw">order</span>(hplc_data<span class="op">$</span>conc), ]</span></code></pre></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="exercise-solutions.html#cb645-1"></a><span class="co"># Your code here</span></span>
<span id="cb645-2"><a href="exercise-solutions.html#cb645-2"></a><span class="kw">plot</span>(hplc_data<span class="op">$</span>peak_area <span class="op">~</span><span class="st"> </span>hplc_data<span class="op">$</span>conc,</span>
<span id="cb645-3"><a href="exercise-solutions.html#cb645-3"></a>     <span class="dt">main =</span> <span class="st">&quot;Peak area as a function of thymol concentration&quot;</span>,</span>
<span id="cb645-4"><a href="exercise-solutions.html#cb645-4"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Thymol concentration (μg/ml)&quot;</span>,</span>
<span id="cb645-5"><a href="exercise-solutions.html#cb645-5"></a>     <span class="dt">ylab =</span> <span class="st">&quot;Peak area (AU)&quot;</span>,</span>
<span id="cb645-6"><a href="exercise-solutions.html#cb645-6"></a>     <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb645-7"><a href="exercise-solutions.html#cb645-7"></a>reg_mod =<span class="st"> </span><span class="kw">lm</span>(hplc_data<span class="op">$</span>peak_area <span class="op">~</span><span class="st"> </span>hplc_data<span class="op">$</span>conc)</span>
<span id="cb645-8"><a href="exercise-solutions.html#cb645-8"></a><span class="kw">abline</span>(reg_mod, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/unnamed-chunk-101-1.png" width="672" /></p>
</div>
<div id="airquality-1" class="section level3">
<h3><span class="header-section-number">11.4.5</span> Airquality</h3>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="exercise-solutions.html#cb646-1"></a><span class="kw">plot</span>(airquality<span class="op">$</span>Solar.R, airquality<span class="op">$</span>Temp,</span>
<span id="cb646-2"><a href="exercise-solutions.html#cb646-2"></a>         <span class="dt">main =</span> <span class="st">&quot;Temperature as a function of Solar radiation&quot;</span>,</span>
<span id="cb646-3"><a href="exercise-solutions.html#cb646-3"></a>         <span class="dt">xlab =</span> <span class="st">&quot;Solar radiation (lang)&quot;</span>,</span>
<span id="cb646-4"><a href="exercise-solutions.html#cb646-4"></a>         <span class="dt">ylab =</span> <span class="st">&quot;Temperature (F)&quot;</span>)</span>
<span id="cb646-5"><a href="exercise-solutions.html#cb646-5"></a><span class="kw">abline</span>(<span class="kw">lm</span>(airquality<span class="op">$</span>Temp <span class="op">~</span><span class="st"> </span>airquality<span class="op">$</span>Solar.R), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/airquality-1-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="exercise-solutions.html#cb647-1"></a><span class="kw">with</span>(datasets<span class="op">::</span>airquality, {</span>
<span id="cb647-2"><a href="exercise-solutions.html#cb647-2"></a>  m &lt;-<span class="st"> </span><span class="kw">factor</span>(Month, <span class="dt">levels =</span> <span class="dv">5</span><span class="op">:</span><span class="dv">9</span>, <span class="dt">labels =</span> month.abb[<span class="dv">5</span><span class="op">:</span><span class="dv">9</span>])</span>
<span id="cb647-3"><a href="exercise-solutions.html#cb647-3"></a>  <span class="kw">boxplot</span>(Temp <span class="op">~</span><span class="st"> </span>m, </span>
<span id="cb647-4"><a href="exercise-solutions.html#cb647-4"></a>    <span class="dt">main =</span> <span class="st">&quot;Temperature over the months&quot;</span>,</span>
<span id="cb647-5"><a href="exercise-solutions.html#cb647-5"></a>    <span class="dt">xlab =</span> <span class="st">&quot;Month&quot;</span>,</span>
<span id="cb647-6"><a href="exercise-solutions.html#cb647-6"></a>    <span class="dt">ylab =</span> <span class="st">&quot;Temperature (F)&quot;</span>)})</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/airquality-2-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="exercise-solutions.html#cb648-1"></a><span class="co">#first create Temp Celcius column:</span></span>
<span id="cb648-2"><a href="exercise-solutions.html#cb648-2"></a><span class="co">#(°F    -    32)    x    5/9 = °C</span></span>
<span id="cb648-3"><a href="exercise-solutions.html#cb648-3"></a>airquality<span class="op">$</span>Temp.C &lt;-<span class="st"> </span>(airquality<span class="op">$</span>Temp <span class="op">-</span><span class="st"> </span><span class="dv">32</span>) <span class="op">*</span><span class="st"> </span><span class="dv">5</span><span class="op">/</span><span class="dv">9</span></span>
<span id="cb648-4"><a href="exercise-solutions.html#cb648-4"></a><span class="co">#get the required data</span></span>
<span id="cb648-5"><a href="exercise-solutions.html#cb648-5"></a>airquality[airquality<span class="op">$</span>Temp.C <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(airquality<span class="op">$</span>Temp.C), <span class="kw">c</span>(<span class="st">&quot;Temp.C&quot;</span>, <span class="st">&quot;Month&quot;</span>, <span class="st">&quot;Day&quot;</span>)]</span></code></pre></div>
<pre><code>##   Temp.C Month Day
## 5   13.3   May   5</code></pre>
<p><strong>D</strong></p>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="exercise-solutions.html#cb650-1"></a><span class="kw">hist</span>(airquality<span class="op">$</span>Wind, <span class="dt">xlab =</span> <span class="st">&quot;Wind speed (mph)&quot;</span>)</span>
<span id="cb650-2"><a href="exercise-solutions.html#cb650-2"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">mean</span>(airquality<span class="op">$</span>Wind), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb650-3"><a href="exercise-solutions.html#cb650-3"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">median</span>(airquality<span class="op">$</span>Wind), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/airquality-4-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><strong>E</strong></p>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="exercise-solutions.html#cb651-1"></a><span class="co">##remove temp celcius agan</span></span>
<span id="cb651-2"><a href="exercise-solutions.html#cb651-2"></a>airquality<span class="op">$</span>Temp.C &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb651-3"><a href="exercise-solutions.html#cb651-3"></a><span class="kw">pairs</span>(airquality, <span class="dt">panel =</span> panel.smooth)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/airquality-5-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Calculate pairwise correlation.</p>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="exercise-solutions.html#cb652-1"></a><span class="kw">cor</span>(<span class="kw">na.omit</span>(airquality))</span></code></pre></div>
<p>The Ozone~Temp pair has the strongest correlation. A scatterplot of this pair:</p>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="exercise-solutions.html#cb653-1"></a><span class="kw">plot</span>(airquality<span class="op">$</span>Ozone <span class="op">~</span><span class="st"> </span>airquality<span class="op">$</span>Temp,</span>
<span id="cb653-2"><a href="exercise-solutions.html#cb653-2"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Temperature (F)&quot;</span>,</span>
<span id="cb653-3"><a href="exercise-solutions.html#cb653-3"></a>     <span class="dt">ylab =</span> <span class="st">&quot;Ozone (ppb)&quot;</span>,</span>
<span id="cb653-4"><a href="exercise-solutions.html#cb653-4"></a>     <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb653-5"><a href="exercise-solutions.html#cb653-5"></a>ozone_wind_lm &lt;-<span class="st"> </span><span class="kw">lm</span>(airquality<span class="op">$</span>Ozone <span class="op">~</span><span class="st"> </span>airquality<span class="op">$</span>Temp)</span>
<span id="cb653-6"><a href="exercise-solutions.html#cb653-6"></a>r_squared &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">summary</span>(ozone_wind_lm)<span class="op">$</span>r.squared, <span class="dv">2</span>)</span>
<span id="cb653-7"><a href="exercise-solutions.html#cb653-7"></a><span class="kw">abline</span>(ozone_wind_lm, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb653-8"><a href="exercise-solutions.html#cb653-8"></a><span class="kw">text</span>(<span class="dt">x =</span> <span class="dv">60</span>, <span class="dt">y =</span> <span class="dv">125</span>, <span class="dt">labels =</span> <span class="kw">paste0</span>(<span class="st">&quot;R^2 = &quot;</span>, r_squared))</span></code></pre></div>
<div class="figure"><span id="fig:airquality-strongest-corr"></span>
<img src="davur_ebook_files/figure-html/airquality-strongest-corr-1.png" alt="Ozone dependency on Temp" width="672" />
<p class="caption">
Figure 11.1: Ozone dependency on Temp
</p>
</div>
</div>
<div id="file-reading-practice-1" class="section level3">
<h3><span class="header-section-number">11.4.6</span> File reading practice</h3>
<p><strong>File 01</strong></p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="exercise-solutions.html#cb654-1"></a>my_dir &lt;-<span class="st"> &quot;data/file_reading&quot;</span></span>
<span id="cb654-2"><a href="exercise-solutions.html#cb654-2"></a>my_file &lt;-<span class="st"> &quot;file01.txt&quot;</span></span>
<span id="cb654-3"><a href="exercise-solutions.html#cb654-3"></a>my_path &lt;-<span class="st"> </span><span class="kw">paste0</span>(my_dir, <span class="st">&quot;/&quot;</span>, my_file)</span>
<span id="cb654-4"><a href="exercise-solutions.html#cb654-4"></a>my_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb654-5"><a href="exercise-solutions.html#cb654-5"></a>    my_path,</span>
<span id="cb654-6"><a href="exercise-solutions.html#cb654-6"></a>    <span class="dt">comment.char =</span> <span class="st">&quot;#&quot;</span>,</span>
<span id="cb654-7"><a href="exercise-solutions.html#cb654-7"></a>    <span class="dt">header =</span> T,</span>
<span id="cb654-8"><a href="exercise-solutions.html#cb654-8"></a>    <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>,</span>
<span id="cb654-9"><a href="exercise-solutions.html#cb654-9"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb654-10"><a href="exercise-solutions.html#cb654-10"></a>    <span class="dt">na.strings =</span> <span class="st">&quot;ND&quot;</span>,</span>
<span id="cb654-11"><a href="exercise-solutions.html#cb654-11"></a>    <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><strong>File 02</strong></p>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="exercise-solutions.html#cb655-1"></a>my_file &lt;-<span class="st"> &quot;file02.txt&quot;</span></span>
<span id="cb655-2"><a href="exercise-solutions.html#cb655-2"></a>my_path &lt;-<span class="st"> </span><span class="kw">paste0</span>(my_dir, <span class="st">&quot;/&quot;</span>, my_file)</span>
<span id="cb655-3"><a href="exercise-solutions.html#cb655-3"></a>my_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb655-4"><a href="exercise-solutions.html#cb655-4"></a>    my_path,</span>
<span id="cb655-5"><a href="exercise-solutions.html#cb655-5"></a>    <span class="dt">comment.char =</span> <span class="st">&quot;$&quot;</span>,</span>
<span id="cb655-6"><a href="exercise-solutions.html#cb655-6"></a>    <span class="dt">header =</span> T,</span>
<span id="cb655-7"><a href="exercise-solutions.html#cb655-7"></a>    <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>,</span>
<span id="cb655-8"><a href="exercise-solutions.html#cb655-8"></a>    <span class="dt">dec =</span> <span class="st">&quot;,&quot;</span>,</span>
<span id="cb655-9"><a href="exercise-solutions.html#cb655-9"></a>    <span class="dt">na.strings =</span> <span class="st">&quot;?&quot;</span>,</span>
<span id="cb655-10"><a href="exercise-solutions.html#cb655-10"></a>    <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb655-11"><a href="exercise-solutions.html#cb655-11"></a>)</span></code></pre></div>
<p><strong>File 03</strong></p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="exercise-solutions.html#cb656-1"></a>my_file &lt;-<span class="st"> &quot;file03.txt&quot;</span></span>
<span id="cb656-2"><a href="exercise-solutions.html#cb656-2"></a>my_path &lt;-<span class="st"> </span><span class="kw">paste0</span>(my_dir, <span class="st">&quot;/&quot;</span>, my_file)</span>
<span id="cb656-3"><a href="exercise-solutions.html#cb656-3"></a>my_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb656-4"><a href="exercise-solutions.html#cb656-4"></a>    my_path,</span>
<span id="cb656-5"><a href="exercise-solutions.html#cb656-5"></a>    <span class="dt">header =</span> T,</span>
<span id="cb656-6"><a href="exercise-solutions.html#cb656-6"></a>    <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>,</span>
<span id="cb656-7"><a href="exercise-solutions.html#cb656-7"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb656-8"><a href="exercise-solutions.html#cb656-8"></a>    <span class="dt">na.strings =</span> <span class="st">&quot;ND&quot;</span>,</span>
<span id="cb656-9"><a href="exercise-solutions.html#cb656-9"></a>    <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb656-10"><a href="exercise-solutions.html#cb656-10"></a>)</span></code></pre></div>
<p><strong>File 04</strong></p>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="exercise-solutions.html#cb657-1"></a>my_file &lt;-<span class="st"> &quot;file04.txt&quot;</span></span>
<span id="cb657-2"><a href="exercise-solutions.html#cb657-2"></a>my_path &lt;-<span class="st"> </span><span class="kw">paste0</span>(my_dir, <span class="st">&quot;/&quot;</span>, my_file)</span>
<span id="cb657-3"><a href="exercise-solutions.html#cb657-3"></a>my_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb657-4"><a href="exercise-solutions.html#cb657-4"></a>    my_path,</span>
<span id="cb657-5"><a href="exercise-solutions.html#cb657-5"></a>    <span class="dt">header =</span> T,</span>
<span id="cb657-6"><a href="exercise-solutions.html#cb657-6"></a>    <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>,</span>
<span id="cb657-7"><a href="exercise-solutions.html#cb657-7"></a>    <span class="dt">dec =</span> <span class="st">&quot;,&quot;</span>,</span>
<span id="cb657-8"><a href="exercise-solutions.html#cb657-8"></a>    <span class="dt">na.strings =</span> <span class="st">&quot;no data&quot;</span>,</span>
<span id="cb657-9"><a href="exercise-solutions.html#cb657-9"></a>    <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb657-10"><a href="exercise-solutions.html#cb657-10"></a>)</span></code></pre></div>
<p><strong>File 05</strong></p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="exercise-solutions.html#cb658-1"></a>my_file &lt;-<span class="st"> &quot;file05.txt&quot;</span></span>
<span id="cb658-2"><a href="exercise-solutions.html#cb658-2"></a>my_path &lt;-<span class="st"> </span><span class="kw">paste0</span>(my_dir, <span class="st">&quot;/&quot;</span>, my_file)</span>
<span id="cb658-3"><a href="exercise-solutions.html#cb658-3"></a>my_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb658-4"><a href="exercise-solutions.html#cb658-4"></a>    my_path,</span>
<span id="cb658-5"><a href="exercise-solutions.html#cb658-5"></a>    <span class="dt">comment.char =</span> <span class="st">&quot;#&quot;</span>,</span>
<span id="cb658-6"><a href="exercise-solutions.html#cb658-6"></a>    <span class="dt">header =</span> T,</span>
<span id="cb658-7"><a href="exercise-solutions.html#cb658-7"></a>    <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>,</span>
<span id="cb658-8"><a href="exercise-solutions.html#cb658-8"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb658-9"><a href="exercise-solutions.html#cb658-9"></a>    <span class="dt">na.strings =</span> <span class="st">&quot;ND&quot;</span>,</span>
<span id="cb658-10"><a href="exercise-solutions.html#cb658-10"></a>    <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb658-11"><a href="exercise-solutions.html#cb658-11"></a>)</span></code></pre></div>
<p><strong>File 06</strong></p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="exercise-solutions.html#cb659-1"></a>my_file &lt;-<span class="st"> &quot;file06.txt&quot;</span></span>
<span id="cb659-2"><a href="exercise-solutions.html#cb659-2"></a>my_path &lt;-<span class="st"> </span><span class="kw">paste0</span>(my_dir, <span class="st">&quot;/&quot;</span>, my_file)</span>
<span id="cb659-3"><a href="exercise-solutions.html#cb659-3"></a>my_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb659-4"><a href="exercise-solutions.html#cb659-4"></a>    my_path,</span>
<span id="cb659-5"><a href="exercise-solutions.html#cb659-5"></a>    <span class="dt">comment.char =</span> <span class="st">&quot;#&quot;</span>,</span>
<span id="cb659-6"><a href="exercise-solutions.html#cb659-6"></a>    <span class="dt">header =</span> T,</span>
<span id="cb659-7"><a href="exercise-solutions.html#cb659-7"></a>    <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>,</span>
<span id="cb659-8"><a href="exercise-solutions.html#cb659-8"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb659-9"><a href="exercise-solutions.html#cb659-9"></a>    <span class="dt">na.strings =</span> <span class="st">&quot;-&quot;</span>,</span>
<span id="cb659-10"><a href="exercise-solutions.html#cb659-10"></a>    <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb659-11"><a href="exercise-solutions.html#cb659-11"></a>my_data</span></code></pre></div>
<p><strong>File 07</strong></p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="exercise-solutions.html#cb660-1"></a>my_file &lt;-<span class="st"> &quot;file07.txt&quot;</span></span>
<span id="cb660-2"><a href="exercise-solutions.html#cb660-2"></a>my_path &lt;-<span class="st"> </span><span class="kw">paste0</span>(my_dir, <span class="st">&quot;/&quot;</span>, my_file)</span>
<span id="cb660-3"><a href="exercise-solutions.html#cb660-3"></a>my_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb660-4"><a href="exercise-solutions.html#cb660-4"></a>    my_path,</span>
<span id="cb660-5"><a href="exercise-solutions.html#cb660-5"></a>    <span class="dt">comment.char =</span> <span class="st">&quot;#&quot;</span>,</span>
<span id="cb660-6"><a href="exercise-solutions.html#cb660-6"></a>    <span class="dt">header =</span> F,</span>
<span id="cb660-7"><a href="exercise-solutions.html#cb660-7"></a>    <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>,</span>
<span id="cb660-8"><a href="exercise-solutions.html#cb660-8"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb660-9"><a href="exercise-solutions.html#cb660-9"></a>    <span class="dt">na.strings =</span> <span class="st">&quot;-&quot;</span>,</span>
<span id="cb660-10"><a href="exercise-solutions.html#cb660-10"></a>    <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><strong>File 08</strong></p>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="exercise-solutions.html#cb661-1"></a>my_file &lt;-<span class="st"> &quot;file08.txt&quot;</span></span>
<span id="cb661-2"><a href="exercise-solutions.html#cb661-2"></a>my_path &lt;-<span class="st"> </span><span class="kw">paste0</span>(my_dir, <span class="st">&quot;/&quot;</span>, my_file)</span>
<span id="cb661-3"><a href="exercise-solutions.html#cb661-3"></a>my_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb661-4"><a href="exercise-solutions.html#cb661-4"></a>    my_path,</span>
<span id="cb661-5"><a href="exercise-solutions.html#cb661-5"></a>    <span class="dt">comment.char =</span> <span class="st">&quot;@&quot;</span>,</span>
<span id="cb661-6"><a href="exercise-solutions.html#cb661-6"></a>    <span class="dt">header =</span> T,</span>
<span id="cb661-7"><a href="exercise-solutions.html#cb661-7"></a>    <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>,</span>
<span id="cb661-8"><a href="exercise-solutions.html#cb661-8"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb661-9"><a href="exercise-solutions.html#cb661-9"></a>    <span class="dt">na.strings =</span> <span class="st">&quot;ND&quot;</span>,</span>
<span id="cb661-10"><a href="exercise-solutions.html#cb661-10"></a>    <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><strong>File 09</strong></p>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="exercise-solutions.html#cb662-1"></a>my_file &lt;-<span class="st"> &quot;file09.txt&quot;</span></span>
<span id="cb662-2"><a href="exercise-solutions.html#cb662-2"></a>my_path &lt;-<span class="st"> </span><span class="kw">paste0</span>(my_dir, <span class="st">&quot;/&quot;</span>, my_file)</span>
<span id="cb662-3"><a href="exercise-solutions.html#cb662-3"></a>my_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb662-4"><a href="exercise-solutions.html#cb662-4"></a>    my_path,</span>
<span id="cb662-5"><a href="exercise-solutions.html#cb662-5"></a>    <span class="dt">header =</span> T,</span>
<span id="cb662-6"><a href="exercise-solutions.html#cb662-6"></a>    <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>,</span>
<span id="cb662-7"><a href="exercise-solutions.html#cb662-7"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb662-8"><a href="exercise-solutions.html#cb662-8"></a>    <span class="dt">na.strings =</span> <span class="st">&quot;?&quot;</span>,</span>
<span id="cb662-9"><a href="exercise-solutions.html#cb662-9"></a>    <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><strong>File 10</strong></p>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="exercise-solutions.html#cb663-1"></a>my_file &lt;-<span class="st"> &quot;file10.txt&quot;</span></span>
<span id="cb663-2"><a href="exercise-solutions.html#cb663-2"></a>my_path &lt;-<span class="st"> </span><span class="kw">paste0</span>(my_dir, <span class="st">&quot;/&quot;</span>, my_file)</span>
<span id="cb663-3"><a href="exercise-solutions.html#cb663-3"></a>my_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb663-4"><a href="exercise-solutions.html#cb663-4"></a>    my_path,</span>
<span id="cb663-5"><a href="exercise-solutions.html#cb663-5"></a>    <span class="dt">header =</span> F,</span>
<span id="cb663-6"><a href="exercise-solutions.html#cb663-6"></a>    <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>,</span>
<span id="cb663-7"><a href="exercise-solutions.html#cb663-7"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb663-8"><a href="exercise-solutions.html#cb663-8"></a>    <span class="dt">na.strings =</span> <span class="st">&quot;no data&quot;</span>,</span>
<span id="cb663-9"><a href="exercise-solutions.html#cb663-9"></a>    <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><strong>File 11</strong></p>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="exercise-solutions.html#cb664-1"></a>my_file &lt;-<span class="st"> &quot;file11.txt&quot;</span></span>
<span id="cb664-2"><a href="exercise-solutions.html#cb664-2"></a>my_path &lt;-<span class="st"> </span><span class="kw">paste0</span>(my_dir, <span class="st">&quot;/&quot;</span>, my_file)</span>
<span id="cb664-3"><a href="exercise-solutions.html#cb664-3"></a>my_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb664-4"><a href="exercise-solutions.html#cb664-4"></a>    my_path,</span>
<span id="cb664-5"><a href="exercise-solutions.html#cb664-5"></a>    <span class="dt">header =</span> T,</span>
<span id="cb664-6"><a href="exercise-solutions.html#cb664-6"></a>    <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>,</span>
<span id="cb664-7"><a href="exercise-solutions.html#cb664-7"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb664-8"><a href="exercise-solutions.html#cb664-8"></a>    <span class="dt">na.strings =</span> <span class="st">&quot;-&quot;</span>,</span>
<span id="cb664-9"><a href="exercise-solutions.html#cb664-9"></a>    <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><strong>File 12</strong></p>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="exercise-solutions.html#cb665-1"></a>my_file &lt;-<span class="st"> &quot;file12.txt&quot;</span></span>
<span id="cb665-2"><a href="exercise-solutions.html#cb665-2"></a>my_path &lt;-<span class="st"> </span><span class="kw">paste0</span>(my_dir, <span class="st">&quot;/&quot;</span>, my_file)</span>
<span id="cb665-3"><a href="exercise-solutions.html#cb665-3"></a>my_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb665-4"><a href="exercise-solutions.html#cb665-4"></a>    my_path,</span>
<span id="cb665-5"><a href="exercise-solutions.html#cb665-5"></a>    <span class="dt">header =</span> T,</span>
<span id="cb665-6"><a href="exercise-solutions.html#cb665-6"></a>    <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>,</span>
<span id="cb665-7"><a href="exercise-solutions.html#cb665-7"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb665-8"><a href="exercise-solutions.html#cb665-8"></a>    <span class="dt">na.strings =</span> <span class="st">&quot;-1&quot;</span>,</span>
<span id="cb665-9"><a href="exercise-solutions.html#cb665-9"></a>    <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><strong>File 13</strong></p>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="exercise-solutions.html#cb666-1"></a>my_file &lt;-<span class="st"> &quot;file13.txt&quot;</span></span>
<span id="cb666-2"><a href="exercise-solutions.html#cb666-2"></a>my_path &lt;-<span class="st"> </span><span class="kw">paste0</span>(my_dir, <span class="st">&quot;/&quot;</span>, my_file)</span>
<span id="cb666-3"><a href="exercise-solutions.html#cb666-3"></a>my_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb666-4"><a href="exercise-solutions.html#cb666-4"></a>    my_path,</span>
<span id="cb666-5"><a href="exercise-solutions.html#cb666-5"></a>    <span class="dt">comment.char =</span> <span class="st">&quot;$&quot;</span>,</span>
<span id="cb666-6"><a href="exercise-solutions.html#cb666-6"></a>    <span class="dt">header =</span> F,</span>
<span id="cb666-7"><a href="exercise-solutions.html#cb666-7"></a>    <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>,</span>
<span id="cb666-8"><a href="exercise-solutions.html#cb666-8"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb666-9"><a href="exercise-solutions.html#cb666-9"></a>    <span class="dt">na.strings =</span> <span class="st">&quot;?&quot;</span>,</span>
<span id="cb666-10"><a href="exercise-solutions.html#cb666-10"></a>    <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><strong>File 14</strong></p>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="exercise-solutions.html#cb667-1"></a>my_file &lt;-<span class="st"> &quot;file14.txt&quot;</span></span>
<span id="cb667-2"><a href="exercise-solutions.html#cb667-2"></a>my_path &lt;-<span class="st"> </span><span class="kw">paste0</span>(my_dir, <span class="st">&quot;/&quot;</span>, my_file)</span>
<span id="cb667-3"><a href="exercise-solutions.html#cb667-3"></a>my_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb667-4"><a href="exercise-solutions.html#cb667-4"></a>    my_path,</span>
<span id="cb667-5"><a href="exercise-solutions.html#cb667-5"></a>    <span class="dt">comment.char =</span> <span class="st">&quot;$&quot;</span>,</span>
<span id="cb667-6"><a href="exercise-solutions.html#cb667-6"></a>    <span class="dt">header =</span> T,</span>
<span id="cb667-7"><a href="exercise-solutions.html#cb667-7"></a>    <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>,</span>
<span id="cb667-8"><a href="exercise-solutions.html#cb667-8"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb667-9"><a href="exercise-solutions.html#cb667-9"></a>    <span class="dt">na.strings =</span> <span class="st">&quot;no data&quot;</span>,</span>
<span id="cb667-10"><a href="exercise-solutions.html#cb667-10"></a>    <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><strong>File 15</strong></p>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="exercise-solutions.html#cb668-1"></a>my_file &lt;-<span class="st"> &quot;file15.txt&quot;</span></span>
<span id="cb668-2"><a href="exercise-solutions.html#cb668-2"></a>my_path &lt;-<span class="st"> </span><span class="kw">paste0</span>(my_dir, <span class="st">&quot;/&quot;</span>, my_file)</span>
<span id="cb668-3"><a href="exercise-solutions.html#cb668-3"></a>my_data &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb668-4"><a href="exercise-solutions.html#cb668-4"></a>    my_path,</span>
<span id="cb668-5"><a href="exercise-solutions.html#cb668-5"></a>    <span class="dt">comment.char =</span> <span class="st">&quot;#&quot;</span>,</span>
<span id="cb668-6"><a href="exercise-solutions.html#cb668-6"></a>    <span class="dt">header =</span> T,</span>
<span id="cb668-7"><a href="exercise-solutions.html#cb668-7"></a>    <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>,</span>
<span id="cb668-8"><a href="exercise-solutions.html#cb668-8"></a>    <span class="dt">dec =</span> <span class="st">&quot;,&quot;</span>,</span>
<span id="cb668-9"><a href="exercise-solutions.html#cb668-9"></a>    <span class="dt">na.strings =</span> <span class="st">&quot;?&quot;</span>,</span>
<span id="cb668-10"><a href="exercise-solutions.html#cb668-10"></a>    <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span></code></pre></div>
</div>
<div id="bird-observations-1" class="section level3">
<h3><span class="header-section-number">11.4.7</span> Bird observations</h3>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="exercise-solutions.html#cb669-1"></a>bird_obs &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/Observations-Data-2014.csv&quot;</span>, </span>
<span id="cb669-2"><a href="exercise-solutions.html#cb669-2"></a>                                             <span class="dt">sep=</span><span class="st">&quot;;&quot;</span>, </span>
<span id="cb669-3"><a href="exercise-solutions.html#cb669-3"></a>                                             <span class="dt">head=</span>T, </span>
<span id="cb669-4"><a href="exercise-solutions.html#cb669-4"></a>                                             <span class="dt">na.strings =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb669-5"><a href="exercise-solutions.html#cb669-5"></a>                                             <span class="dt">quote =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb669-6"><a href="exercise-solutions.html#cb669-6"></a>                                             <span class="dt">comment.char =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="exercise-solutions.html#cb670-1"></a><span class="co">## look at the loaded data structure</span></span>
<span id="cb670-2"><a href="exercise-solutions.html#cb670-2"></a><span class="kw">str</span>(bird_obs)</span></code></pre></div>
<p>Apparently, all variables are loaded as a factor; also the <code>Date.start</code>, <code>Date.end</code> (should be dates of course), <code>Number</code> (should be <code>integer</code>) and <code>Notes</code> (should be <code>character</code>) columns. In the original column names there are spaces and these are replaced by dots. First column <code>Species..</code> is a serial number and the second <code>Species</code> is the English species name.</p>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="exercise-solutions.html#cb671-1"></a><span class="kw">nrow</span>(bird_obs)</span></code></pre></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="exercise-solutions.html#cb672-1"></a><span class="kw">class</span>(bird_obs<span class="op">$</span>Number)</span></code></pre></div>
<p><strong>D</strong></p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="exercise-solutions.html#cb673-1"></a>bird_obs<span class="op">$</span>Count &lt;-<span class="st"> </span><span class="kw">as.integer</span>(bird_obs<span class="op">$</span>Number)</span></code></pre></div>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="exercise-solutions.html#cb675-1"></a><span class="kw">head</span>(bird_obs[, <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">14</span>)], <span class="dt">n=</span><span class="dv">50</span>)</span></code></pre></div>
<pre><code>##                    Common.name Number Count
## 1  Greater White-fronted Goose      1     1
## 2  Greater White-fronted Goose      6     6
## 3  Greater White-fronted Goose      1     1
## 4  Greater White-fronted Goose      1     1
## 5  Greater White-fronted Goose      2     2
## 6                   Snow Goose      1     1
## 7                 Ross&#39;s Goose      1     1
## 8                 Ross&#39;s Goose      1     1
## 9                 Ross&#39;s Goose      1     1
## 10                Ross&#39;s Goose      1     1
## 11                       Brant    3-6    NA
## 12                       Brant      1     1
## 13                       Brant    300   300
## 14                       Brant      1     1
## 15                       Brant      3     3
## 16                       Brant      2     2
## 17                       Brant      9     9
## 18              Cackling Goose      3     3
## 19              Cackling Goose      1     1
## 20              Cackling Goose      1     1
## 21              Cackling Goose      1     1
## 22              Cackling Goose      1     1
## 23              Cackling Goose      3     3
## 24              Trumpeter Swan      6     6
## 25                 Tundra Swan      2     2
## 26                 Tundra Swan      1     1
## 27                 Tundra Swan      2     2
## 28                 Tundra Swan      3     3
## 29                 Tundra Swan      2     2
## 30                 Tundra Swan      1     1
## 31                 Tundra Swan      3     3
## 32                 Tundra Swan      1     1
## 33                 Tundra Swan    145   145
## 34                 Tundra Swan      6     6
## 35                 Tundra Swan     18    18
## 36                 Tundra Swan      3     3
## 37                   Wood Duck      1     1
## 38                     Gadwall      2     2
## 39                     Gadwall      3     3
## 40                     Gadwall      1     1
## 41             Eurasian Wigeon      1     1
## 42             American Wigeon      2     2
## 43             American Wigeon      3     3
## 44             American Wigeon      1     1
## 45             American Wigeon      1     1
## 46             American Wigeon    1-2    NA
## 47             American Wigeon    2-5    NA
## 48            Blue-winged Teal      3     3
## 49            Blue-winged Teal      1     1
## 50            Blue-winged Teal      1     1</code></pre>
<p>The factor <strong><em>levels</em></strong> have been converted into integers, not the original values!</p>
<p><strong>E</strong></p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="exercise-solutions.html#cb677-1"></a><span class="co">#best is to get it right from the start: read with as.is argument</span></span>
<span id="cb677-2"><a href="exercise-solutions.html#cb677-2"></a>bird_obs &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/Observations-Data-2014.csv&quot;</span>,</span>
<span id="cb677-3"><a href="exercise-solutions.html#cb677-3"></a>                                <span class="dt">sep=</span><span class="st">&quot;;&quot;</span>,</span>
<span id="cb677-4"><a href="exercise-solutions.html#cb677-4"></a>                                <span class="dt">head=</span>T,</span>
<span id="cb677-5"><a href="exercise-solutions.html#cb677-5"></a>                                <span class="dt">na.strings =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb677-6"><a href="exercise-solutions.html#cb677-6"></a>                                <span class="dt">quote =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb677-7"><a href="exercise-solutions.html#cb677-7"></a>                                <span class="dt">comment.char =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb677-8"><a href="exercise-solutions.html#cb677-8"></a>                                <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">13</span>))</span>
<span id="cb677-9"><a href="exercise-solutions.html#cb677-9"></a><span class="kw">str</span>(bird_obs)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    2019 obs. of  13 variables:
##  $ Species..  : chr  &quot;4&quot; &quot;4&quot; &quot;4&quot; &quot;4&quot; ...
##  $ Genus      : Factor w/ 166 levels &quot;Accipiter&quot;,&quot;Agelaius&quot;,..: 8 8 8 8 8 38 38 38 38 38 ...
##  $ Species    : Factor w/ 300 levels &quot;aalge&quot;,&quot;acuta&quot;,..: 11 11 11 11 11 42 235 235 235 235 ...
##  $ Common.name: Factor w/ 329 levels &quot;Acorn Woodpecker&quot;,..: 121 121 121 121 121 266 239 239 239 239 ...
##  $ CBRC.Review: Factor w/ 3 levels &quot;FALSE&quot;,&quot;N&quot;,&quot;Y&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ Date.start : chr  &quot;3-Jun-14&quot; &quot;28-Jul-14&quot; &quot;1-Sep-14&quot; &quot;2-Sep-14&quot; ...
##  $ Date.end   : chr  &quot;19-Jun-14&quot; NA NA NA ...
##  $ Number     : chr  &quot;1&quot; &quot;6&quot; &quot;1&quot; &quot;1&quot; ...
##  $ Location   : Factor w/ 980 levels &quot; Coyote Creek Trail San Jose&quot;,..: 629 639 169 503 28 673 503 503 420 420 ...
##  $ County     : Factor w/ 9 levels &quot;Alameda&quot;,&quot;Contra Costa&quot;,..: 7 4 9 9 3 9 9 9 4 4 ...
##  $ Observer.1 : Factor w/ 692 levels &quot;A Sojourner&quot;,..: 216 351 544 623 333 623 623 623 323 206 ...
##  $ Other.Obs  : Factor w/ 157 levels &quot;Aaron Maizlish&quot;,..: NA NA NA NA NA NA NA NA 155 NA ...
##  $ Notes      : chr  &quot;Adult bird seen on golf course grounds with Canada geese!&quot; &quot;Saw 6 along the shoreline of Napa Creek in mid-afternoon.  About 10 Mallards also  swimming nearby and a Caspia&quot;| __truncated__ NA &quot;This is the only bird that matches up with what I saw. Canada like goose, snow white bum prominent, coloring sl&quot;| __truncated__ ...</code></pre>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="exercise-solutions.html#cb679-1"></a><span class="co">##alternatively, convert it after loading:</span></span>
<span id="cb679-2"><a href="exercise-solutions.html#cb679-2"></a><span class="co">#bird_obs$Count &lt;- as.numeric(as.character(bird_obs$Number))</span></span></code></pre></div>
<p>Convert Number column to Count of integers.</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="exercise-solutions.html#cb680-1"></a>bird_obs<span class="op">$</span>Count &lt;-<span class="st"> </span><span class="kw">as.integer</span>(bird_obs<span class="op">$</span>Number)</span></code></pre></div>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<p>Note that there are other ways to achieve this, e.g. the <code>colClasses</code> argument to <code>read.table()</code>.</p>
<p><strong>F</strong></p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="exercise-solutions.html#cb682-1"></a><span class="kw">head</span>(bird_obs[, <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">14</span>)], <span class="dt">n=</span><span class="dv">50</span>)</span>
<span id="cb682-2"><a href="exercise-solutions.html#cb682-2"></a><span class="kw">sum</span>(<span class="kw">is.na</span>(bird_obs<span class="op">$</span>Count))</span></code></pre></div>
<p><strong>G</strong></p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="exercise-solutions.html#cb683-1"></a><span class="co">#What is the maximum number of birds in a single sighting?</span></span>
<span id="cb683-2"><a href="exercise-solutions.html#cb683-2"></a></span>
<span id="cb683-3"><a href="exercise-solutions.html#cb683-3"></a>bird_obs[bird_obs<span class="op">$</span>Count <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(bird_obs<span class="op">$</span>Count, <span class="dt">na.rm =</span> T), ]</span>
<span id="cb683-4"><a href="exercise-solutions.html#cb683-4"></a><span class="co">##OR</span></span>
<span id="cb683-5"><a href="exercise-solutions.html#cb683-5"></a>bird_obs[<span class="op">!</span><span class="kw">is.na</span>(bird_obs<span class="op">$</span>Count) <span class="op">&amp;</span><span class="st"> </span>bird_obs<span class="op">$</span>Count <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(bird_obs<span class="op">$</span>Count, <span class="dt">na.rm =</span> T), ]</span>
<span id="cb683-6"><a href="exercise-solutions.html#cb683-6"></a></span>
<span id="cb683-7"><a href="exercise-solutions.html#cb683-7"></a><span class="co">#What is the mean sighting count</span></span>
<span id="cb683-8"><a href="exercise-solutions.html#cb683-8"></a><span class="kw">mean</span>(bird_obs<span class="op">$</span>Count, <span class="dt">na.rm =</span> T)</span>
<span id="cb683-9"><a href="exercise-solutions.html#cb683-9"></a></span>
<span id="cb683-10"><a href="exercise-solutions.html#cb683-10"></a><span class="co">#What is the median of the sighting count</span></span>
<span id="cb683-11"><a href="exercise-solutions.html#cb683-11"></a><span class="kw">median</span>(bird_obs<span class="op">$</span>Count, <span class="dt">na.rm =</span> T)</span></code></pre></div>
<p><strong>H</strong></p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="exercise-solutions.html#cb684-1"></a><span class="kw">hist</span>(bird_obs<span class="op">$</span>Count)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/bird-obs-1-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Not very helpful, now is it? Try fiddling with the <code>breaks</code> argument.</p>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="exercise-solutions.html#cb685-1"></a><span class="kw">plot</span>(<span class="kw">density</span>(bird_obs<span class="op">$</span>Count, <span class="dt">na.rm=</span>T),</span>
<span id="cb685-2"><a href="exercise-solutions.html#cb685-2"></a>         <span class="dt">main =</span> <span class="st">&quot;density of Counts&quot;</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/bird-obs-2-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Better results with a log transformation (and some coloring)</p>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="exercise-solutions.html#cb686-1"></a>d &lt;-<span class="st"> </span><span class="kw">density</span>(<span class="kw">log</span>(bird_obs<span class="op">$</span>Count), <span class="dt">na.rm=</span>T)</span>
<span id="cb686-2"><a href="exercise-solutions.html#cb686-2"></a><span class="kw">plot</span>(d, <span class="dt">main =</span> <span class="st">&quot;density of log-transformed Counts&quot;</span>)</span>
<span id="cb686-3"><a href="exercise-solutions.html#cb686-3"></a><span class="kw">polygon</span>(d, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/bird-obs-3-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>The Shapiro test gives us a numeric indication of the fit to a normal distribution:</p>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="exercise-solutions.html#cb687-1"></a><span class="kw">shapiro.test</span>(bird_obs<span class="op">$</span>Count)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  bird_obs$Count
## W = 0.01, p-value &lt;2e-16</code></pre>
<p>The P-value -way below 0.05- indicates this is not a normal distribution. But we’ve seen that already of course.</p>
<p><strong>I</strong></p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="exercise-solutions.html#cb689-1"></a><span class="co">#How many different species were recorded?</span></span>
<span id="cb689-2"><a href="exercise-solutions.html#cb689-2"></a><span class="kw">length</span>(<span class="kw">unique</span>(bird_obs<span class="op">$</span>Common.name))</span>
<span id="cb689-3"><a href="exercise-solutions.html#cb689-3"></a></span>
<span id="cb689-4"><a href="exercise-solutions.html#cb689-4"></a><span class="co">#How many genera do they constitute?</span></span>
<span id="cb689-5"><a href="exercise-solutions.html#cb689-5"></a><span class="kw">length</span>(<span class="kw">unique</span>(bird_obs<span class="op">$</span>Genus))</span>
<span id="cb689-6"><a href="exercise-solutions.html#cb689-6"></a></span>
<span id="cb689-7"><a href="exercise-solutions.html#cb689-7"></a><span class="co">#What species from the genus &quot;Puffinus&quot; have been observed?</span></span>
<span id="cb689-8"><a href="exercise-solutions.html#cb689-8"></a><span class="co">#the actual sightings</span></span>
<span id="cb689-9"><a href="exercise-solutions.html#cb689-9"></a>bird_obs[bird_obs<span class="op">$</span>Genus <span class="op">==</span><span class="st"> &quot;Puffinus&quot;</span>, <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">14</span>)]</span>
<span id="cb689-10"><a href="exercise-solutions.html#cb689-10"></a><span class="co">#the species</span></span>
<span id="cb689-11"><a href="exercise-solutions.html#cb689-11"></a><span class="kw">unique</span>(bird_obs[bird_obs<span class="op">$</span>Genus <span class="op">==</span><span class="st"> &quot;Puffinus&quot;</span>, <span class="st">&quot;Common.name&quot;</span>])</span></code></pre></div>
<p>The challenge</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="exercise-solutions.html#cb690-1"></a>common_names &lt;-<span class="st"> </span><span class="kw">unique</span>(bird_obs<span class="op">$</span>Common.name)</span>
<span id="cb690-2"><a href="exercise-solutions.html#cb690-2"></a>scientific_names &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">paste0</span>(bird_obs<span class="op">$</span>Genus, <span class="st">&quot; &quot;</span>, bird_obs<span class="op">$</span>Species))</span>
<span id="cb690-3"><a href="exercise-solutions.html#cb690-3"></a><span class="kw">paste0</span>(<span class="st">&quot;number of common names: &quot;</span>, <span class="kw">length</span>(common_names), <span class="st">&quot;; number of scientific names: &quot;</span>,  <span class="kw">length</span>(scientific_names))</span></code></pre></div>
<pre><code>## [1] &quot;number of common names: 330; number of scientific names: 325&quot;</code></pre>
<p>So there is something fishy going on.
My guess is that one more species has two common names for two <em>subspecies</em> where, of course, there will be only one scientific species name. Which? Dunno. Can you find out?</p>
<p>OK, I couldn’t help myself. I do NOT expect you to be able to do serious mangling like this at the end of this course!</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="exercise-solutions.html#cb692-1"></a>scientific_all &lt;-<span class="st"> </span><span class="kw">paste0</span>(bird_obs<span class="op">$</span>Genus, <span class="st">&quot; &quot;</span>, bird_obs<span class="op">$</span>Species)</span>
<span id="cb692-2"><a href="exercise-solutions.html#cb692-2"></a><span class="co">##combine scientific and common andf make unique</span></span>
<span id="cb692-3"><a href="exercise-solutions.html#cb692-3"></a>combined &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">paste0</span>(scientific_all, <span class="st">&quot;:&quot;</span>, bird_obs<span class="op">$</span>Common.name))</span>
<span id="cb692-4"><a href="exercise-solutions.html#cb692-4"></a><span class="co">#split it again, and convert to dataframe (strsplit gives a list)</span></span>
<span id="cb692-5"><a href="exercise-solutions.html#cb692-5"></a>combined_split &lt;-<span class="st"> </span><span class="kw">strsplit</span>(<span class="dt">x =</span> combined, <span class="dt">split =</span> <span class="st">&quot;:&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in strsplit(x = combined, split = &quot;:&quot;): input string 189 is invalid in
## this locale</code></pre>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="exercise-solutions.html#cb694-1"></a>combined_split &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">do.call</span>(rbind, combined_split))</span>
<span id="cb694-2"><a href="exercise-solutions.html#cb694-2"></a><span class="co">#count frequencies of Scinetific names</span></span>
<span id="cb694-3"><a href="exercise-solutions.html#cb694-3"></a>combined_split_table &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">table</span>(combined_split[,<span class="dv">1</span>]))</span>
<span id="cb694-4"><a href="exercise-solutions.html#cb694-4"></a><span class="co">#where is the count above 1?</span></span>
<span id="cb694-5"><a href="exercise-solutions.html#cb694-5"></a>combined_split_table[combined_split_table<span class="op">$</span>Freq <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>, ]</span></code></pre></div>
<pre><code>##                       Var1 Freq
## 25           Asio flammeus    2
## 85       Clangula hyemalis    2
## 225      Pterodroma ultima    2
## 292    Tachycineta bicolor    2
## 305 Tyrannus melancholicus    2</code></pre>
<p>And which are tehse as Common Name?</p>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="exercise-solutions.html#cb696-1"></a>species_sel &lt;-<span class="st"> </span>combined_split_table[combined_split_table<span class="op">$</span>Freq <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>, ]<span class="op">$</span>Var1</span>
<span id="cb696-2"><a href="exercise-solutions.html#cb696-2"></a>species_sel</span></code></pre></div>
<pre><code>## [1] Asio flammeus          Clangula hyemalis      Pterodroma ultima     
## [4] Tachycineta bicolor    Tyrannus melancholicus
## 325 Levels: Accipiter gentilis Accipiter striatus ... Zonotrichia querula</code></pre>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="exercise-solutions.html#cb698-1"></a>combined_split[combined_split<span class="op">$</span>V1 <span class="op">%in%</span><span class="st"> </span>species_sel, ]</span></code></pre></div>
<pre><code>##                         V1                 V2
## 27       Clangula hyemalis   Long-tailed Duck
## 28       Clangula hyemalis   long-tailed duck
## 45       Pterodroma ultima    Murphy&#39;s Petrel
## 46       Pterodroma ultima          Mute Swan
## 160          Asio flammeus    Short-eared Owl
## 161          Asio flammeus    short-eared owl
## 201 Tyrannus melancholicus  Tropical Kingbird
## 202 Tyrannus melancholicus  tropical kingbird
## 220    Tachycineta bicolor Clark&#39;s Nutcracker
## 223    Tachycineta bicolor       Tree Swallow</code></pre>
<p>Ahhh simple typos, for 3 out of 5, and data entering errors: The cause of so many data analysis problems. Scientific name <em>Pterodroma ultima</em> is certainly not that of the Mute Swan: a data entering error, and the same counts for <em>Tachycineta bicolor</em>: it is the name of the Tree Swallow.</p>
<p><strong>J</strong></p>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="exercise-solutions.html#cb700-1"></a><span class="co">#these are the values that need to be rescued:</span></span>
<span id="cb700-2"><a href="exercise-solutions.html#cb700-2"></a><span class="kw">table</span>(bird_obs[<span class="kw">is.na</span>(bird_obs<span class="op">$</span>Count), <span class="st">&quot;Number&quot;</span>])</span>
<span id="cb700-3"><a href="exercise-solutions.html#cb700-3"></a><span class="co">#I suggest you take the lowest of the range-like values: </span></span>
<span id="cb700-4"><a href="exercise-solutions.html#cb700-4"></a><span class="co">#1-3 becomes 1; 2-3 becomes 2; 100s becomes 100 etc</span></span>
<span id="cb700-5"><a href="exercise-solutions.html#cb700-5"></a><span class="co">#then do something like</span></span>
<span id="cb700-6"><a href="exercise-solutions.html#cb700-6"></a>tmp &lt;-<span class="st"> </span>bird_obs<span class="op">$</span>Number[<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>]</span>
<span id="cb700-7"><a href="exercise-solutions.html#cb700-7"></a>tmp</span>
<span id="cb700-8"><a href="exercise-solutions.html#cb700-8"></a><span class="kw">gsub</span>(<span class="st">&quot;(</span><span class="ch">\\</span><span class="st">d+)-(</span><span class="ch">\\</span><span class="st">d+)&quot;</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">1&quot;</span>, tmp)</span></code></pre></div>
</div>
</div>
<div id="functions-3" class="section level2">
<h2><span class="header-section-number">11.5</span> Functions</h2>
<div id="the-cut-function-i-1" class="section level3">
<h3><span class="header-section-number">11.5.1</span> The <code>cut()</code> function I</h3>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="exercise-solutions.html#cb701-1"></a>fold_change &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.10</span>, <span class="fl">8.50</span>, <span class="fl">0.95</span>, <span class="fl">56.08</span>, <span class="fl">0.90</span>, <span class="fl">99.15</span>, <span class="fl">1.00</span>, <span class="fl">0.01</span>, <span class="fl">0.65</span>, <span class="fl">1.10</span>, <span class="fl">2.34</span>, <span class="fl">62.2</span>)</span></code></pre></div>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="exercise-solutions.html#cb702-1"></a>induc_type &lt;-<span class="st"> </span><span class="kw">cut</span>(fold_change, </span>
<span id="cb702-2"><a href="exercise-solutions.html#cb702-2"></a>                  <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>, <span class="ot">Inf</span>), </span>
<span id="cb702-3"><a href="exercise-solutions.html#cb702-3"></a>                  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;repression&quot;</span>, <span class="st">&quot;no_change&quot;</span>, <span class="st">&quot;induction&quot;</span>), </span>
<span id="cb702-4"><a href="exercise-solutions.html#cb702-4"></a>                  <span class="dt">right =</span> <span class="ot">FALSE</span>,</span>
<span id="cb702-5"><a href="exercise-solutions.html#cb702-5"></a>                  <span class="dt">ordered_result =</span> T)</span>
<span id="cb702-6"><a href="exercise-solutions.html#cb702-6"></a>induc_type</span></code></pre></div>
<pre><code>##  [1] repression induction  no_change  induction  no_change  induction 
##  [7] no_change  repression repression induction  induction  induction 
## Levels: repression &lt; no_change &lt; induction</code></pre>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="exercise-solutions.html#cb704-1"></a>induction &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">fold_induction =</span> fold_change, </span>
<span id="cb704-2"><a href="exercise-solutions.html#cb704-2"></a>                        <span class="dt">induction_type =</span> induc_type)</span></code></pre></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="exercise-solutions.html#cb705-1"></a><span class="kw">plot</span>(induction<span class="op">$</span>induction_type,</span>
<span id="cb705-2"><a href="exercise-solutions.html#cb705-2"></a>     <span class="dt">main =</span> <span class="st">&quot;Gene expression after dihydrotestosterone treatment.&quot;</span>,</span>
<span id="cb705-3"><a href="exercise-solutions.html#cb705-3"></a>     <span class="dt">ylab =</span> <span class="st">&quot;Number of genes&quot;</span>,</span>
<span id="cb705-4"><a href="exercise-solutions.html#cb705-4"></a>     <span class="dt">names =</span> <span class="kw">c</span>(<span class="st">&quot;repressed&quot;</span>, <span class="st">&quot;no change&quot;</span>, <span class="st">&quot;induced&quot;</span>),</span>
<span id="cb705-5"><a href="exercise-solutions.html#cb705-5"></a>     <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/unnamed-chunk-131-1.png" width="672" /></p>
</div>
<div id="the-cut-function-ii-1" class="section level3">
<h3><span class="header-section-number">11.5.2</span> The <code>cut()</code> function II</h3>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="exercise-solutions.html#cb706-1"></a>remote_location &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/MichielNoback/davur1_gitbook/master/data/gene_expression_data.txt&quot;</span></span>
<span id="cb706-2"><a href="exercise-solutions.html#cb706-2"></a><span class="kw">read.table</span>(remote_location,  )</span></code></pre></div>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="exercise-solutions.html#cb707-1"></a>gene_array &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb707-2"><a href="exercise-solutions.html#cb707-2"></a>    remote_location,</span>
<span id="cb707-3"><a href="exercise-solutions.html#cb707-3"></a>    <span class="dt">header =</span> T,</span>
<span id="cb707-4"><a href="exercise-solutions.html#cb707-4"></a>    <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>,</span>
<span id="cb707-5"><a href="exercise-solutions.html#cb707-5"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb707-6"><a href="exercise-solutions.html#cb707-6"></a>    <span class="dt">na.strings =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb707-7"><a href="exercise-solutions.html#cb707-7"></a>    <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="exercise-solutions.html#cb708-1"></a>induction_repression &lt;-<span class="st"> </span><span class="kw">cut</span>(gene_array<span class="op">$</span>fold_change,</span>
<span id="cb708-2"><a href="exercise-solutions.html#cb708-2"></a>  <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">9</span>, <span class="fl">1.1</span>,  <span class="ot">Inf</span>), </span>
<span id="cb708-3"><a href="exercise-solutions.html#cb708-3"></a>  <span class="dt">right =</span> F,</span>
<span id="cb708-4"><a href="exercise-solutions.html#cb708-4"></a>  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;repression&quot;</span>, <span class="st">&quot;no_change&quot;</span>, <span class="st">&quot;induction&quot;</span>),</span>
<span id="cb708-5"><a href="exercise-solutions.html#cb708-5"></a>  <span class="dt">ordered_result =</span> T)</span>
<span id="cb708-6"><a href="exercise-solutions.html#cb708-6"></a>gene_array<span class="op">$</span>induction_repression &lt;-induction_repression</span></code></pre></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="exercise-solutions.html#cb709-1"></a><span class="kw">plot</span>(gene_array<span class="op">$</span>induction_repression,</span>
<span id="cb709-2"><a href="exercise-solutions.html#cb709-2"></a>     <span class="dt">main =</span> <span class="st">&quot;Gene expression after dihydrotestosterone treatment&quot;</span>,</span>
<span id="cb709-3"><a href="exercise-solutions.html#cb709-3"></a>     <span class="dt">ylab =</span> <span class="st">&quot;number of genes&quot;</span>,</span>
<span id="cb709-4"><a href="exercise-solutions.html#cb709-4"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">600</span>),</span>
<span id="cb709-5"><a href="exercise-solutions.html#cb709-5"></a>     <span class="dt">names =</span> <span class="kw">c</span>(<span class="st">&quot;repressed&quot;</span>, <span class="st">&quot;no change&quot;</span>, <span class="st">&quot;induced&quot;</span>),</span>
<span id="cb709-6"><a href="exercise-solutions.html#cb709-6"></a>     <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="regular-expressions-1" class="section level2">
<h2><span class="header-section-number">11.6</span> Regular Expressions</h2>
<div id="restriction-enzymes-2" class="section level3">
<h3><span class="header-section-number">11.6.1</span> Restriction enzymes</h3>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="exercise-solutions.html#cb710-1"></a>pacI_re &lt;-<span class="st"> &quot;TTAATTAA&quot;</span></span>
<span id="cb710-2"><a href="exercise-solutions.html#cb710-2"></a>patterns &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;T{2}A{2}T{2}A{2}&quot;</span>,</span>
<span id="cb710-3"><a href="exercise-solutions.html#cb710-3"></a>           <span class="st">&quot;(TTAA){2}&quot;</span>, </span>
<span id="cb710-4"><a href="exercise-solutions.html#cb710-4"></a>           <span class="st">&quot;(T{2}A{2}){2}&quot;</span>)</span>
<span id="cb710-5"><a href="exercise-solutions.html#cb710-5"></a><span class="cf">for</span>(ptrn <span class="cf">in</span> patterns){</span>
<span id="cb710-6"><a href="exercise-solutions.html#cb710-6"></a>    <span class="kw">print</span>(<span class="kw">grepl</span>(ptrn, pacI_re))</span>
<span id="cb710-7"><a href="exercise-solutions.html#cb710-7"></a>}</span></code></pre></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="exercise-solutions.html#cb711-1"></a>sfiI_re &lt;-<span class="st"> &quot;GGCCACGTAGGCC&quot;</span></span>
<span id="cb711-2"><a href="exercise-solutions.html#cb711-2"></a>patterns &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;G{2}C{2}[GATC]{5}G{2}C{2}&quot;</span>,</span>
<span id="cb711-3"><a href="exercise-solutions.html#cb711-3"></a>           <span class="st">&quot;GGCC[GATC]{5}GGCC&quot;</span>, </span>
<span id="cb711-4"><a href="exercise-solutions.html#cb711-4"></a>           <span class="st">&quot;[GC]{4}[GATC]{5}[GC]{4}&quot;</span>) <span class="co">#last one is less specific!</span></span>
<span id="cb711-5"><a href="exercise-solutions.html#cb711-5"></a><span class="cf">for</span>(ptrn <span class="cf">in</span> patterns){</span>
<span id="cb711-6"><a href="exercise-solutions.html#cb711-6"></a>    <span class="kw">print</span>(<span class="kw">grepl</span>(ptrn, sfiI_re))</span>
<span id="cb711-7"><a href="exercise-solutions.html#cb711-7"></a>}</span></code></pre></div>
</div>
<div id="prosite-patterns-2" class="section level3">
<h3><span class="header-section-number">11.6.2</span> Prosite Patterns</h3>
<p><strong>A</strong><br />
PS00211:<br />
“[LIVMFYC]-[SA]-[SAPGLVFYKQH]-G-[DENQMW]-[KRQASPCLIMFW]-[KRNQSTAVM]-[KRACLVM]-[LIVMFYPAN]-{PHY}-[LIVMFW]-[SAGCLIVP]-{FYWHP}-{KRHP}-[LIVMFYWSTA].”</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="exercise-solutions.html#cb712-1"></a>PS00211&lt;-<span class="st"> &quot;[LIVMFYC][SA][SAPGLVFYKQH]G[DENQMW][KRQASPCLIMFW][KRNQSTAVM][KRACLVM][LIVMFYPAN][^PHY][LIVMFW][SAGCLIVP][^FYWHP][^KRHP][LIVMFYWSTA]&quot;</span></span></code></pre></div>
<p><strong>B</strong><br />
PS00018:
“D-{W}-[DNS]-{ILVFYW}-[DENSTG]-[DNQGHRK]-{GP}-[LIVMC]-[DENQSTAGC]-x(2)- [DE]-[LIVMFYW].”</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="exercise-solutions.html#cb713-1"></a>PS00018 &lt;-<span class="st"> &quot;D[^W][DNS][^ILVFYW][DENSTG][DNQGHRK][^GP][LIVMC][DENQSTAGC].{2} [DE][LIVMFYW]&quot;</span></span></code></pre></div>
</div>
<div id="fasta-headers-1" class="section level3">
<h3><span class="header-section-number">11.6.3</span> Fasta Headers</h3>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="exercise-solutions.html#cb714-1"></a><span class="kw">library</span>(stringr)</span>
<span id="cb714-2"><a href="exercise-solutions.html#cb714-2"></a>fasta_headers &lt;-<span class="st"> </span><span class="kw">readLines</span>(<span class="st">&quot;./data/fasta_headers.txt&quot;</span>)</span></code></pre></div>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="exercise-solutions.html#cb715-1"></a><span class="kw">str_match</span>(fasta_headers, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">[(.+)</span><span class="ch">\\</span><span class="st">]&quot;</span>)[, <span class="dv">2</span>]</span>
<span id="cb715-2"><a href="exercise-solutions.html#cb715-2"></a><span class="kw">str_match</span>(fasta_headers, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">[([[:alpha:]]+ [[:alpha:]]+) ?(.+)?</span><span class="ch">\\</span><span class="st">]&quot;</span>)[, <span class="dv">2</span>]</span></code></pre></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="exercise-solutions.html#cb716-1"></a><span class="kw">str_match</span>(fasta_headers, <span class="st">&quot;&gt;([[:alpha:]]{2,3}</span><span class="ch">\\</span><span class="st">|</span><span class="ch">\\</span><span class="st">w+)</span><span class="ch">\\</span><span class="st">|&quot;</span>)[, <span class="dv">2</span>]</span></code></pre></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="exercise-solutions.html#cb717-1"></a><span class="kw">str_match</span>(fasta_headers, <span class="st">&quot;&gt;.+</span><span class="ch">\\</span><span class="st">| (.+?) </span><span class="ch">\\</span><span class="st">[&quot;</span>)[, <span class="dv">2</span>]</span></code></pre></div>
</div>
</div>
<div id="scripting-3" class="section level2">
<h2><span class="header-section-number">11.7</span> Scripting</h2>
<div id="illegal-reproductions-1" class="section level3">
<h3><span class="header-section-number">11.7.1</span> Illegal reproductions</h3>
<div id="the-mean-1" class="section level4 unnumbered">
<h4>The mean</h4>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="exercise-solutions.html#cb718-1"></a>my_mean &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb718-2"><a href="exercise-solutions.html#cb718-2"></a>        <span class="kw">sum</span>(x, <span class="dt">na.rm =</span> T) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb718-3"><a href="exercise-solutions.html#cb718-3"></a>}</span></code></pre></div>
</div>
<div id="standard-deviation-1" class="section level4 unnumbered">
<h4>Standard deviation</h4>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="exercise-solutions.html#cb719-1"></a>my_sd &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb719-2"><a href="exercise-solutions.html#cb719-2"></a>        <span class="kw">sqrt</span>(<span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb719-3"><a href="exercise-solutions.html#cb719-3"></a>}</span></code></pre></div>
</div>
<div id="maximum-1" class="section level4 unnumbered">
<h4>Maximum</h4>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="exercise-solutions.html#cb720-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb720-2"><a href="exercise-solutions.html#cb720-2"></a>my_nums &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">10000</span>, <span class="dv">1000</span>)</span>
<span id="cb720-3"><a href="exercise-solutions.html#cb720-3"></a>my_max &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb720-4"><a href="exercise-solutions.html#cb720-4"></a>    max_val &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb720-5"><a href="exercise-solutions.html#cb720-5"></a>    <span class="cf">for</span> (i <span class="cf">in</span> my_nums) {</span>
<span id="cb720-6"><a href="exercise-solutions.html#cb720-6"></a>        <span class="cf">if</span> (i <span class="op">&gt;</span><span class="st"> </span>max_val) {</span>
<span id="cb720-7"><a href="exercise-solutions.html#cb720-7"></a>            max_val =<span class="st"> </span>i</span>
<span id="cb720-8"><a href="exercise-solutions.html#cb720-8"></a>        }</span>
<span id="cb720-9"><a href="exercise-solutions.html#cb720-9"></a>    }</span>
<span id="cb720-10"><a href="exercise-solutions.html#cb720-10"></a>    <span class="kw">return</span>(max_val)</span>
<span id="cb720-11"><a href="exercise-solutions.html#cb720-11"></a>}</span></code></pre></div>
</div>
</div>
<div id="find-match-locations-1" class="section level3 unnumbered">
<h3>Find match locations</h3>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="exercise-solutions.html#cb721-1"></a>where_is_it &lt;-<span class="st"> </span><span class="cf">function</span>(x, look_for) {</span>
<span id="cb721-2"><a href="exercise-solutions.html#cb721-2"></a>    found &lt;-<span class="st"> </span><span class="kw">integer</span>(<span class="dv">0</span>)</span>
<span id="cb721-3"><a href="exercise-solutions.html#cb721-3"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)) {</span>
<span id="cb721-4"><a href="exercise-solutions.html#cb721-4"></a>        elmnt &lt;-<span class="st"> </span>x[i]</span>
<span id="cb721-5"><a href="exercise-solutions.html#cb721-5"></a>        <span class="cf">if</span> (elmnt <span class="op">==</span><span class="st"> </span>look_for) {</span>
<span id="cb721-6"><a href="exercise-solutions.html#cb721-6"></a>            found &lt;-<span class="st"> </span><span class="kw">c</span>(found, i)</span>
<span id="cb721-7"><a href="exercise-solutions.html#cb721-7"></a>        }</span>
<span id="cb721-8"><a href="exercise-solutions.html#cb721-8"></a>    }</span>
<span id="cb721-9"><a href="exercise-solutions.html#cb721-9"></a>    <span class="kw">return</span>(found)</span>
<span id="cb721-10"><a href="exercise-solutions.html#cb721-10"></a>}</span>
<span id="cb721-11"><a href="exercise-solutions.html#cb721-11"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Pro&quot;</span>, <span class="st">&quot;Glu&quot;</span>, <span class="st">&quot;Lys&quot;</span>, <span class="st">&quot;Pro&quot;</span>, <span class="st">&quot;Ser&quot;</span>)</span>
<span id="cb721-12"><a href="exercise-solutions.html#cb721-12"></a><span class="kw">where_is_it</span>(x, <span class="st">&quot;Pro&quot;</span>)</span>
<span id="cb721-13"><a href="exercise-solutions.html#cb721-13"></a><span class="co">##expected:</span></span>
<span id="cb721-14"><a href="exercise-solutions.html#cb721-14"></a><span class="co">#[1] 1 4</span></span></code></pre></div>
<div id="median-1" class="section level4 unnumbered">
<h4>Median</h4>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="exercise-solutions.html#cb722-1"></a>my_median &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb722-2"><a href="exercise-solutions.html#cb722-2"></a>        sorted &lt;-<span class="st"> </span><span class="kw">sort</span>(x)</span>
<span id="cb722-3"><a href="exercise-solutions.html#cb722-3"></a>        <span class="cf">if</span>(<span class="kw">length</span>(x) <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb722-4"><a href="exercise-solutions.html#cb722-4"></a>                <span class="co">#uneven length</span></span>
<span id="cb722-5"><a href="exercise-solutions.html#cb722-5"></a>                my_median &lt;-<span class="st"> </span>sorted[<span class="kw">ceiling</span>(<span class="kw">length</span>(x)<span class="op">/</span><span class="dv">2</span>)]</span>
<span id="cb722-6"><a href="exercise-solutions.html#cb722-6"></a>        } <span class="cf">else</span> {</span>
<span id="cb722-7"><a href="exercise-solutions.html#cb722-7"></a>                my_median &lt;-<span class="st"> </span>(sorted[<span class="kw">length</span>(x)<span class="op">/</span><span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>sorted[(<span class="kw">length</span>(x)<span class="op">/</span><span class="dv">2</span>)<span class="op">+</span><span class="dv">1</span>]) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb722-8"><a href="exercise-solutions.html#cb722-8"></a>        }</span>
<span id="cb722-9"><a href="exercise-solutions.html#cb722-9"></a>        <span class="kw">return</span>(my_median)</span>
<span id="cb722-10"><a href="exercise-solutions.html#cb722-10"></a>}</span></code></pre></div>
</div>
</div>
<div id="count-odd-and-even-numbers-1" class="section level3">
<h3><span class="header-section-number">11.7.2</span> Count odd and even numbers</h3>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="exercise-solutions.html#cb723-1"></a>count_odd_even &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb723-2"><a href="exercise-solutions.html#cb723-2"></a>    evens &lt;-<span class="st"> </span><span class="kw">sum</span>(x <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb723-3"><a href="exercise-solutions.html#cb723-3"></a>    odds &lt;-<span class="st"> </span><span class="kw">sum</span>(x <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb723-4"><a href="exercise-solutions.html#cb723-4"></a>    <span class="co">#OR, more efficient</span></span>
<span id="cb723-5"><a href="exercise-solutions.html#cb723-5"></a>    <span class="co">#odds &lt;- length(x) - evens</span></span>
<span id="cb723-6"><a href="exercise-solutions.html#cb723-6"></a>    tmp &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">even =</span> evens, <span class="dt">odd =</span> odds)</span>
<span id="cb723-7"><a href="exercise-solutions.html#cb723-7"></a>    <span class="kw">return</span>(tmp)</span>
<span id="cb723-8"><a href="exercise-solutions.html#cb723-8"></a>}</span>
<span id="cb723-9"><a href="exercise-solutions.html#cb723-9"></a><span class="kw">count_odd_even</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>))</span></code></pre></div>
</div>
<div id="add-column-compared-to-mean-1" class="section level3">
<h3><span class="header-section-number">11.7.3</span> Add column compared to mean</h3>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="exercise-solutions.html#cb724-1"></a>add_compared_to_mean &lt;-<span class="st"> </span><span class="cf">function</span> (df, name) {</span>
<span id="cb724-2"><a href="exercise-solutions.html#cb724-2"></a>    <span class="cf">if</span> (<span class="op">!</span><span class="st"> </span><span class="kw">is.data.frame</span>(df)) {</span>
<span id="cb724-3"><a href="exercise-solutions.html#cb724-3"></a>        <span class="kw">stop</span>(<span class="kw">paste0</span>(<span class="st">&quot;&#39;&quot;</span>, df, <span class="st">&quot;&#39; is not a dataframe.&quot;</span>))</span>
<span id="cb724-4"><a href="exercise-solutions.html#cb724-4"></a>    }</span>
<span id="cb724-5"><a href="exercise-solutions.html#cb724-5"></a>    <span class="cf">if</span>(<span class="op">!</span><span class="st"> </span>name <span class="op">%in%</span><span class="st"> </span><span class="kw">colnames</span>(df)) {</span>
<span id="cb724-6"><a href="exercise-solutions.html#cb724-6"></a>        <span class="kw">stop</span>(<span class="kw">paste0</span>(<span class="st">&quot;&#39;&quot;</span>, name, <span class="st">&quot;&#39; is not an existing column.&quot;</span>))</span>
<span id="cb724-7"><a href="exercise-solutions.html#cb724-7"></a>    }</span>
<span id="cb724-8"><a href="exercise-solutions.html#cb724-8"></a>    <span class="cf">if</span>(<span class="op">!</span><span class="st"> </span><span class="kw">is.numeric</span>(df[, name])) {</span>
<span id="cb724-9"><a href="exercise-solutions.html#cb724-9"></a>        <span class="kw">stop</span>(<span class="kw">paste0</span>(<span class="st">&quot;&#39;&quot;</span>, name, <span class="st">&quot; is not a numeric column.&quot;</span>))</span>
<span id="cb724-10"><a href="exercise-solutions.html#cb724-10"></a>    }</span>
<span id="cb724-11"><a href="exercise-solutions.html#cb724-11"></a>    the_col &lt;-<span class="st"> </span>df[, name]</span>
<span id="cb724-12"><a href="exercise-solutions.html#cb724-12"></a>    tmp &lt;-<span class="st"> </span><span class="kw">ifelse</span>(the_col <span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(the_col), <span class="st">&quot;greater&quot;</span>, <span class="st">&quot;less&quot;</span>)</span>
<span id="cb724-13"><a href="exercise-solutions.html#cb724-13"></a>    df<span class="op">$</span>compared_to_mean &lt;-<span class="st"> </span>tmp</span>
<span id="cb724-14"><a href="exercise-solutions.html#cb724-14"></a>    <span class="kw">return</span>(df)</span>
<span id="cb724-15"><a href="exercise-solutions.html#cb724-15"></a>}</span>
<span id="cb724-16"><a href="exercise-solutions.html#cb724-16"></a>my_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">a =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">5</span>), <span class="dt">b =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>), <span class="dv">4</span>))</span>
<span id="cb724-17"><a href="exercise-solutions.html#cb724-17"></a><span class="kw">add_compared_to_mean</span>(my_df, <span class="st">&quot;a&quot;</span>)</span></code></pre></div>
</div>
<div id="interquantile-ranges-1" class="section level3">
<h3><span class="header-section-number">11.7.4</span> Interquantile ranges</h3>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="exercise-solutions.html#cb725-1"></a>interquantile_range &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">1</span>) {</span>
<span id="cb725-2"><a href="exercise-solutions.html#cb725-2"></a>  <span class="cf">if</span> (<span class="op">!</span><span class="st"> </span><span class="kw">is.numeric</span>(x) <span class="op">|</span><span class="st"> </span></span>
<span id="cb725-3"><a href="exercise-solutions.html#cb725-3"></a><span class="st">      </span><span class="op">!</span><span class="st"> </span><span class="kw">is.numeric</span>(lower) <span class="op">|</span></span>
<span id="cb725-4"><a href="exercise-solutions.html#cb725-4"></a><span class="st">      </span><span class="op">!</span><span class="st"> </span><span class="kw">is.numeric</span>(upper)) {</span>
<span id="cb725-5"><a href="exercise-solutions.html#cb725-5"></a>    <span class="kw">stop</span>(<span class="st">&quot;all three arguments should be numeric&quot;</span>)</span>
<span id="cb725-6"><a href="exercise-solutions.html#cb725-6"></a>  }</span>
<span id="cb725-7"><a href="exercise-solutions.html#cb725-7"></a>  lower_val &lt;-<span class="st"> </span><span class="kw">quantile</span>(x, <span class="dt">probs =</span> lower)</span>
<span id="cb725-8"><a href="exercise-solutions.html#cb725-8"></a>  upper_val &lt;-<span class="st"> </span><span class="kw">quantile</span>(x, <span class="dt">probs =</span> upper)</span>
<span id="cb725-9"><a href="exercise-solutions.html#cb725-9"></a>  tmp &lt;-<span class="st"> </span>upper_val <span class="op">-</span><span class="st"> </span>lower_val</span>
<span id="cb725-10"><a href="exercise-solutions.html#cb725-10"></a>  <span class="co">#a named vector is always nice, for acces but also for display purposes</span></span>
<span id="cb725-11"><a href="exercise-solutions.html#cb725-11"></a>  <span class="kw">names</span>(tmp) &lt;-<span class="st"> </span><span class="kw">paste0</span>(lower<span class="op">*</span><span class="dv">100</span>, <span class="st">&quot;-&quot;</span>, upper<span class="op">*</span><span class="dv">100</span>, <span class="st">&quot;%&quot;</span>)</span>
<span id="cb725-12"><a href="exercise-solutions.html#cb725-12"></a>  tmp</span>
<span id="cb725-13"><a href="exercise-solutions.html#cb725-13"></a>}</span>
<span id="cb725-14"><a href="exercise-solutions.html#cb725-14"></a>tst &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb725-15"><a href="exercise-solutions.html#cb725-15"></a><span class="kw">interquantile_range</span>(tst) <span class="co"># 0 to 1</span></span>
<span id="cb725-16"><a href="exercise-solutions.html#cb725-16"></a><span class="kw">interquantile_range</span>(tst, <span class="fl">0.25</span>, <span class="fl">0.75</span>) <span class="co"># custom</span></span>
<span id="cb725-17"><a href="exercise-solutions.html#cb725-17"></a><span class="co">#interquantile_range(&quot;foo&quot;) # error!</span></span></code></pre></div>
</div>
<div id="vector-distance-1" class="section level3">
<h3><span class="header-section-number">11.7.5</span> Vector distance</h3>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="exercise-solutions.html#cb726-1"></a>distance &lt;-<span class="st"> </span><span class="cf">function</span>(p, q) {</span>
<span id="cb726-2"><a href="exercise-solutions.html#cb726-2"></a>    <span class="cf">if</span> (<span class="op">!</span><span class="st"> </span><span class="kw">is.numeric</span>(p) <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="st"> </span><span class="kw">is.numeric</span>(q)) {</span>
<span id="cb726-3"><a href="exercise-solutions.html#cb726-3"></a>        <span class="kw">stop</span>(<span class="st">&quot;non-numeric vectors passed&quot;</span>)</span>
<span id="cb726-4"><a href="exercise-solutions.html#cb726-4"></a>    }</span>
<span id="cb726-5"><a href="exercise-solutions.html#cb726-5"></a>    <span class="cf">if</span> (<span class="kw">length</span>(p) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(q)) {</span>
<span id="cb726-6"><a href="exercise-solutions.html#cb726-6"></a>        <span class="kw">stop</span>(<span class="st">&quot;vectors have unequal length&quot;</span>)</span>
<span id="cb726-7"><a href="exercise-solutions.html#cb726-7"></a>    }</span>
<span id="cb726-8"><a href="exercise-solutions.html#cb726-8"></a>    <span class="kw">sqrt</span>(<span class="kw">sum</span>((p <span class="op">-</span><span class="st"> </span>q)<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb726-9"><a href="exercise-solutions.html#cb726-9"></a>}</span></code></pre></div>
<div id="other-distance-measures-1" class="section level4 unnumbered">
<h4>Other distance measures</h4>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="exercise-solutions.html#cb727-1"></a>my_distance &lt;-<span class="st"> </span><span class="cf">function</span>(p, q, <span class="dt">method =</span> <span class="st">&quot;euclidean&quot;</span>) {</span>
<span id="cb727-2"><a href="exercise-solutions.html#cb727-2"></a>  <span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">is.numeric</span>(p) <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.numeric</span>(q))) {</span>
<span id="cb727-3"><a href="exercise-solutions.html#cb727-3"></a>    <span class="kw">stop</span>(<span class="st">&quot;One or both of the vectors is not numeric&quot;</span>)</span>
<span id="cb727-4"><a href="exercise-solutions.html#cb727-4"></a>  }</span>
<span id="cb727-5"><a href="exercise-solutions.html#cb727-5"></a>  <span class="cf">if</span> (<span class="kw">length</span>(p) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(q)) {</span>
<span id="cb727-6"><a href="exercise-solutions.html#cb727-6"></a>    <span class="kw">stop</span>(<span class="st">&quot;Vectors are not of equal length&quot;</span>)</span>
<span id="cb727-7"><a href="exercise-solutions.html#cb727-7"></a>  }</span>
<span id="cb727-8"><a href="exercise-solutions.html#cb727-8"></a>  <span class="cf">if</span> (method <span class="op">==</span><span class="st"> &quot;euclidean&quot;</span>) {</span>
<span id="cb727-9"><a href="exercise-solutions.html#cb727-9"></a>    <span class="kw">return</span>(<span class="kw">sqrt</span>(<span class="kw">sum</span>((p <span class="op">-</span><span class="st"> </span>q)<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb727-10"><a href="exercise-solutions.html#cb727-10"></a>  }</span>
<span id="cb727-11"><a href="exercise-solutions.html#cb727-11"></a>  <span class="cf">else</span> <span class="cf">if</span> (method <span class="op">==</span><span class="st"> &quot;manhattan&quot;</span>) {</span>
<span id="cb727-12"><a href="exercise-solutions.html#cb727-12"></a>    <span class="kw">return</span>(<span class="kw">sum</span>(<span class="kw">abs</span>(p<span class="op">-</span>q)))</span>
<span id="cb727-13"><a href="exercise-solutions.html#cb727-13"></a>  }</span>
<span id="cb727-14"><a href="exercise-solutions.html#cb727-14"></a>  <span class="cf">else</span> {</span>
<span id="cb727-15"><a href="exercise-solutions.html#cb727-15"></a>    <span class="kw">stop</span>(<span class="kw">paste0</span>(<span class="st">&quot;Method not found: &quot;</span>, method))</span>
<span id="cb727-16"><a href="exercise-solutions.html#cb727-16"></a>  }</span>
<span id="cb727-17"><a href="exercise-solutions.html#cb727-17"></a>}</span>
<span id="cb727-18"><a href="exercise-solutions.html#cb727-18"></a><span class="kw">my_distance</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 1.73</code></pre>
</div>
</div>
<div id="quadratic-equation-solver-1" class="section level3">
<h3><span class="header-section-number">11.7.6</span> Quadratic equation solver</h3>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="exercise-solutions.html#cb729-1"></a>abc_solver &lt;-<span class="st"> </span><span class="cf">function</span>(a, b, c) {</span>
<span id="cb729-2"><a href="exercise-solutions.html#cb729-2"></a>    discriminant &lt;-<span class="st"> </span>(b <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">*</span><span class="st"> </span>a <span class="op">*</span><span class="st"> </span>c)</span>
<span id="cb729-3"><a href="exercise-solutions.html#cb729-3"></a>    <span class="cf">if</span> (discriminant <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb729-4"><a href="exercise-solutions.html#cb729-4"></a>        <span class="kw">return</span>(<span class="st">&quot;This quadratic equation can not be solved.&quot;</span>)</span>
<span id="cb729-5"><a href="exercise-solutions.html#cb729-5"></a>    }</span>
<span id="cb729-6"><a href="exercise-solutions.html#cb729-6"></a>    <span class="cf">else</span> <span class="cf">if</span> (discriminant <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb729-7"><a href="exercise-solutions.html#cb729-7"></a>        x1 &lt;-<span class="st"> </span>((<span class="op">-</span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>b) <span class="op">+</span><span class="st"> </span><span class="kw">sqrt</span>(discriminant)) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>a)</span>
<span id="cb729-8"><a href="exercise-solutions.html#cb729-8"></a>        x2 &lt;-<span class="st"> </span>((<span class="op">-</span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>b) <span class="op">-</span><span class="st"> </span><span class="kw">sqrt</span>(discriminant)) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>a)</span>
<span id="cb729-9"><a href="exercise-solutions.html#cb729-9"></a>        <span class="kw">return</span>(<span class="kw">c</span>(x1, x2))</span>
<span id="cb729-10"><a href="exercise-solutions.html#cb729-10"></a>    }</span>
<span id="cb729-11"><a href="exercise-solutions.html#cb729-11"></a>    <span class="cf">else</span>{</span>
<span id="cb729-12"><a href="exercise-solutions.html#cb729-12"></a>        x &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>b) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>a)</span>
<span id="cb729-13"><a href="exercise-solutions.html#cb729-13"></a>        <span class="kw">return</span>(x)</span>
<span id="cb729-14"><a href="exercise-solutions.html#cb729-14"></a>    }</span>
<span id="cb729-15"><a href="exercise-solutions.html#cb729-15"></a>}</span>
<span id="cb729-16"><a href="exercise-solutions.html#cb729-16"></a><span class="kw">abc_solver</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">2</span>, <span class="dt">c =</span> <span class="dv">3</span>)</span>
<span id="cb729-17"><a href="exercise-solutions.html#cb729-17"></a><span class="kw">abc_solver</span>(<span class="dt">a =</span> <span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">7</span>, <span class="dt">c =</span> <span class="dv">4</span>)</span>
<span id="cb729-18"><a href="exercise-solutions.html#cb729-18"></a><span class="kw">abc_solver</span>(<span class="dt">a =</span> <span class="dv">2</span>, <span class="dt">b =</span> <span class="dv">4</span>, <span class="dt">c =</span> <span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="gc-percentage-of-dna-1" class="section level3">
<h3><span class="header-section-number">11.7.7</span> G/C percentage of DNA</h3>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="exercise-solutions.html#cb730-1"></a>GC_perc &lt;-<span class="st"> </span><span class="cf">function</span>(seq, <span class="dt">strict =</span> <span class="ot">TRUE</span>) {</span>
<span id="cb730-2"><a href="exercise-solutions.html#cb730-2"></a>        <span class="cf">if</span> (<span class="kw">is.na</span>(seq)) {</span>
<span id="cb730-3"><a href="exercise-solutions.html#cb730-3"></a>                <span class="kw">return</span>(<span class="ot">NA</span>)</span>
<span id="cb730-4"><a href="exercise-solutions.html#cb730-4"></a>        }</span>
<span id="cb730-5"><a href="exercise-solutions.html#cb730-5"></a>        <span class="cf">if</span> (<span class="kw">length</span>(seq) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb730-6"><a href="exercise-solutions.html#cb730-6"></a>                <span class="kw">return</span>(<span class="dv">0</span>)</span>
<span id="cb730-7"><a href="exercise-solutions.html#cb730-7"></a>        }</span>
<span id="cb730-8"><a href="exercise-solutions.html#cb730-8"></a>        seq.split &lt;-<span class="st"> </span><span class="kw">strsplit</span>(seq, <span class="st">&quot;&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb730-9"><a href="exercise-solutions.html#cb730-9"></a>        gc.count &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb730-10"><a href="exercise-solutions.html#cb730-10"></a>        anom.count &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb730-11"><a href="exercise-solutions.html#cb730-11"></a>        <span class="cf">for</span> (n <span class="cf">in</span> seq.split) {</span>
<span id="cb730-12"><a href="exercise-solutions.html#cb730-12"></a>                <span class="cf">if</span> (<span class="kw">length</span>(<span class="kw">grep</span>(<span class="st">&quot;[GATUCgatuc]&quot;</span>, n)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb730-13"><a href="exercise-solutions.html#cb730-13"></a>                        <span class="cf">if</span> (n <span class="op">==</span><span class="st"> &quot;G&quot;</span> <span class="op">||</span><span class="st"> </span>n <span class="op">==</span><span class="st"> &quot;C&quot;</span>) {</span>
<span id="cb730-14"><a href="exercise-solutions.html#cb730-14"></a>                                gc.count &lt;-<span class="st"> </span>gc.count <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb730-15"><a href="exercise-solutions.html#cb730-15"></a>                        }</span>
<span id="cb730-16"><a href="exercise-solutions.html#cb730-16"></a>                } <span class="cf">else</span> {</span>
<span id="cb730-17"><a href="exercise-solutions.html#cb730-17"></a>                        <span class="cf">if</span> (strict) {</span>
<span id="cb730-18"><a href="exercise-solutions.html#cb730-18"></a>                                <span class="kw">stop</span>(<span class="kw">paste</span>(<span class="st">&quot;Illegal character&quot;</span>, n))</span>
<span id="cb730-19"><a href="exercise-solutions.html#cb730-19"></a>                        } <span class="cf">else</span> {</span>
<span id="cb730-20"><a href="exercise-solutions.html#cb730-20"></a>                                anom.count &lt;-<span class="st"> </span>anom.count <span class="op">+</span><span class="st"> </span><span class="dv">1</span>     </span>
<span id="cb730-21"><a href="exercise-solutions.html#cb730-21"></a>                        }</span>
<span id="cb730-22"><a href="exercise-solutions.html#cb730-22"></a>                }</span>
<span id="cb730-23"><a href="exercise-solutions.html#cb730-23"></a>        }</span>
<span id="cb730-24"><a href="exercise-solutions.html#cb730-24"></a>        <span class="co">##return perc</span></span>
<span id="cb730-25"><a href="exercise-solutions.html#cb730-25"></a>        <span class="co">##print(gc.count)</span></span>
<span id="cb730-26"><a href="exercise-solutions.html#cb730-26"></a>        <span class="cf">if</span> (anom.count <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb730-27"><a href="exercise-solutions.html#cb730-27"></a>                anom.perc &lt;-<span class="st"> </span>anom.count <span class="op">/</span><span class="st"> </span><span class="kw">nchar</span>(seq) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></span>
<span id="cb730-28"><a href="exercise-solutions.html#cb730-28"></a>                <span class="kw">warning</span>(<span class="kw">paste</span>(<span class="st">&quot;Non-DNA characters have percentage of&quot;</span>, anom.perc))</span>
<span id="cb730-29"><a href="exercise-solutions.html#cb730-29"></a>        }</span>
<span id="cb730-30"><a href="exercise-solutions.html#cb730-30"></a>        <span class="kw">return</span>(gc.count <span class="op">/</span><span class="st"> </span><span class="kw">nchar</span>(seq) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</span>
<span id="cb730-31"><a href="exercise-solutions.html#cb730-31"></a>}</span></code></pre></div>
</div>
</div>
<div id="function-apply-and-its-relatives-1" class="section level2">
<h2><span class="header-section-number">11.8</span> Function <code>apply</code> and its relatives</h2>
<div id="whale-selenium-1" class="section level3">
<h3><span class="header-section-number">11.8.1</span> Whale selenium</h3>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="exercise-solutions.html#cb731-1"></a>whale_sel_url &lt;-<span class="st"> &quot;https://raw.githubusercontent.com/MichielNoback/davur1/gh-pages/exercises/data/whale_selenium.txt&quot;</span></span>
<span id="cb731-2"><a href="exercise-solutions.html#cb731-2"></a>whale_selenium &lt;-<span class="st"> </span><span class="kw">read.table</span>(whale_sel_url,</span>
<span id="cb731-3"><a href="exercise-solutions.html#cb731-3"></a>        <span class="dt">header =</span> T,</span>
<span id="cb731-4"><a href="exercise-solutions.html#cb731-4"></a>        <span class="dt">row.names =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="exercise-solutions.html#cb732-1"></a><span class="kw">apply</span>(<span class="dt">X =</span> whale_selenium, <span class="dt">MARGIN =</span> <span class="dv">2</span>, <span class="dt">FUN =</span> mean)</span></code></pre></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="exercise-solutions.html#cb733-1"></a><span class="kw">apply</span>(<span class="dt">X =</span> whale_selenium, <span class="dt">MARGIN =</span> <span class="dv">2</span>, <span class="dt">FUN =</span> sd)</span></code></pre></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="exercise-solutions.html#cb734-1"></a>my.sem &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb734-2"><a href="exercise-solutions.html#cb734-2"></a>        sem &lt;-<span class="st"> </span><span class="kw">sd</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">length</span>(x))</span>
<span id="cb734-3"><a href="exercise-solutions.html#cb734-3"></a>}</span>
<span id="cb734-4"><a href="exercise-solutions.html#cb734-4"></a><span class="kw">apply</span>(<span class="dt">X =</span> whale_selenium, <span class="dt">MARGIN =</span> <span class="dv">2</span>, <span class="dt">FUN =</span> my.sem)</span></code></pre></div>
<p><strong>D</strong></p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="exercise-solutions.html#cb735-1"></a>whale_selenium<span class="op">$</span>ratio &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="dt">X =</span> whale_selenium, </span>
<span id="cb735-2"><a href="exercise-solutions.html#cb735-2"></a>            <span class="dt">MARGIN =</span> <span class="dv">1</span>, </span>
<span id="cb735-3"><a href="exercise-solutions.html#cb735-3"></a>            <span class="dt">FUN =</span> <span class="cf">function</span>(x){</span>
<span id="cb735-4"><a href="exercise-solutions.html#cb735-4"></a>                    x[<span class="dv">2</span>] <span class="op">/</span><span class="st"> </span>x[<span class="dv">1</span>]</span>
<span id="cb735-5"><a href="exercise-solutions.html#cb735-5"></a>            })</span>
<span id="cb735-6"><a href="exercise-solutions.html#cb735-6"></a><span class="kw">hist</span>(whale_selenium<span class="op">$</span>ratio,</span>
<span id="cb735-7"><a href="exercise-solutions.html#cb735-7"></a>         <span class="dt">xlab =</span> <span class="st">&quot;Tooth / Liver Selenium ratio&quot;</span>,</span>
<span id="cb735-8"><a href="exercise-solutions.html#cb735-8"></a>         <span class="dt">main =</span> <span class="st">&quot;Histogram of Tooth / Liver Selenium ratios&quot;</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/whale-selenium-hist-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><strong>E</strong><br />
Inline expressions are like this: 15.4 MpH.</p>
</div>
<div id="chickweight-1" class="section level3">
<h3><span class="header-section-number">11.8.2</span> ChickWeight</h3>
<p>This exercise revolves around the <code>ChickWeight</code> dataset of the built-in <code>datasets</code> package.</p>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="exercise-solutions.html#cb736-1"></a><span class="co">#MANY WAYS TO GET THERE</span></span>
<span id="cb736-2"><a href="exercise-solutions.html#cb736-2"></a><span class="kw">length</span>(<span class="kw">split</span>(ChickWeight, ChickWeight<span class="op">$</span>Chick))</span></code></pre></div>
<pre><code>## [1] 50</code></pre>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="exercise-solutions.html#cb738-1"></a><span class="co">#OR</span></span>
<span id="cb738-2"><a href="exercise-solutions.html#cb738-2"></a><span class="kw">sum</span>(<span class="kw">tapply</span>(ChickWeight<span class="op">$</span>Diet, ChickWeight<span class="op">$</span>Chick, <span class="dt">FUN =</span> <span class="cf">function</span>(x){<span class="dv">1</span>}))</span></code></pre></div>
<pre><code>## [1] 50</code></pre>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="exercise-solutions.html#cb740-1"></a><span class="co">#OR</span></span>
<span id="cb740-2"><a href="exercise-solutions.html#cb740-2"></a><span class="kw">length</span>(<span class="kw">unique</span>(ChickWeight<span class="op">$</span>Chick))</span></code></pre></div>
<pre><code>## [1] 50</code></pre>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="exercise-solutions.html#cb742-1"></a><span class="co">#OR</span></span>
<span id="cb742-2"><a href="exercise-solutions.html#cb742-2"></a><span class="kw">nrow</span>(<span class="kw">aggregate</span>(<span class="dt">x =</span> ChickWeight, <span class="dt">by =</span> <span class="kw">list</span>(ChickWeight<span class="op">$</span>Chick), <span class="dt">FUN =</span> <span class="cf">function</span>(x){x}))</span></code></pre></div>
<pre><code>## [1] 50</code></pre>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="exercise-solutions.html#cb744-1"></a><span class="kw">aggregate</span>(<span class="dt">formula =</span> weight <span class="op">~</span><span class="st"> </span>Diet, <span class="dt">data=</span>ChickWeight, <span class="dt">FUN =</span> mean, <span class="dt">na.rm =</span> T)</span></code></pre></div>
<pre><code>##   Diet weight
## 1    1    103
## 2    2    123
## 3    3    143
## 4    4    135</code></pre>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="exercise-solutions.html#cb746-1"></a><span class="co">#OR</span></span>
<span id="cb746-2"><a href="exercise-solutions.html#cb746-2"></a><span class="kw">aggregate</span>(<span class="dt">x =</span> ChickWeight<span class="op">$</span>weight, <span class="dt">by =</span> <span class="kw">list</span>(<span class="dt">Diet =</span> ChickWeight<span class="op">$</span>Diet), <span class="dt">FUN =</span> mean, <span class="dt">na.rm =</span> T)</span></code></pre></div>
<pre><code>##   Diet   x
## 1    1 103
## 2    2 123
## 3    3 143
## 4    4 135</code></pre>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="exercise-solutions.html#cb748-1"></a><span class="kw">coplot</span>(weight <span class="op">~</span><span class="st"> </span>Time <span class="op">|</span><span class="st"> </span>Diet, <span class="dt">data =</span> ChickWeight, <span class="dt">panel =</span> panel.smooth)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
<p><strong>D</strong><br />
This is the “naive” solution:</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="exercise-solutions.html#cb749-1"></a><span class="co">#A naive for-loop here - is this the best solution?</span></span>
<span id="cb749-2"><a href="exercise-solutions.html#cb749-2"></a>ChickWeight<span class="op">$</span>weight_gain &lt;-<span class="st"> </span><span class="ot">NA</span> <span class="co">#create the column with missing values</span></span>
<span id="cb749-3"><a href="exercise-solutions.html#cb749-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ChickWeight)) {</span>
<span id="cb749-4"><a href="exercise-solutions.html#cb749-4"></a>        <span class="co">#skip first row and rows that are preceded by values for another chick</span></span>
<span id="cb749-5"><a href="exercise-solutions.html#cb749-5"></a>        <span class="cf">if</span> (i <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;&amp;</span><span class="st"> </span>ChickWeight<span class="op">$</span>Chick[i] <span class="op">==</span><span class="st"> </span>ChickWeight<span class="op">$</span>Chick[i<span class="dv">-1</span>]) {</span>
<span id="cb749-6"><a href="exercise-solutions.html#cb749-6"></a>                ChickWeight[i, <span class="st">&quot;weight_gain&quot;</span>] &lt;-<span class="st"> </span>ChickWeight<span class="op">$</span>weight[i] <span class="op">-</span><span class="st"> </span>ChickWeight<span class="op">$</span>weight[i<span class="dv">-1</span>] </span>
<span id="cb749-7"><a href="exercise-solutions.html#cb749-7"></a>        }</span>
<span id="cb749-8"><a href="exercise-solutions.html#cb749-8"></a>}</span></code></pre></div>
<p>This is the most efficient way of dealing with this in base R. Function <code>do.call()</code> is out of scope for this course!</p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="exercise-solutions.html#cb750-1"></a>weight_gain &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb750-2"><a href="exercise-solutions.html#cb750-2"></a>    <span class="co">#x is a dataframe</span></span>
<span id="cb750-3"><a href="exercise-solutions.html#cb750-3"></a>    leaded &lt;-<span class="st"> </span><span class="kw">c</span>(x<span class="op">$</span>weight)</span>
<span id="cb750-4"><a href="exercise-solutions.html#cb750-4"></a>    lagged &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>, x<span class="op">$</span>weight[<span class="dv">1</span><span class="op">:</span>(<span class="kw">length</span>(x<span class="op">$</span>weight)<span class="op">-</span><span class="dv">1</span>)])</span>
<span id="cb750-5"><a href="exercise-solutions.html#cb750-5"></a>    x<span class="op">$</span>gain &lt;-<span class="st"> </span>leaded <span class="op">-</span><span class="st"> </span>lagged</span>
<span id="cb750-6"><a href="exercise-solutions.html#cb750-6"></a>    x</span>
<span id="cb750-7"><a href="exercise-solutions.html#cb750-7"></a>}</span>
<span id="cb750-8"><a href="exercise-solutions.html#cb750-8"></a></span>
<span id="cb750-9"><a href="exercise-solutions.html#cb750-9"></a>split_cw &lt;-<span class="st"> </span><span class="kw">split</span>(<span class="dt">x =</span> ChickWeight, <span class="dt">f =</span> ChickWeight<span class="op">$</span>Chick)</span>
<span id="cb750-10"><a href="exercise-solutions.html#cb750-10"></a>new_cw &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, <span class="kw">lapply</span>(<span class="dt">X =</span> split_cw, <span class="dt">FUN =</span> weight_gain))</span>
<span id="cb750-11"><a href="exercise-solutions.html#cb750-11"></a></span>
<span id="cb750-12"><a href="exercise-solutions.html#cb750-12"></a><span class="kw">head</span>(new_cw)</span></code></pre></div>
<pre><code>## Grouped Data: weight ~ Time | Chick
##        weight Time Chick Diet weight_gain gain
## 18.195     39    0    18    1          NA   NA
## 18.196     35    2    18    1          -4   -4
## 16.176     41    0    16    1          NA   NA
## 16.177     45    2    16    1           4    4
## 16.178     49    4    16    1           4    4
## 16.179     51    6    16    1           2    2</code></pre>
<p><strong>E</strong></p>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="exercise-solutions.html#cb752-1"></a>local_file &lt;-<span class="st"> &quot;ChickWeight_weight_gain.Rdata&quot;</span></span>
<span id="cb752-2"><a href="exercise-solutions.html#cb752-2"></a><span class="kw">download.file</span>(<span class="kw">paste0</span>(<span class="st">&quot;https://github.com/MichielNoback/davur1_gitbook/raw/master/data/&quot;</span>, local_file), local_file)</span>
<span id="cb752-3"><a href="exercise-solutions.html#cb752-3"></a><span class="kw">load</span>(local_file)</span>
<span id="cb752-4"><a href="exercise-solutions.html#cb752-4"></a><span class="co">#attach</span></span>
<span id="cb752-5"><a href="exercise-solutions.html#cb752-5"></a>ChickWeight<span class="op">$</span>weight_gain &lt;-<span class="st"> </span>stored.weight.gain</span></code></pre></div>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="exercise-solutions.html#cb753-1"></a><span class="kw">tapply</span>(<span class="dt">X =</span> ChickWeight<span class="op">$</span>weight_gain, <span class="dt">INDEX =</span> ChickWeight<span class="op">$</span>Diet, <span class="dt">FUN =</span> mean, <span class="dt">na.rm =</span> T)</span>
<span id="cb753-2"><a href="exercise-solutions.html#cb753-2"></a><span class="co">#or with aggregate</span></span>
<span id="cb753-3"><a href="exercise-solutions.html#cb753-3"></a><span class="kw">aggregate</span>(<span class="dt">formula =</span> weight_gain <span class="op">~</span><span class="st"> </span>Diet, <span class="dt">data =</span> ChickWeight, <span class="dt">FUN =</span> median)</span>
<span id="cb753-4"><a href="exercise-solutions.html#cb753-4"></a><span class="co">#or with split and sapply</span></span>
<span id="cb753-5"><a href="exercise-solutions.html#cb753-5"></a><span class="kw">sapply</span>(<span class="kw">split</span>(ChickWeight[, <span class="st">&quot;weight_gain&quot;</span>], ChickWeight<span class="op">$</span>Diet), sd, <span class="dt">na.rm =</span> T)</span></code></pre></div>
<p><strong>F</strong></p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="exercise-solutions.html#cb754-1"></a><span class="kw">boxplot</span>(weight_gain <span class="op">~</span><span class="st"> </span>Diet, <span class="dt">data =</span> ChickWeight)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/weight-gain-boxplot-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="food-constituents-1" class="section level3">
<h3><span class="header-section-number">11.8.3</span> Food constituents</h3>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="exercise-solutions.html#cb755-1"></a>foods &lt;-<span class="st"> </span><span class="kw">read.table</span>(</span>
<span id="cb755-2"><a href="exercise-solutions.html#cb755-2"></a>        <span class="st">&quot;https://raw.githubusercontent.com/MichielNoback/davur1_gitbook/master/data/food_constituents.txt&quot;</span>, <span class="dt">header =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="exercise-solutions.html#cb756-1"></a><span class="kw">levels</span>(foods<span class="op">$</span>Type)</span>
<span id="cb756-2"><a href="exercise-solutions.html#cb756-2"></a><span class="kw">table</span>(foods<span class="op">$</span>Type)</span></code></pre></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="exercise-solutions.html#cb757-1"></a><span class="kw">mean</span>(foods[foods<span class="op">$</span>Type <span class="op">==</span><span class="st"> &quot;chocolate&quot;</span>, <span class="st">&quot;kcal&quot;</span>])</span></code></pre></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="exercise-solutions.html#cb758-1"></a><span class="co">#aggregate over Type</span></span>
<span id="cb758-2"><a href="exercise-solutions.html#cb758-2"></a>mean.fat &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="dt">formula =</span> fat.total <span class="op">~</span><span class="st"> </span>Type, <span class="dt">data =</span> foods, <span class="dt">FUN =</span> mean)</span>
<span id="cb758-3"><a href="exercise-solutions.html#cb758-3"></a><span class="co">#order and select first</span></span>
<span id="cb758-4"><a href="exercise-solutions.html#cb758-4"></a>mean.fat[<span class="kw">order</span>(mean.fat<span class="op">$</span>fat.total, <span class="dt">decreasing =</span> T)[<span class="dv">1</span>], ]</span></code></pre></div>
<p><strong>D</strong></p>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="exercise-solutions.html#cb759-1"></a>mean.energy &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="dt">formula =</span> kcal <span class="op">~</span><span class="st"> </span>Type, <span class="dt">data =</span> foods, <span class="dt">FUN =</span> mean)</span>
<span id="cb759-2"><a href="exercise-solutions.html#cb759-2"></a>mean.energy[<span class="kw">order</span>(mean.energy<span class="op">$</span>kcal)[<span class="dv">1</span>], ]</span>
<span id="cb759-3"><a href="exercise-solutions.html#cb759-3"></a>mean.energy[<span class="kw">order</span>(mean.energy<span class="op">$</span>kcal, <span class="dt">decreasing =</span> T)[<span class="dv">1</span>], ]</span></code></pre></div>
<p><strong>E</strong></p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="exercise-solutions.html#cb760-1"></a><span class="co">#more verbose means possible; this efficient way demonstrating use of %in%</span></span>
<span id="cb760-2"><a href="exercise-solutions.html#cb760-2"></a>foods<span class="op">$</span>solid.state &lt;-<span class="st"> </span><span class="op">!</span>foods<span class="op">$</span>Type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;milk&quot;</span>, <span class="st">&quot;beverage&quot;</span>)</span>
<span id="cb760-3"><a href="exercise-solutions.html#cb760-3"></a><span class="kw">boxplot</span>(<span class="dt">formula =</span> carb.sugar <span class="op">~</span><span class="st"> </span>solid.state, </span>
<span id="cb760-4"><a href="exercise-solutions.html#cb760-4"></a>                <span class="dt">data =</span> foods,</span>
<span id="cb760-5"><a href="exercise-solutions.html#cb760-5"></a>                <span class="dt">main =</span> <span class="st">&quot;Sugar content of foods categories&quot;</span>, </span>
<span id="cb760-6"><a href="exercise-solutions.html#cb760-6"></a>                <span class="dt">names =</span> (<span class="kw">c</span>(<span class="st">&quot;Drink&quot;</span>, <span class="st">&quot;Solid&quot;</span>)),</span>
<span id="cb760-7"><a href="exercise-solutions.html#cb760-7"></a>                <span class="dt">ylab =</span> <span class="st">&quot;Sugar (g/100g product)&quot;</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/foods-boxplot-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><strong>F</strong><br />
<span class="math display">\[NO WORKED SOLUTION HERE\]</span></p>
</div>
<div id="urine-properties-1" class="section level3">
<h3><span class="header-section-number">11.8.4</span> Urine properties</h3>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="exercise-solutions.html#cb761-1"></a>urine_file_name &lt;-<span class="st"> &quot;urine.csv&quot;</span></span>
<span id="cb761-2"><a href="exercise-solutions.html#cb761-2"></a>url &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;https://raw.githubusercontent.com/MichielNoback/datasets/master/urine/&quot;</span>, urine_file_name)</span>
<span id="cb761-3"><a href="exercise-solutions.html#cb761-3"></a>local_name &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;../&quot;</span>, urine_file_name) <span class="co">#specifiy your own folder!</span></span>
<span id="cb761-4"><a href="exercise-solutions.html#cb761-4"></a><span class="kw">download.file</span>(<span class="dt">url =</span> url, <span class="dt">destfile =</span> local_name)</span></code></pre></div>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="exercise-solutions.html#cb762-1"></a>urine &lt;-<span class="st"> </span><span class="kw">read.table</span>(local_name, </span>
<span id="cb762-2"><a href="exercise-solutions.html#cb762-2"></a>                     <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>,</span>
<span id="cb762-3"><a href="exercise-solutions.html#cb762-3"></a>                     <span class="dt">header =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="exercise-solutions.html#cb763-1"></a><span class="kw">names</span>(urine)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;ox_crystals&quot;</span></span>
<span id="cb763-2"><a href="exercise-solutions.html#cb763-2"></a>urine<span class="op">$</span>ox_crystals &lt;-<span class="st"> </span><span class="kw">factor</span>(urine<span class="op">$</span>ox_crystals, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>))</span></code></pre></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="exercise-solutions.html#cb764-1"></a>mean_sd &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb764-2"><a href="exercise-solutions.html#cb764-2"></a>    <span class="co"># returns a named vector</span></span>
<span id="cb764-3"><a href="exercise-solutions.html#cb764-3"></a>    <span class="kw">c</span>(<span class="st">&quot;mean&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(x, <span class="dt">na.rm =</span> T), <span class="dv">2</span>), </span>
<span id="cb764-4"><a href="exercise-solutions.html#cb764-4"></a>      <span class="st">&quot;sd&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">sd</span>(x, <span class="dt">na.rm =</span> T), <span class="dv">2</span>))</span>
<span id="cb764-5"><a href="exercise-solutions.html#cb764-5"></a>}</span>
<span id="cb764-6"><a href="exercise-solutions.html#cb764-6"></a><span class="kw">apply</span>(<span class="dt">X =</span> urine[, <span class="dv">3</span><span class="op">:</span><span class="dv">8</span>], <span class="dt">MARGIN =</span> <span class="dv">2</span>, <span class="dt">FUN =</span> mean_sd)</span></code></pre></div>
<pre><code>##      gravity   ph osmo  cond urea calc
## mean    1.02 6.03  615 20.90  266 4.14
## sd      0.01 0.72  238  7.95  131 3.26</code></pre>
<p><strong>D</strong></p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="exercise-solutions.html#cb766-1"></a><span class="kw">aggregate</span>(<span class="kw">cbind</span>(gravity, ph, osmo, cond, urea, calc) <span class="op">~</span><span class="st"> </span>ox_crystals, </span>
<span id="cb766-2"><a href="exercise-solutions.html#cb766-2"></a>          <span class="dt">data =</span> urine, </span>
<span id="cb766-3"><a href="exercise-solutions.html#cb766-3"></a>          <span class="dt">FUN =</span> <span class="cf">function</span>(x) <span class="kw">round</span>(<span class="kw">mean</span>(x, <span class="dt">na.rm =</span> T), <span class="dv">2</span>))</span></code></pre></div>
<pre><code>##   ox_crystals gravity   ph osmo cond urea calc
## 1          no    1.02 6.13  562 20.6  232 2.63
## 2         yes    1.02 5.93  683 21.4  302 6.20</code></pre>
<p><strong>E</strong></p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="exercise-solutions.html#cb768-1"></a><span class="kw">pairs</span>(urine[, <span class="dv">3</span><span class="op">:</span><span class="dv">8</span>])</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
<p><strong>F</strong></p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="exercise-solutions.html#cb769-1"></a><span class="co">#install.packages(&quot;gplots&quot;)</span></span>
<span id="cb769-2"><a href="exercise-solutions.html#cb769-2"></a><span class="kw">library</span>(<span class="st">&quot;gplots&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;gplots&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     lowess</code></pre>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="exercise-solutions.html#cb772-1"></a>cormat &lt;-<span class="st"> </span><span class="kw">cor</span>(urine[, <span class="dv">3</span><span class="op">:</span><span class="dv">8</span>], <span class="dt">use =</span> <span class="st">&quot;complete.obs&quot;</span>)</span>
<span id="cb772-2"><a href="exercise-solutions.html#cb772-2"></a><span class="kw">heatmap.2</span>(cormat, <span class="dt">col =</span> <span class="kw">bluered</span>(<span class="dv">100</span>), <span class="dt">trace =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">density.info =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/unnamed-chunk-170-1.png" width="672" /></p>
<p><strong>G</strong></p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="exercise-solutions.html#cb773-1"></a>ph_factor &lt;-<span class="st"> </span><span class="kw">cut</span>(urine<span class="op">$</span>ph, </span>
<span id="cb773-2"><a href="exercise-solutions.html#cb773-2"></a>    <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="fl">7.0</span>, <span class="fl">8.0</span>), </span>
<span id="cb773-3"><a href="exercise-solutions.html#cb773-3"></a>    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;acidic&quot;</span>, <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;basic&quot;</span>))</span>
<span id="cb773-4"><a href="exercise-solutions.html#cb773-4"></a>urine<span class="op">$</span>ph_factor &lt;-<span class="st"> </span>ph_factor</span>
<span id="cb773-5"><a href="exercise-solutions.html#cb773-5"></a></span>
<span id="cb773-6"><a href="exercise-solutions.html#cb773-6"></a>mean_median_sd &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb773-7"><a href="exercise-solutions.html#cb773-7"></a>    <span class="co"># X is a dataframe!</span></span>
<span id="cb773-8"><a href="exercise-solutions.html#cb773-8"></a>    <span class="kw">apply</span>(<span class="dt">X =</span> x[<span class="dv">3</span><span class="op">:</span><span class="dv">8</span>],</span>
<span id="cb773-9"><a href="exercise-solutions.html#cb773-9"></a>          <span class="dt">MARGIN =</span> <span class="dv">2</span>,</span>
<span id="cb773-10"><a href="exercise-solutions.html#cb773-10"></a>          <span class="dt">FUN =</span> <span class="cf">function</span>(y) {</span>
<span id="cb773-11"><a href="exercise-solutions.html#cb773-11"></a>              <span class="co"># returns a named vector</span></span>
<span id="cb773-12"><a href="exercise-solutions.html#cb773-12"></a>              <span class="kw">c</span>(<span class="st">&quot;mean&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(y, <span class="dt">na.rm =</span> T), <span class="dv">2</span>), </span>
<span id="cb773-13"><a href="exercise-solutions.html#cb773-13"></a>                <span class="st">&quot;median&quot;</span> =<span class="st"> </span><span class="kw">median</span>(y, <span class="dt">na.rm =</span> T),</span>
<span id="cb773-14"><a href="exercise-solutions.html#cb773-14"></a>                <span class="st">&quot;sd&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">sd</span>(y, <span class="dt">na.rm =</span> T), <span class="dv">2</span>))            </span>
<span id="cb773-15"><a href="exercise-solutions.html#cb773-15"></a>          })</span>
<span id="cb773-16"><a href="exercise-solutions.html#cb773-16"></a>}</span>
<span id="cb773-17"><a href="exercise-solutions.html#cb773-17"></a></span>
<span id="cb773-18"><a href="exercise-solutions.html#cb773-18"></a>urine_split &lt;-<span class="st"> </span><span class="kw">split</span>(<span class="dt">x =</span> urine, </span>
<span id="cb773-19"><a href="exercise-solutions.html#cb773-19"></a>      <span class="dt">f =</span> urine<span class="op">$</span>ph_factor)</span>
<span id="cb773-20"><a href="exercise-solutions.html#cb773-20"></a></span>
<span id="cb773-21"><a href="exercise-solutions.html#cb773-21"></a><span class="kw">lapply</span>(<span class="dt">X =</span> urine_split,</span>
<span id="cb773-22"><a href="exercise-solutions.html#cb773-22"></a>       <span class="dt">FUN =</span> mean_median_sd)</span></code></pre></div>
<pre><code>## $acidic
##        gravity   ph osmo  cond urea calc
## mean      1.02 5.20  690 23.04  298 4.85
## median    1.02 5.25  730 25.30  292 3.19
## sd        0.01 0.23  227  6.52  141 4.19
## 
## $neutral
##        gravity   ph osmo  cond urea calc
## mean      1.02 6.09  605 20.12  272 4.05
## median    1.02 5.98  578 20.60  260 3.46
## sd        0.01 0.42  247  8.56  126 2.93
## 
## $basic
##        gravity   ph osmo  cond  urea calc
## mean      1.01 7.51  510 21.51 155.8 3.13
## median    1.02 7.50  547 22.50 112.5 1.75
## sd        0.01 0.38  166  6.12  95.5 3.06</code></pre>
</div>
<div id="bird-observations-revisited-1" class="section level3">
<h3><span class="header-section-number">11.8.5</span> Bird observations revisited</h3>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="exercise-solutions.html#cb775-1"></a>bird_obs &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/Observations-Data-2014.csv&quot;</span>,</span>
<span id="cb775-2"><a href="exercise-solutions.html#cb775-2"></a>                                <span class="dt">sep=</span><span class="st">&quot;;&quot;</span>,</span>
<span id="cb775-3"><a href="exercise-solutions.html#cb775-3"></a>                                <span class="dt">head=</span>T,</span>
<span id="cb775-4"><a href="exercise-solutions.html#cb775-4"></a>                                <span class="dt">na.strings =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb775-5"><a href="exercise-solutions.html#cb775-5"></a>                                <span class="dt">quote =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb775-6"><a href="exercise-solutions.html#cb775-6"></a>                                <span class="dt">comment.char =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb775-7"><a href="exercise-solutions.html#cb775-7"></a>                                <span class="dt">as.is =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">13</span>))</span>
<span id="cb775-8"><a href="exercise-solutions.html#cb775-8"></a>bird_obs<span class="op">$</span>Count &lt;-<span class="st"> </span><span class="kw">as.integer</span>(bird_obs<span class="op">$</span>Number)</span></code></pre></div>
<p><strong>A</strong></p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="exercise-solutions.html#cb776-1"></a>c.split &lt;-<span class="st"> </span><span class="kw">split</span>(<span class="dt">x =</span> bird_obs, <span class="dt">f =</span> bird_obs<span class="op">$</span>County)</span>
<span id="cb776-2"><a href="exercise-solutions.html#cb776-2"></a>c.counts &lt;-<span class="st"> </span><span class="kw">sapply</span>(c.split, nrow)</span>
<span id="cb776-3"><a href="exercise-solutions.html#cb776-3"></a><span class="kw">barplot</span>(c.counts[<span class="kw">order</span>(c.counts, <span class="dt">decreasing =</span> T)],</span>
<span id="cb776-4"><a href="exercise-solutions.html#cb776-4"></a>                <span class="dt">main =</span> <span class="st">&quot;Bird observations per county&quot;</span>,</span>
<span id="cb776-5"><a href="exercise-solutions.html#cb776-5"></a>                <span class="dt">ylab =</span> <span class="st">&quot;Observations&quot;</span>,</span>
<span id="cb776-6"><a href="exercise-solutions.html#cb776-6"></a>                <span class="dt">las =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="davur_ebook_files/figure-html/bird-counts-barplot-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><strong>B</strong></p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="exercise-solutions.html#cb777-1"></a>obs.split &lt;-<span class="st"> </span><span class="kw">split</span>(<span class="dt">x =</span> bird_obs, <span class="dt">f =</span> bird_obs<span class="op">$</span>Observer<span class="fl">.1</span>)</span>
<span id="cb777-2"><a href="exercise-solutions.html#cb777-2"></a>obs.counts &lt;-<span class="st"> </span><span class="kw">sapply</span>(obs.split, nrow)</span>
<span id="cb777-3"><a href="exercise-solutions.html#cb777-3"></a>obs.counts &lt;-<span class="st"> </span>obs.counts[obs.counts <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span>]</span>
<span id="cb777-4"><a href="exercise-solutions.html#cb777-4"></a>obs.counts[<span class="kw">order</span>(obs.counts, <span class="dt">decreasing =</span> T)]</span></code></pre></div>
<p><strong>C</strong></p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="exercise-solutions.html#cb778-1"></a>obs.counts[<span class="kw">order</span>(obs.counts, <span class="dt">decreasing =</span> T)][<span class="dv">1</span>]</span></code></pre></div>
<p><strong>D</strong></p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="exercise-solutions.html#cb779-1"></a>g.split &lt;-<span class="st"> </span><span class="kw">split</span>(bird_obs, bird_obs<span class="op">$</span>Genus)</span>
<span id="cb779-2"><a href="exercise-solutions.html#cb779-2"></a>g.species &lt;-<span class="st"> </span><span class="kw">lapply</span>(g.split, <span class="cf">function</span>(x) {</span>
<span id="cb779-3"><a href="exercise-solutions.html#cb779-3"></a>        <span class="kw">unique</span>(x<span class="op">$</span>Common.name)</span>
<span id="cb779-4"><a href="exercise-solutions.html#cb779-4"></a>})</span>
<span id="cb779-5"><a href="exercise-solutions.html#cb779-5"></a><span class="co">#create ordering</span></span>
<span id="cb779-6"><a href="exercise-solutions.html#cb779-6"></a>g.species.count &lt;-<span class="st"> </span><span class="kw">sapply</span>(g.species, length)</span>
<span id="cb779-7"><a href="exercise-solutions.html#cb779-7"></a>g.order &lt;-<span class="st"> </span><span class="kw">order</span>(g.species.count, <span class="dt">decreasing =</span> T)</span>
<span id="cb779-8"><a href="exercise-solutions.html#cb779-8"></a><span class="co">#apply order to list and select only first five</span></span>
<span id="cb779-9"><a href="exercise-solutions.html#cb779-9"></a>g.species[g.order[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]]</span></code></pre></div>
<p><strong>E</strong></p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="exercise-solutions.html#cb780-1"></a>bird_obs<span class="op">$</span>Date.start &lt;-<span class="st"> </span><span class="kw">as.Date</span>(bird_obs<span class="op">$</span>Date.start, <span class="dt">format =</span> <span class="st">&quot;%d-%b-%y&quot;</span>)</span>
<span id="cb780-2"><a href="exercise-solutions.html#cb780-2"></a>date.series &lt;-<span class="st"> </span><span class="kw">aggregate</span>(Count <span class="op">~</span><span class="st"> </span>Date.start, <span class="dt">data =</span> bird_obs, <span class="dt">FUN =</span> sum, <span class="dt">na.rm =</span> T)</span>
<span id="cb780-3"><a href="exercise-solutions.html#cb780-3"></a><span class="co">#2024 is an error input, remove it</span></span>
<span id="cb780-4"><a href="exercise-solutions.html#cb780-4"></a>date.series &lt;-<span class="st"> </span>date.series[<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(date.series)<span class="op">-</span><span class="dv">1</span>, ]</span>
<span id="cb780-5"><a href="exercise-solutions.html#cb780-5"></a><span class="kw">plot</span>(<span class="dt">x =</span> date.series<span class="op">$</span>Date.start, <span class="dt">y =</span> date.series<span class="op">$</span>Count, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">250</span>))</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exercises.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["davur_ebook.pdf", "davur_ebook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
