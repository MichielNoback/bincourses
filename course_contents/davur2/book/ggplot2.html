<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 The ggplot2 package | Data Analysis and Visualization using R (2)</title>
  <meta name="description" content="This is the ebook accompanying the course Data Analysis and Visualization using R 2 (DAVuR2)." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 The ggplot2 package | Data Analysis and Visualization using R (2)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the ebook accompanying the course Data Analysis and Visualization using R 2 (DAVuR2)." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 The ggplot2 package | Data Analysis and Visualization using R (2)" />
  
  <meta name="twitter:description" content="This is the ebook accompanying the course Data Analysis and Visualization using R 2 (DAVuR2)." />
  

<meta name="author" content="Michiel Noback" />


<meta name="date" content="2021-04-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="developing-a-custom-visualization.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DAVuR2 gitbook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>1</b> The <code>ggplot2</code> package</a><ul>
<li class="chapter" data-level="1.1" data-path="ggplot2.html"><a href="ggplot2.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#keep-the-goal-in-mind"><i class="fa fa-check"></i>Keep the goal in mind</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="ggplot2.html"><a href="ggplot2.html#getting-started"><i class="fa fa-check"></i><b>1.2</b> Getting started</a><ul>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#a-first-plot"><i class="fa fa-check"></i>A first plot</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#adding-a-dimension-using-color"><i class="fa fa-check"></i>Adding a dimension using color</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#inspecting-and-tuning-the-figure"><i class="fa fa-check"></i>Inspecting and tuning the figure</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-and-the-theory-of-graphics"><i class="fa fa-check"></i><b>1.3</b> ggplot2 and the theory of graphics</a><ul>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#philosophy-of-ggplot2"><i class="fa fa-check"></i>Philosophy of ggplot2</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#the-grammar-of-graphics"><i class="fa fa-check"></i>The grammar of graphics</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="ggplot2.html"><a href="ggplot2.html#building-plots-with-ggplot2"><i class="fa fa-check"></i><b>1.4</b> Building plots with ggplot2</a><ul>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#the-layered-plot-architecture"><i class="fa fa-check"></i>The layered plot architecture</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#tidy-the-data"><i class="fa fa-check"></i>“Tidy” the data</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="ggplot2.html"><a href="ggplot2.html#aesthetics"><i class="fa fa-check"></i><b>1.5</b> Aesthetics</a><ul>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#colors"><i class="fa fa-check"></i>Colors</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#shapes"><i class="fa fa-check"></i>Shapes</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#lines"><i class="fa fa-check"></i>Lines</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#size"><i class="fa fa-check"></i>Size</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="ggplot2.html"><a href="ggplot2.html#geometries"><i class="fa fa-check"></i><b>1.6</b> Geometries</a><ul>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#what-are-geometries"><i class="fa fa-check"></i>What are geometries</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#boxplot"><i class="fa fa-check"></i>Boxplot</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#jitter"><i class="fa fa-check"></i>Jitter</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#plot-overlays-boxplot-jitter"><i class="fa fa-check"></i>Plot overlays: boxplot + jitter</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#scatterplot-points"><i class="fa fa-check"></i>Scatterplot: Points</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#line-plots"><i class="fa fa-check"></i>Line plots</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#histograms"><i class="fa fa-check"></i>Histograms</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#violin-plot"><i class="fa fa-check"></i>Violin plot</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#barplot"><i class="fa fa-check"></i>Barplot</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#overview-of-the-main-geoms"><i class="fa fa-check"></i>Overview of the main geoms</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="ggplot2.html"><a href="ggplot2.html#inheritance-of-aesthetics"><i class="fa fa-check"></i><b>1.7</b> Inheritance of aesthetics</a></li>
<li class="chapter" data-level="1.8" data-path="ggplot2.html"><a href="ggplot2.html#faceting"><i class="fa fa-check"></i><b>1.8</b> Faceting</a></li>
<li class="chapter" data-level="1.9" data-path="ggplot2.html"><a href="ggplot2.html#experimenting-with-geoms-and-aesthetics"><i class="fa fa-check"></i><b>1.9</b> Experimenting with geoms and aesthetics</a></li>
<li class="chapter" data-level="1.10" data-path="ggplot2.html"><a href="ggplot2.html#multivariate-categorical-data"><i class="fa fa-check"></i><b>1.10</b> Multivariate Categorical Data</a><ul>
<li class="chapter" data-level="1.10.1" data-path="ggplot2.html"><a href="ggplot2.html#bar-plots-of-contingency-tables"><i class="fa fa-check"></i><b>1.10.1</b> Bar plots of contingency tables</a></li>
<li class="chapter" data-level="1.10.2" data-path="ggplot2.html"><a href="ggplot2.html#balloon-plot"><i class="fa fa-check"></i><b>1.10.2</b> Balloon plot</a></li>
<li class="chapter" data-level="1.10.3" data-path="ggplot2.html"><a href="ggplot2.html#correspondence-analysis"><i class="fa fa-check"></i><b>1.10.3</b> Correspondence analysis</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="ggplot2.html"><a href="ggplot2.html#advanced-plotting-aspects"><i class="fa fa-check"></i><b>1.11</b> Advanced plotting aspects</a><ul>
<li class="chapter" data-level="1.11.1" data-path="ggplot2.html"><a href="ggplot2.html#plot-panels-from-for-loops-using-gridextragrid.arrange"><i class="fa fa-check"></i><b>1.11.1</b> Plot panels from <code>for</code> loops using <code>gridExtra::grid.arrange()</code></a></li>
<li class="chapter" data-level="1.11.2" data-path="ggplot2.html"><a href="ggplot2.html#the-ggallyggpairs-function"><i class="fa fa-check"></i><b>1.11.2</b> The <code>GGally::ggPairs()</code> function</a></li>
<li class="chapter" data-level="1.11.3" data-path="ggplot2.html"><a href="ggplot2.html#marginal-plots-using-ggextraggmarginal"><i class="fa fa-check"></i><b>1.11.3</b> Marginal plots using <code>ggExtra::ggMarginal()</code></a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="ggplot2.html"><a href="ggplot2.html#final-tweaks"><i class="fa fa-check"></i><b>1.12</b> Final tweaks</a><ul>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#scales-coordinates-and-annotations"><i class="fa fa-check"></i>Scales, Coordinates and Annotations</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#labels"><i class="fa fa-check"></i>Labels</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#themes"><i class="fa fa-check"></i>Themes</a></li>
<li class="chapter" data-level="" data-path="ggplot2.html"><a href="ggplot2.html#annotation"><i class="fa fa-check"></i>Annotation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="developing-a-custom-visualization.html"><a href="developing-a-custom-visualization.html"><i class="fa fa-check"></i><b>2</b> Developing a custom visualization</a><ul>
<li class="chapter" data-level="2.1" data-path="developing-a-custom-visualization.html"><a href="developing-a-custom-visualization.html#an-experimental-ptsd-treatment"><i class="fa fa-check"></i><b>2.1</b> An experimental PTSD treatment</a><ul>
<li class="chapter" data-level="" data-path="developing-a-custom-visualization.html"><a href="developing-a-custom-visualization.html#the-data"><i class="fa fa-check"></i>The data</a></li>
<li class="chapter" data-level="" data-path="developing-a-custom-visualization.html"><a href="developing-a-custom-visualization.html#choose-a-visualization"><i class="fa fa-check"></i>Choose a visualization</a></li>
<li class="chapter" data-level="" data-path="developing-a-custom-visualization.html"><a href="developing-a-custom-visualization.html#tidy-the-data-1"><i class="fa fa-check"></i>Tidy the data</a></li>
<li class="chapter" data-level="" data-path="developing-a-custom-visualization.html"><a href="developing-a-custom-visualization.html#a-first-version"><i class="fa fa-check"></i>A first version</a></li>
<li class="chapter" data-level="" data-path="developing-a-custom-visualization.html"><a href="developing-a-custom-visualization.html#add-mean-and-sd"><i class="fa fa-check"></i>Add mean and SD</a></li>
<li class="chapter" data-level="" data-path="developing-a-custom-visualization.html"><a href="developing-a-custom-visualization.html#emphasize-worst-cases"><i class="fa fa-check"></i>Emphasize worst cases</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="developing-a-custom-visualization.html"><a href="developing-a-custom-visualization.html#last-tweaks-fonts-and-legend"><i class="fa fa-check"></i><b>2.2</b> Last tweaks: fonts and legend</a></li>
<li class="chapter" data-level="2.3" data-path="developing-a-custom-visualization.html"><a href="developing-a-custom-visualization.html#the-code"><i class="fa fa-check"></i><b>2.3</b> The code</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tidyr.html"><a href="tidyr.html"><i class="fa fa-check"></i><b>3</b> Package tidyr</a><ul>
<li class="chapter" data-level="3.1" data-path="tidyr.html"><a href="tidyr.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="tidyr.html"><a href="tidyr.html#the-pivot_longer-function"><i class="fa fa-check"></i><b>3.2</b> The <code>pivot_longer()</code> function</a></li>
<li class="chapter" data-level="3.3" data-path="tidyr.html"><a href="tidyr.html#a-more-complex-problem-two-sets-of-columns"><i class="fa fa-check"></i><b>3.3</b> A more complex problem: two sets of columns</a></li>
<li class="chapter" data-level="3.4" data-path="tidyr.html"><a href="tidyr.html#widening-with-pivot_wider"><i class="fa fa-check"></i><b>3.4</b> Widening with <code>pivot_wider()</code></a></li>
<li class="chapter" data-level="3.5" data-path="tidyr.html"><a href="tidyr.html#split-columns-with-separate"><i class="fa fa-check"></i><b>3.5</b> Split columns with <code>separate()</code></a></li>
<li class="chapter" data-level="3.6" data-path="tidyr.html"><a href="tidyr.html#combine-columns"><i class="fa fa-check"></i><b>3.6</b> Combine columns</a></li>
<li class="chapter" data-level="3.7" data-path="tidyr.html"><a href="tidyr.html#drop-rows-with-missing-values-drop_na"><i class="fa fa-check"></i><b>3.7</b> Drop rows with missing values: <code>drop_na()</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>4</b> Data mangling with package <code>dplyr</code></a><ul>
<li class="chapter" data-level="4.1" data-path="dplyr.html"><a href="dplyr.html#tibbles"><i class="fa fa-check"></i><b>4.1</b> Tibbles</a><ul>
<li class="chapter" data-level="4.1.1" data-path="dplyr.html"><a href="dplyr.html#by-row-constructor"><i class="fa fa-check"></i><b>4.1.1</b> By-row constructor</a></li>
<li class="chapter" data-level="4.1.2" data-path="dplyr.html"><a href="dplyr.html#tibbles-vs-data-frames"><i class="fa fa-check"></i><b>4.1.2</b> Tibbles vs data frames</a></li>
<li class="chapter" data-level="4.1.3" data-path="dplyr.html"><a href="dplyr.html#the-str-equivalent-glimpse"><i class="fa fa-check"></i><b>4.1.3</b> The <code>str()</code> equivalent: <code>glimpse()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="dplyr.html"><a href="dplyr.html#the-chaining-operator"><i class="fa fa-check"></i><b>4.2</b> The chaining operator <code>%&gt;%</code></a></li>
<li class="chapter" data-level="4.3" data-path="dplyr.html"><a href="dplyr.html#selecting"><i class="fa fa-check"></i><b>4.3</b> Selecting</a><ul>
<li class="chapter" data-level="4.3.1" data-path="dplyr.html"><a href="dplyr.html#selecting-rows-by-index-slice"><i class="fa fa-check"></i><b>4.3.1</b> Selecting rows by index: <code>slice()</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="dplyr.html"><a href="dplyr.html#get-unique-cases-with-distinct"><i class="fa fa-check"></i><b>4.3.2</b> Get unique cases with <code>distinct()</code></a></li>
<li class="chapter" data-level="4.3.3" data-path="dplyr.html"><a href="dplyr.html#filter-cases"><i class="fa fa-check"></i><b>4.3.3</b> <code>filter()</code> cases</a></li>
<li class="chapter" data-level="4.3.4" data-path="dplyr.html"><a href="dplyr.html#selecting-variables-select"><i class="fa fa-check"></i><b>4.3.4</b> Selecting variables: <code>select()</code></a></li>
<li class="chapter" data-level="4.3.5" data-path="dplyr.html"><a href="dplyr.html#renaming-variables-rename"><i class="fa fa-check"></i><b>4.3.5</b> Renaming variables: <code>rename()</code></a></li>
<li class="chapter" data-level="4.3.6" data-path="dplyr.html"><a href="dplyr.html#selecting-from-ranked-data"><i class="fa fa-check"></i><b>4.3.6</b> Selecting from ranked data</a></li>
<li class="chapter" data-level="4.3.7" data-path="dplyr.html"><a href="dplyr.html#extract-a-column-as-vector"><i class="fa fa-check"></i><b>4.3.7</b> Extract a column as vector</a></li>
<li class="chapter" data-level="4.3.8" data-path="dplyr.html"><a href="dplyr.html#sorting-with-arrange"><i class="fa fa-check"></i><b>4.3.8</b> Sorting with <code>arrange()</code></a></li>
<li class="chapter" data-level="4.3.9" data-path="dplyr.html"><a href="dplyr.html#random-sampling"><i class="fa fa-check"></i><b>4.3.9</b> Random sampling</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="dplyr.html"><a href="dplyr.html#adding-and-changing-variables"><i class="fa fa-check"></i><b>4.4</b> Adding and changing variables</a><ul>
<li class="chapter" data-level="4.4.1" data-path="dplyr.html"><a href="dplyr.html#window-functions"><i class="fa fa-check"></i><b>4.4.1</b> Window functions</a></li>
<li class="chapter" data-level="4.4.2" data-path="dplyr.html"><a href="dplyr.html#mutate"><i class="fa fa-check"></i><b>4.4.2</b> Add one or more variables: <code>mutate()</code></a></li>
<li class="chapter" data-level="4.4.3" data-path="dplyr.html"><a href="dplyr.html#create-new-variables-based-on-more-columns"><i class="fa fa-check"></i><b>4.4.3</b> Create new variables based on more columns</a></li>
<li class="chapter" data-level="4.4.4" data-path="dplyr.html"><a href="dplyr.html#change-a-variable-recode-and-recode_factor"><i class="fa fa-check"></i><b>4.4.4</b> Change a variable: <code>recode()</code> and <code>recode_factor()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="dplyr.html"><a href="dplyr.html#operations-on-groups"><i class="fa fa-check"></i><b>4.5</b> Operations on groups</a><ul>
<li class="chapter" data-level="4.5.1" data-path="dplyr.html"><a href="dplyr.html#group_by-and-ungroup"><i class="fa fa-check"></i><b>4.5.1</b> <code>group_by()</code> and <code>ungroup()</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="dplyr.html"><a href="dplyr.html#group_split-and-group_keys"><i class="fa fa-check"></i><b>4.5.2</b> <code>group_split()</code> and <code>group_keys()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="dplyr.html"><a href="dplyr.html#apply-a-function-to-each-group"><i class="fa fa-check"></i><b>4.5.3</b> Apply a function to each group</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="dplyr.html"><a href="dplyr.html#summarizing-and-counting"><i class="fa fa-check"></i><b>4.6</b> Summarizing and counting</a></li>
<li class="chapter" data-level="4.7" data-path="dplyr.html"><a href="dplyr.html#combining-data"><i class="fa fa-check"></i><b>4.7</b> Combining data</a><ul>
<li class="chapter" data-level="4.7.1" data-path="dplyr.html"><a href="dplyr.html#merging"><i class="fa fa-check"></i><b>4.7.1</b> Merging</a></li>
<li class="chapter" data-level="4.7.2" data-path="dplyr.html"><a href="dplyr.html#adding-rows-and-columns"><i class="fa fa-check"></i><b>4.7.2</b> Adding rows and columns</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="date-time.html"><a href="date-time.html"><i class="fa fa-check"></i><b>5</b> Working with date-time data: <code>lubridate</code></a><ul>
<li class="chapter" data-level="5.1" data-path="date-time.html"><a href="date-time.html#current-time"><i class="fa fa-check"></i><b>5.1</b> Current time</a></li>
<li class="chapter" data-level="5.2" data-path="date-time.html"><a href="date-time.html#getting-elements-from-date-time-objects"><i class="fa fa-check"></i><b>5.2</b> Getting elements from date-time objects</a></li>
<li class="chapter" data-level="5.3" data-path="date-time.html"><a href="date-time.html#calculations-with-date-time"><i class="fa fa-check"></i><b>5.3</b> Calculations with date-time</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="stringr.html"><a href="stringr.html"><i class="fa fa-check"></i><b>6</b> Processing text with: <code>stringr</code> and regex</a><ul>
<li class="chapter" data-level="6.1" data-path="stringr.html"><a href="stringr.html#introduction-2"><i class="fa fa-check"></i><b>6.1</b> Introduction</a><ul>
<li class="chapter" data-level="6.1.1" data-path="stringr.html"><a href="stringr.html#a-few-remarks-on-locale"><i class="fa fa-check"></i><b>6.1.1</b> A few remarks on “locale”</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="stringr.html"><a href="stringr.html#review-of-regular-expressions"><i class="fa fa-check"></i><b>6.2</b> Review of regular expressions</a><ul>
<li class="chapter" data-level="6.2.1" data-path="stringr.html"><a href="stringr.html#regex-syntax-elements"><i class="fa fa-check"></i><b>6.2.1</b> Regex syntax elements</a></li>
<li class="chapter" data-level="6.2.2" data-path="stringr.html"><a href="stringr.html#character-classes-and-negation"><i class="fa fa-check"></i><b>6.2.2</b> Character classes and negation</a></li>
<li class="chapter" data-level="6.2.3" data-path="stringr.html"><a href="stringr.html#quantifiers"><i class="fa fa-check"></i><b>6.2.3</b> Quantifiers</a></li>
<li class="chapter" data-level="6.2.4" data-path="stringr.html"><a href="stringr.html#anchoring"><i class="fa fa-check"></i><b>6.2.4</b> Anchoring</a></li>
<li class="chapter" data-level="6.2.5" data-path="stringr.html"><a href="stringr.html#alternatives"><i class="fa fa-check"></i><b>6.2.5</b> Alternatives</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="stringr.html"><a href="stringr.html#the-stringr-essentials"><i class="fa fa-check"></i><b>6.3</b> The <code>stringr</code> essentials</a><ul>
<li class="chapter" data-level="6.3.1" data-path="stringr.html"><a href="stringr.html#case-conversion"><i class="fa fa-check"></i><b>6.3.1</b> Case conversion</a></li>
<li class="chapter" data-level="6.3.2" data-path="stringr.html"><a href="stringr.html#split-join-and-substring"><i class="fa fa-check"></i><b>6.3.2</b> Split, join and substring</a></li>
<li class="chapter" data-level="6.3.3" data-path="stringr.html"><a href="stringr.html#matching"><i class="fa fa-check"></i><b>6.3.3</b> Matching</a></li>
<li class="chapter" data-level="6.3.4" data-path="stringr.html"><a href="stringr.html#extracting-and-replacing"><i class="fa fa-check"></i><b>6.3.4</b> Extracting and replacing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="eda.html"><a href="eda.html"><i class="fa fa-check"></i><b>7</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="eda.html"><a href="eda.html#introduction-3"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="eda.html"><a href="eda.html#getting-to-know-the-dataset"><i class="fa fa-check"></i><b>7.2</b> Getting to know the dataset</a><ul>
<li class="chapter" data-level="7.2.1" data-path="eda.html"><a href="eda.html#the-codebook"><i class="fa fa-check"></i><b>7.2.1</b> The codebook</a></li>
<li class="chapter" data-level="7.2.2" data-path="eda.html"><a href="eda.html#load-and-inspect-the-data"><i class="fa fa-check"></i><b>7.2.2</b> Load and inspect the data</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="eda.html"><a href="eda.html#exploring-variables"><i class="fa fa-check"></i><b>7.3</b> Exploring variables</a><ul>
<li class="chapter" data-level="7.3.1" data-path="eda.html"><a href="eda.html#first-steps"><i class="fa fa-check"></i><b>7.3.1</b> First steps</a></li>
<li class="chapter" data-level="7.3.2" data-path="eda.html"><a href="eda.html#smoking-data-corrupted"><i class="fa fa-check"></i><b>7.3.2</b> Smoking data corrupted?</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="eda.html"><a href="eda.html#variable-engineering"><i class="fa fa-check"></i><b>7.4</b> Variable engineering</a><ul>
<li class="chapter" data-level="7.4.1" data-path="eda.html"><a href="eda.html#recoding-strategies"><i class="fa fa-check"></i><b>7.4.1</b> Recoding strategies</a></li>
<li class="chapter" data-level="7.4.2" data-path="eda.html"><a href="eda.html#factorization"><i class="fa fa-check"></i><b>7.4.2</b> “factorization”</a></li>
<li class="chapter" data-level="7.4.3" data-path="eda.html"><a href="eda.html#data-redundancy-in-std-variables"><i class="fa fa-check"></i><b>7.4.3</b> Data redundancy in STD variables</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="eda.html"><a href="eda.html#the-dependent-variable"><i class="fa fa-check"></i><b>7.5</b> The dependent variable</a></li>
<li class="chapter" data-level="7.6" data-path="eda.html"><a href="eda.html#exploring-relationships-between-variables"><i class="fa fa-check"></i><b>7.6</b> Exploring relationships between variables</a><ul>
<li class="chapter" data-level="7.6.1" data-path="eda.html"><a href="eda.html#the-scatterplot"><i class="fa fa-check"></i><b>7.6.1</b> The scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="eda.html"><a href="eda.html#look-for-patterns-with-the-dependent-variable"><i class="fa fa-check"></i><b>7.7</b> Look for patterns with the dependent variable</a></li>
<li class="chapter" data-level="7.8" data-path="eda.html"><a href="eda.html#density-plots-show-class-distinction"><i class="fa fa-check"></i><b>7.8</b> Density plots show class distinction</a><ul>
<li class="chapter" data-level="7.8.1" data-path="eda.html"><a href="eda.html#the-xor-problem"><i class="fa fa-check"></i><b>7.8.1</b> The ‘xor’ problem</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="eda.html"><a href="eda.html#advanced-explorations"><i class="fa fa-check"></i><b>7.9</b> Advanced Explorations</a><ul>
<li class="chapter" data-level="7.9.1" data-path="eda.html"><a href="eda.html#pca"><i class="fa fa-check"></i><b>7.9.1</b> PCA</a></li>
<li class="chapter" data-level="7.9.2" data-path="eda.html"><a href="eda.html#clustering"><i class="fa fa-check"></i><b>7.9.2</b> Clustering</a></li>
<li class="chapter" data-level="7.9.3" data-path="eda.html"><a href="eda.html#k-means-clustering"><i class="fa fa-check"></i><b>7.9.3</b> k-Means clustering</a></li>
<li class="chapter" data-level="7.9.4" data-path="eda.html"><a href="eda.html#hierarchical-clustering"><i class="fa fa-check"></i><b>7.9.4</b> hierarchical clustering</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="publish.html"><a href="publish.html"><i class="fa fa-check"></i><b>8</b> Publishing, Presenting and Reporting</a><ul>
<li class="chapter" data-level="8.1" data-path="publish.html"><a href="publish.html#introduction-4"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="publish.html"><a href="publish.html#rmarkdown"><i class="fa fa-check"></i><b>8.2</b> RMarkdown</a></li>
<li class="chapter" data-level="8.3" data-path="publish.html"><a href="publish.html#shiny"><i class="fa fa-check"></i><b>8.3</b> Shiny</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>9</b> Exercises</a><ul>
<li class="chapter" data-level="9.1" data-path="exercises.html"><a href="exercises.html#introduction-5"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="exercises.html"><a href="exercises.html#the-ggplot2-and-tidyr-packages"><i class="fa fa-check"></i><b>9.2</b> The <code>ggplot2</code> and <code>tidyr</code> packages</a><ul>
<li class="chapter" data-level="9.2.1" data-path="exercises.html"><a href="exercises.html#trees"><i class="fa fa-check"></i><b>9.2.1</b> Trees</a></li>
<li class="chapter" data-level="9.2.2" data-path="exercises.html"><a href="exercises.html#insect-sprays"><i class="fa fa-check"></i><b>9.2.2</b> Insect Sprays</a></li>
<li class="chapter" data-level="9.2.3" data-path="exercises.html"><a href="exercises.html#diauxic-growth"><i class="fa fa-check"></i><b>9.2.3</b> Diauxic growth</a></li>
<li class="chapter" data-level="9.2.4" data-path="exercises.html"><a href="exercises.html#virginia-death-rates"><i class="fa fa-check"></i><b>9.2.4</b> Virginia Death Rates</a></li>
<li class="chapter" data-level="9.2.5" data-path="exercises.html"><a href="exercises.html#investigate-new-visualization"><i class="fa fa-check"></i><b>9.2.5</b> Investigate new visualization <sup><font size="3em">[❋❋❋]</font></sup></a></li>
<li class="chapter" data-level="9.2.6" data-path="exercises.html"><a href="exercises.html#toothgrowth"><i class="fa fa-check"></i><b>9.2.6</b> ToothGrowth</a></li>
<li class="chapter" data-level="9.2.7" data-path="exercises.html"><a href="exercises.html#puromycin"><i class="fa fa-check"></i><b>9.2.7</b> Puromycin</a></li>
<li class="chapter" data-level="9.2.8" data-path="exercises.html"><a href="exercises.html#global-temperature"><i class="fa fa-check"></i><b>9.2.8</b> Global temperature</a></li>
<li class="chapter" data-level="9.2.9" data-path="exercises.html"><a href="exercises.html#epilepsy-drug-trial"><i class="fa fa-check"></i><b>9.2.9</b> Epilepsy drug trial</a></li>
<li class="chapter" data-level="9.2.10" data-path="exercises.html"><a href="exercises.html#bacterial-growth-curves-with-varioscan"><i class="fa fa-check"></i><b>9.2.10</b> Bacterial growth curves with Varioscan</a></li>
<li class="chapter" data-level="9.2.11" data-path="exercises.html"><a href="exercises.html#the-dinos"><i class="fa fa-check"></i><b>9.2.11</b> The dinos</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="exercises.html"><a href="exercises.html#the-tidyr-and-dplyr-packages"><i class="fa fa-check"></i><b>9.3</b> The <code>tidyr</code> and <code>dplyr</code> packages</a><ul>
<li class="chapter" data-level="9.3.1" data-path="exercises.html"><a href="exercises.html#global-temperature-revisited"><i class="fa fa-check"></i><b>9.3.1</b> Global temperature revisited</a></li>
<li class="chapter" data-level="9.3.2" data-path="exercises.html"><a href="exercises.html#chickweight"><i class="fa fa-check"></i><b>9.3.2</b> ChickWeight</a></li>
<li class="chapter" data-level="9.3.3" data-path="exercises.html"><a href="exercises.html#population-numbers"><i class="fa fa-check"></i><b>9.3.3</b> Population numbers</a></li>
<li class="chapter" data-level="9.3.4" data-path="exercises.html"><a href="exercises.html#rubella-and-measles"><i class="fa fa-check"></i><b>9.3.4</b> Rubella and Measles</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="exercises.html"><a href="exercises.html#the-lubridate-package"><i class="fa fa-check"></i><b>9.4</b> The <code>lubridate</code> package</a><ul>
<li class="chapter" data-level="9.4.1" data-path="exercises.html"><a href="exercises.html#female-births"><i class="fa fa-check"></i><b>9.4.1</b> Female births</a></li>
<li class="chapter" data-level="9.4.2" data-path="exercises.html"><a href="exercises.html#diabetes"><i class="fa fa-check"></i><b>9.4.2</b> Diabetes</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="exercises.html"><a href="exercises.html#the-stringr-package"><i class="fa fa-check"></i><b>9.5</b> The <code>stringr</code> package</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="exercise-solutions.html"><a href="exercise-solutions.html"><i class="fa fa-check"></i><b>10</b> Exercise Solutions</a><ul>
<li class="chapter" data-level="10.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#introduction-6"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#the-ggplot2-and-tidyr-packages-1"><i class="fa fa-check"></i><b>10.2</b> The <code>ggplot2</code> and <code>tidyr</code> packages</a><ul>
<li class="chapter" data-level="10.2.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#trees-1"><i class="fa fa-check"></i><b>10.2.1</b> Trees</a></li>
<li class="chapter" data-level="10.2.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#insect-sprays-1"><i class="fa fa-check"></i><b>10.2.2</b> Insect Sprays</a></li>
<li class="chapter" data-level="10.2.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#diauxic-growth-1"><i class="fa fa-check"></i><b>10.2.3</b> Diauxic growth</a></li>
<li class="chapter" data-level="10.2.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#virginia-death-rates-1"><i class="fa fa-check"></i><b>10.2.4</b> Virginia Death Rates</a></li>
<li class="chapter" data-level="10.2.5" data-path="exercise-solutions.html"><a href="exercise-solutions.html#investigate-new-visualization-1"><i class="fa fa-check"></i><b>10.2.5</b> Investigate new visualization <sup><font size="3em">[❋❋]</font></sup></a></li>
<li class="chapter" data-level="10.2.6" data-path="exercise-solutions.html"><a href="exercise-solutions.html#toothgrowth-1"><i class="fa fa-check"></i><b>10.2.6</b> ToothGrowth</a></li>
<li class="chapter" data-level="10.2.7" data-path="exercise-solutions.html"><a href="exercise-solutions.html#puromycin-1"><i class="fa fa-check"></i><b>10.2.7</b> Puromycin</a></li>
<li class="chapter" data-level="10.2.8" data-path="exercise-solutions.html"><a href="exercise-solutions.html#global-temperature-1"><i class="fa fa-check"></i><b>10.2.8</b> Global temperature</a></li>
<li class="chapter" data-level="10.2.9" data-path="exercise-solutions.html"><a href="exercise-solutions.html#epilepsy-drug-trial-1"><i class="fa fa-check"></i><b>10.2.9</b> Epilepsy drug trial</a></li>
<li class="chapter" data-level="10.2.10" data-path="exercise-solutions.html"><a href="exercise-solutions.html#bacterial-growth-curves-with-varioscan-1"><i class="fa fa-check"></i><b>10.2.10</b> Bacterial growth curves with Varioscan</a></li>
<li class="chapter" data-level="10.2.11" data-path="exercise-solutions.html"><a href="exercise-solutions.html#the-dinos-1"><i class="fa fa-check"></i><b>10.2.11</b> The dinos</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#the-tidyr-and-dplyr-packages-1"><i class="fa fa-check"></i><b>10.3</b> The <code>tidyr</code> and <code>dplyr</code> packages</a><ul>
<li class="chapter" data-level="10.3.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#global-temperature-revisited-1"><i class="fa fa-check"></i><b>10.3.1</b> Global temperature revisited</a></li>
<li class="chapter" data-level="10.3.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#chickweight-1"><i class="fa fa-check"></i><b>10.3.2</b> ChickWeight</a></li>
<li class="chapter" data-level="10.3.3" data-path="exercise-solutions.html"><a href="exercise-solutions.html#population-numbers-1"><i class="fa fa-check"></i><b>10.3.3</b> Population numbers</a></li>
<li class="chapter" data-level="10.3.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#rubella-and-measles-1"><i class="fa fa-check"></i><b>10.3.4</b> Rubella and Measles</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="exercise-solutions.html"><a href="exercise-solutions.html#the-lubridate-package-1"><i class="fa fa-check"></i><b>10.4</b> The <code>lubridate</code> package</a><ul>
<li class="chapter" data-level="10.4.1" data-path="exercise-solutions.html"><a href="exercise-solutions.html#female-births-1"><i class="fa fa-check"></i><b>10.4.1</b> Female births</a></li>
<li class="chapter" data-level="10.4.2" data-path="exercise-solutions.html"><a href="exercise-solutions.html#diabetes-1"><i class="fa fa-check"></i><b>10.4.2</b> Diabetes</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="exercise-solutions.html"><a href="exercise-solutions.html#the-stringr-package-1"><i class="fa fa-check"></i><b>10.5</b> The <code>stringr</code> package</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="parsing-complex-data.html"><a href="parsing-complex-data.html"><i class="fa fa-check"></i><b>11</b> Parsing complex data</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis and Visualization using R (2)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggplot2" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> The <code>ggplot2</code> package</h1>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">1.1</span> Introduction</h2>
<p>In this chapter, we’ll explore the package <code>ggplot2</code>. Package ggplot2 is one of the most popular packages of R, and a de facto standard for creating publishable visualizations.</p>
<p>Whole books have been written about ggplot2 (e.g. [INSERT REF]); these will not be repeated here. Instead, I have selected the minimal amount of information and examples to get you going in your own research visualization endeavors in biomedical research. For that reason, this chapter only deals with the base <code>ggplot()</code> function and its most important usage scenarios.<br />
In my opinion, you are best prepared when first learning the ggplot “language” structure, not the complete listing of possibilities. You can check these out later on your own. If you are interested in what the package has to offer, type <code>help(package="ggplot2")</code> on the console.</p>
<div id="keep-the-goal-in-mind" class="section level3 unnumbered">
<h3>Keep the goal in mind</h3>
<p>You should always remember the purpose with which you create a plot:</p>
<ol style="list-style-type: decimal">
<li><strong><em>Communicate results in a visual way</em></strong>. The <em>audience</em> consists of other professionals: fellow scientists, students, project managers, CEO’s. The <em>scope</em> is in reports, publications, presentations etc. Your plots should be immaculately annotated - have a title and/or caption, axis labels with physical quantities (e.g. Temperature) and measurement units (e.g. Celsius), and a legend (if relevant).</li>
<li><strong><em>Create a representation of data for visual inspection</em></strong>. The <em>audience</em> is yourself. This is especially important in Exploratory Data Analysis (EDA). You visualize your data in order to discover patterns, trends, outliers and to generate new questions and hypotheses. The biggest challenge is to select the correct, most appropriate visualization that keeps you moving on your research track.</li>
</ol>
<p>Besides this, you should of course choose a relevant visualization for your data. For instance, generating a boxplot representing only a few data points is a poor choice, as will a scatterplot for millions of data points almost always be.</p>
<p>To help your imagination and see what is possible you should really browse through <a href="https://www.r-graph-gallery.com/">The R Graph Gallery</a>. It has code for all the charts in the gallery.</p>
</div>
</div>
<div id="getting-started" class="section level2">
<h2><span class="header-section-number">1.2</span> Getting started</h2>
<p>Install the packages <code>ggplot2</code> and <code>tidyr</code> first, if not already installed. The package ggplot2 is the topic of this chapter of course. Package tidyr is the topic of a later chapter, but we’ll see a use case of it here already.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="ggplot2.html#cb1-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb1-2"><a href="ggplot2.html#cb1-2"></a><span class="kw">install.packages</span>(<span class="st">&quot;tidyr&quot;</span>)</span></code></pre></div>
<p>After installing, you’ll need to load the packages.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="ggplot2.html#cb2-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb2-2"><a href="ggplot2.html#cb2-2"></a><span class="kw">library</span>(tidyr)</span></code></pre></div>
<div id="a-first-plot" class="section level3 unnumbered">
<h3>A first plot</h3>
<p>Let’s dive right in and create a first plot, and walk through the different parts of this code.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="ggplot2.html#cb3-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> airquality, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Temp, <span class="dt">y =</span> Ozone)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb3-2"><a href="ggplot2.html#cb3-2"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 37 rows containing missing values (geom_point).</code></pre>
<div class="figure" style="text-align: center"><span id="fig:first-plot"></span>
<img src="bookdown-demo_files/figure-html/first-plot-1.png" alt="A scatter plot visualizing Ozone as a function of Temperature" width="80%" />
<p class="caption">
Figure 1.1: A scatter plot visualizing Ozone as a function of Temperature
</p>
</div>
<p>There are two <strong><em>chained function calls</em></strong>: <code>ggplot()</code> and <code>geom_point()</code>. They are chained using the <code>+</code> operator. The first function, <code>ggplot()</code>, creates the base layer of the plot It receives the data and defines how it maps to the two axes. By itself, <code>ggplot()</code>, will not display anything of your data. It creates an empty plot where the axes are defined and have the correct scale:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="ggplot2.html#cb5-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> airquality, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Temp, <span class="dt">y =</span> Ozone))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:empty-plot"></span>
<img src="bookdown-demo_files/figure-html/empty-plot-1.png" alt="An empty plot pane" width="80%" />
<p class="caption">
Figure 1.2: An empty plot pane
</p>
</div>
<p>The next function, <code>geom_point()</code>, builds on the base layer it receives via the <code>+</code> operator and adds a new layer to the plot, a data representation using points.</p>
<p>The <code>geom_point()</code> function encounters rows with missing data and issues a warning (<code>Warning: Removed 37 rows...</code>) but proceeds anyway. There are two ways to prevent this annoying warning message. The first is to put a <code>warning=FALSE</code> statement in the RMarkdown chunk header. This is usually <strong>not</strong> a good idea because you should be explicit about problem handling when implementing a data analysis workflow because it hinders the reproducibility of your work. Therefore, removing the missing values explicitly is a better solution:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="ggplot2.html#cb6-1"></a>airquality &lt;-<span class="st"> </span><span class="kw">na.omit</span>(airquality)</span>
<span id="cb6-2"><a href="ggplot2.html#cb6-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> airquality, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Temp, <span class="dt">y =</span> Ozone)) <span class="op">+</span></span>
<span id="cb6-3"><a href="ggplot2.html#cb6-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p>Note that this overwrites the build-in dataset <code>airquality</code> for the duration of this R session.</p>
<p>To obtain a similar plot as created above with “base” R, you would have done something like this:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="ggplot2.html#cb7-1"></a><span class="kw">with</span>(airquality, <span class="kw">plot</span>(<span class="dt">x =</span> Temp, <span class="dt">y =</span> Ozone))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:first-plot-baseR"></span>
<img src="bookdown-demo_files/figure-html/first-plot-baseR-1.png" alt="The same visualization with base R" width="80%" />
<p class="caption">
Figure 1.3: The same visualization with base R
</p>
</div>
<p>You can immediately see why ggplot2 has become so popular. When creating more complex plots it becomes more obvious still, as shown below.</p>
</div>
<div id="adding-a-dimension-using-color" class="section level3 unnumbered">
<h3>Adding a dimension using color</h3>
<p>This plot shows the power of ggplot2: building complex visualizations with minimal code.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="ggplot2.html#cb8-1"></a>airquality<span class="op">$</span>Month &lt;-<span class="st"> </span><span class="kw">as.factor</span>(airquality<span class="op">$</span>Month)</span>
<span id="cb8-2"><a href="ggplot2.html#cb8-2"></a>airquality<span class="op">$</span>TempFac &lt;-<span class="st"> </span><span class="kw">cut</span>(airquality<span class="op">$</span>Temp, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>), <span class="dt">ordered_result =</span> T)</span>
<span id="cb8-3"><a href="ggplot2.html#cb8-3"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> airquality, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Temp, <span class="dt">y =</span> Ozone, <span class="dt">color=</span>Month)) <span class="op">+</span></span>
<span id="cb8-4"><a href="ggplot2.html#cb8-4"></a><span class="st">  </span><span class="kw">geom_point</span>() </span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:first-plot-w-color1"></span>
<img src="bookdown-demo_files/figure-html/first-plot-w-color1-1.png" alt="Ozone as function of Temp with plot symbols colored by Month" width="80%" />
<p class="caption">
Figure 1.4: Ozone as function of Temp with plot symbols colored by Month
</p>
</div>
</div>
<div id="inspecting-and-tuning-the-figure" class="section level3 unnumbered">
<h3>Inspecting and tuning the figure</h3>
<p>What can you tell about the data and its measurements when looking at this plot?</p>
<p>Looking at the above plot, you should notice that</p>
<ol style="list-style-type: lower-alpha">
<li>the temperature measurement is probably in degrees Fahrenheit. This should be apparent from the plot. The measurement unit for Ozone is missing. You should look both up; the <code>datasets</code> package doc says it is in Parts Per Billion (ppb).<br />
</li>
<li>temperature is lowest in the fifth month -probably May but once again you should make certain- and highest in months 8 and 9.</li>
<li>ozone levels seem positively correlated with temperature (or Month), but not in an obvious linear way</li>
<li>a detail: temperature is measured in whole degrees only. This will give plotting artifacts: discrete vertical lines of data points.</li>
</ol>
<p>The plot below fixes and addresses the above issues to create a publication-ready figure. We’ll get to the details of this code as we proceed in this chapter. For now the message is <strong><em>be meticulous in constructing your plot</em></strong>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="ggplot2.html#cb9-1"></a>airquality<span class="op">$</span>Month &lt;-<span class="st"> </span><span class="kw">factor</span>(airquality<span class="op">$</span>Month, <span class="dt">levels=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">labels=</span>month.abb)</span>
<span id="cb9-2"><a href="ggplot2.html#cb9-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> airquality, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>Temp, <span class="dt">y=</span>Ozone)) <span class="op">+</span></span>
<span id="cb9-3"><a href="ggplot2.html#cb9-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">color=</span>Month)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-4"><a href="ggplot2.html#cb9-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;loess&quot;</span>) <span class="op">+</span></span>
<span id="cb9-5"><a href="ggplot2.html#cb9-5"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="st">&quot;Temperature &quot;</span> (degree<span class="op">~</span>F))) <span class="op">+</span></span>
<span id="cb9-6"><a href="ggplot2.html#cb9-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Ozone (ppb)&quot;</span>) <span class="op">+</span></span>
<span id="cb9-7"><a href="ggplot2.html#cb9-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">color=</span><span class="st">&quot;Month&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<div class="figure" style="text-align: center"><span id="fig:first-plot-w-color2"></span>
<img src="bookdown-demo_files/figure-html/first-plot-w-color2-1.png" alt="Ozone level dependency on Temperature. Grey area: Loess smoother with 95% confidence interval. Source: R dataset &quot;Daily air quality measurements in New York, May to September 1973.&quot;" width="80%" />
<p class="caption">
Figure 1.5: Ozone level dependency on Temperature. Grey area: Loess smoother with 95% confidence interval. Source: R dataset “Daily air quality measurements in New York, May to September 1973.”
</p>
</div>
</div>
</div>
<div id="ggplot2-and-the-theory-of-graphics" class="section level2">
<h2><span class="header-section-number">1.3</span> ggplot2 and the theory of graphics</h2>
<div id="philosophy-of-ggplot2" class="section level3 unnumbered">
<h3>Philosophy of ggplot2</h3>
<p>The author of ggplot2, Hadley Wickham, had a very clear goal in mind when he embarked on the development of this package:</p>
<p><em>“The emphasis in ggplot2 is reducing the amount of thinking time by making it easier to go from the plot in your brain to the plot on the page.” (Wickham, 2012)</em></p>
<p>The way this is achieved is through “<strong><em>The grammar of graphics</em></strong>”</p>
</div>
<div id="the-grammar-of-graphics" class="section level3 unnumbered">
<h3>The grammar of graphics</h3>
<p>The grammar of graphics tells us that a statistical graphic is a mapping from data to geometric objects (points, lines, bars) with aesthetic attributes (color, shape, size).</p>
<p>The plot may also contain statistical transformations of the data and is drawn on a specific coordinate system. Faceting -grid layout- can be used to generate the same plot for different subsets of the dataset.
(Wickham, 2010)</p>
</div>
</div>
<div id="building-plots-with-ggplot2" class="section level2">
<h2><span class="header-section-number">1.4</span> Building plots with ggplot2</h2>
<div id="the-layered-plot-architecture" class="section level3 unnumbered">
<h3>The layered plot architecture</h3>
<p>A graph in ggplot2 is built using a few “layers”, or building blocks.</p>
<table>
<caption><span id="tab:ggplot2-building-blocks-1">Table 1.1: </span>The three core ggplot2 layers</caption>
<thead>
<tr class="header">
<th align="left">ggplot2</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">data=</td>
<td align="left">the data that you want to plot</td>
</tr>
<tr class="even">
<td align="left">aes()</td>
<td align="left">mappings of data to position (axes), colors, sizes</td>
</tr>
<tr class="odd">
<td align="left">geom_…..()</td>
<td align="left">shapes (geometries) that will represent the data</td>
</tr>
</tbody>
</table>
<p>First, there is the <strong><em>data</em></strong> layer - the input data that you want to visualize:</p>
<div class="figure">
<img src="graphics/data_layer_50p.png#center" alt="" />
<p class="caption">The data layer</p>
</div>
<p>Next, using the <code>aes()</code> function, the data is <strong><em>mapped</em></strong> to a coordinate system. This encompasses not only the xy-coordinates but also possible extra plot dimensions such as color and shape.</p>
<div class="figure">
<img src="graphics/data_aes_layers_50p.png#center" alt="" />
<p class="caption">The data and aesthetic layers</p>
</div>
<p>As a third step, the data is <strong><em>visually represented</em></strong> in some way, using a <strong><em>geometry</em></strong> (dealt with by one of the many <code>geom_....()</code> functions). Examples of geometries are <strong><em>point</em></strong> for scatterplots, <strong><em>boxplot</em></strong>, <strong><em>line</em></strong> etc.</p>
<div class="figure">
<img src="graphics/data_aes_geom_layers_50p.png#center" alt="" />
<p class="caption">The data, aesthetic and geometry layers</p>
</div>
<p>At a minimum, these three layers are used in every plot you create.</p>
<p>Besides these fundamental aspects there are other elements you may wish to add or modify: axis labels, legend, titles, etc. These constitute additional, optional layers:</p>
<div class="figure">
<img src="graphics/all_layers_50p.png#center" alt="" />
<p class="caption">All layers</p>
</div>
<p>Except for Statistics and Coordinates, each of these layers will be discussed in detail in subsequent paragraphs.</p>
</div>
<div id="tidy-the-data" class="section level3 unnumbered">
<h3>“Tidy” the data</h3>
<p>This is a very important aspect of plotting using ggplot2: getting the data in a way that ggplot2 can deal with it. Sometimes it may be a bit challenging to get the data in such a format: some form of data mangling is often required. This is the topic of a next chapter, but here you’ll already see a little preview.</p>
<p>The ggplot2 function expects its data to come in a <strong><em>tidy</em></strong> format. A dataset is considered <strong><em>tidy</em></strong> when it is formed according to these rules:</p>
<ol style="list-style-type: decimal">
<li>Each variable has its own column.</li>
<li>Each observation has its own row.</li>
<li>Each value has its own cell.</li>
</ol>
<p>Want to know more about tidy data? Read the paper by Hadley Wickham: <span class="citation">(Wickham <a href="#ref-tidy-data" role="doc-biblioref">2014</a>)</span>.</p>
<p>Here is an example dataset that requires some mangling, or <strong><em>tidying</em></strong>, to adhere to these rules.</p>
<table>
<thead>
<tr class="header">
<th align="left">patient</th>
<th align="left">sex</th>
<th align="right">dose10mg</th>
<th align="right">dose100mg</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">001</td>
<td align="left">f</td>
<td align="right">12</td>
<td align="right">88</td>
</tr>
<tr class="even">
<td align="left">002</td>
<td align="left">f</td>
<td align="right">11</td>
<td align="right">54</td>
</tr>
<tr class="odd">
<td align="left">003</td>
<td align="left">m</td>
<td align="right">54</td>
<td align="right">14</td>
</tr>
<tr class="even">
<td align="left">004</td>
<td align="left">m</td>
<td align="right">71</td>
<td align="right">21</td>
</tr>
<tr class="odd">
<td align="left">005</td>
<td align="left">f</td>
<td align="right">19</td>
<td align="right">89</td>
</tr>
</tbody>
</table>
<p>This dataset is not tidy because there is an independent variable -the dose- that should have its own column; its value is now buried inside two column headers (<code>dose10mg</code> and <code>dose10mg</code>). Also, there is actually a single variable -the response- that is now split into two columns. Thus, a row now contains two observations.</p>
<p>Suppose you want to plot the response as a function of the dose. That is not quite possible right now in ggplot2. This is because you want to do something like</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="ggplot2.html#cb11-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>dose_response,</span>
<span id="cb11-2"><a href="ggplot2.html#cb11-2"></a>       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&lt;I want to get the dose levels here&gt;&quot;</span>,</span>
<span id="cb11-3"><a href="ggplot2.html#cb11-3"></a>                     <span class="dt">y =</span> <span class="st">&quot;&lt;I want to get the response here&gt;&quot;</span>)) <span class="op">+</span></span>
<span id="cb11-4"><a href="ggplot2.html#cb11-4"></a><span class="st">    </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p>The problem is you cannot <strong><em>specify the mapping in a straightforward manner</em></strong>.
Note that in base R you would probably do this:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="ggplot2.html#cb12-1"></a><span class="kw">boxplot</span>(dose_response<span class="op">$</span>dose10mg, dose_response<span class="op">$</span>dose100mg)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-with-untidy-data"></span>
<img src="bookdown-demo_files/figure-html/plot-with-untidy-data-1.png" alt="Selecting untidy data" width="80%" />
<p class="caption">
Figure 1.6: Selecting untidy data
</p>
</div>
<p>So, we need to tidy this dataframe since the <code>dose_10_response</code> and <code>dose_100_response</code> columns actually describe the same variable (measurement) but with different <em>conditions</em>. As an exercise, I tried it using base R. Here is my solution.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="ggplot2.html#cb13-1"></a>tidy_my_df &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</span>
<span id="cb13-2"><a href="ggplot2.html#cb13-2"></a>    create_tidy_columns &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb13-3"><a href="ggplot2.html#cb13-3"></a>        <span class="kw">data.frame</span>(<span class="dt">patient =</span> <span class="kw">rep</span>(x[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb13-4"><a href="ggplot2.html#cb13-4"></a>                   <span class="dt">sex =</span> <span class="kw">rep</span>(x[<span class="dv">2</span>], <span class="dv">2</span>),</span>
<span id="cb13-5"><a href="ggplot2.html#cb13-5"></a>                   <span class="dt">dose =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">100</span>),</span>
<span id="cb13-6"><a href="ggplot2.html#cb13-6"></a>                   <span class="dt">response =</span> <span class="kw">c</span>(x[<span class="dv">3</span>], x[<span class="dv">4</span>]))</span>
<span id="cb13-7"><a href="ggplot2.html#cb13-7"></a>    }</span>
<span id="cb13-8"><a href="ggplot2.html#cb13-8"></a>    </span>
<span id="cb13-9"><a href="ggplot2.html#cb13-9"></a>    tmp &lt;-<span class="st"> </span><span class="kw">Reduce</span>(<span class="cf">function</span>(x, y) <span class="kw">merge</span>(x, y, <span class="dt">all=</span><span class="ot">TRUE</span>), </span>
<span id="cb13-10"><a href="ggplot2.html#cb13-10"></a>           <span class="kw">apply</span>(<span class="dt">X =</span> df, <span class="dt">MARGIN =</span> <span class="dv">1</span>, <span class="dt">FUN =</span> create_tidy_columns))</span>
<span id="cb13-11"><a href="ggplot2.html#cb13-11"></a>    tmp[<span class="kw">order</span>(tmp<span class="op">$</span>dose), ]</span>
<span id="cb13-12"><a href="ggplot2.html#cb13-12"></a>}</span>
<span id="cb13-13"><a href="ggplot2.html#cb13-13"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(<span class="kw">tidy_my_df</span>(dose_response), <span class="dt">n=</span><span class="dv">10</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">patient</th>
<th align="left">sex</th>
<th align="right">dose</th>
<th align="left">response</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">001</td>
<td align="left">f</td>
<td align="right">10</td>
<td align="left">12</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">002</td>
<td align="left">f</td>
<td align="right">10</td>
<td align="left">11</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">003</td>
<td align="left">m</td>
<td align="right">10</td>
<td align="left">54</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">004</td>
<td align="left">m</td>
<td align="right">10</td>
<td align="left">71</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="left">005</td>
<td align="left">f</td>
<td align="right">10</td>
<td align="left">19</td>
</tr>
<tr class="even">
<td align="left">11</td>
<td align="left">006</td>
<td align="left">f</td>
<td align="right">10</td>
<td align="left">22</td>
</tr>
<tr class="odd">
<td align="left">13</td>
<td align="left">007</td>
<td align="left">f</td>
<td align="right">10</td>
<td align="left">23</td>
</tr>
<tr class="even">
<td align="left">15</td>
<td align="left">008</td>
<td align="left">m</td>
<td align="right">10</td>
<td align="left">68</td>
</tr>
<tr class="odd">
<td align="left">17</td>
<td align="left">009</td>
<td align="left">f</td>
<td align="right">10</td>
<td align="left">30</td>
</tr>
<tr class="even">
<td align="left">19</td>
<td align="left">010</td>
<td align="left">m</td>
<td align="right">10</td>
<td align="left">83</td>
</tr>
</tbody>
</table>
<p>Luckily, there is a very nice package that makes this quite easy: <code>tidyr</code>.</p>
<div id="tidying-data-using-tidyrgather" class="section level4 unnumbered">
<h4>Tidying data using <code>tidyr::gather()</code></h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="ggplot2.html#cb14-1"></a><span class="co">## tidy</span></span>
<span id="cb14-2"><a href="ggplot2.html#cb14-2"></a>dose_response_tidy &lt;-<span class="st"> </span><span class="kw">gather</span>(<span class="dt">data=</span>dose_response, </span>
<span id="cb14-3"><a href="ggplot2.html#cb14-3"></a>                             <span class="dt">key=</span>dose, </span>
<span id="cb14-4"><a href="ggplot2.html#cb14-4"></a>                             <span class="dt">value=</span>response, </span>
<span id="cb14-5"><a href="ggplot2.html#cb14-5"></a>                             <span class="st">&quot;dose10mg&quot;</span>, <span class="st">&quot;dose100mg&quot;</span>)</span>
<span id="cb14-6"><a href="ggplot2.html#cb14-6"></a><span class="co">## transform dose column to nice factor</span></span>
<span id="cb14-7"><a href="ggplot2.html#cb14-7"></a>dose_response_tidy<span class="op">$</span>dose &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">ifelse</span>(</span>
<span id="cb14-8"><a href="ggplot2.html#cb14-8"></a>    dose_response_tidy<span class="op">$</span>dose <span class="op">==</span><span class="st"> &quot;dose10mg&quot;</span>, <span class="dv">10</span>, <span class="dv">100</span>), </span>
<span id="cb14-9"><a href="ggplot2.html#cb14-9"></a>  <span class="dt">ordered =</span> T)</span>
<span id="cb14-10"><a href="ggplot2.html#cb14-10"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(dose_response_tidy, <span class="dt">n=</span><span class="dv">10</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">patient</th>
<th align="left">sex</th>
<th align="left">dose</th>
<th align="right">response</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">001</td>
<td align="left">f</td>
<td align="left">10</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="left">002</td>
<td align="left">f</td>
<td align="left">10</td>
<td align="right">11</td>
</tr>
<tr class="odd">
<td align="left">003</td>
<td align="left">m</td>
<td align="left">10</td>
<td align="right">54</td>
</tr>
<tr class="even">
<td align="left">004</td>
<td align="left">m</td>
<td align="left">10</td>
<td align="right">71</td>
</tr>
<tr class="odd">
<td align="left">005</td>
<td align="left">f</td>
<td align="left">10</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td align="left">006</td>
<td align="left">f</td>
<td align="left">10</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="left">007</td>
<td align="left">f</td>
<td align="left">10</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="left">008</td>
<td align="left">m</td>
<td align="left">10</td>
<td align="right">68</td>
</tr>
<tr class="odd">
<td align="left">009</td>
<td align="left">f</td>
<td align="left">10</td>
<td align="right">30</td>
</tr>
<tr class="even">
<td align="left">010</td>
<td align="left">m</td>
<td align="left">10</td>
<td align="right">83</td>
</tr>
</tbody>
</table>
<p>The data is tidy now, and ready for use within ggplot2.</p>
<p>We’ll explore the <code>gather()</code> function in detail in a next chapter.</p>
<p>Now, creating the plot in ggplot2 is a breeze</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="ggplot2.html#cb15-1"></a>dr_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dose_response_tidy, <span class="kw">aes</span>(<span class="dt">x =</span> dose, <span class="dt">y =</span> response))</span>
<span id="cb15-2"><a href="ggplot2.html#cb15-2"></a>dr_plot <span class="op">+</span><span class="st"> </span></span>
<span id="cb15-3"><a href="ggplot2.html#cb15-3"></a><span class="st">    </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/plot-tidy-basic-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Would you proceed with this hypothetical drug?</p>
</div>
</div>
</div>
<div id="aesthetics" class="section level2">
<h2><span class="header-section-number">1.5</span> Aesthetics</h2>
<p>After you obtain a tidy dataset and pass it to ggplot you must decide what the aesthetics are. This defines the way the data are represented in your plot. Very roughly speaking, you could correlate the aesthetics to the <strong><em>dimensions</em></strong> of the data you want to visualize. For instance, given this chapters’ first example of the airquality dataset, the aesthetics were defined in three “dimensions”:</p>
<ul>
<li>dimension “X” for temperature,</li>
<li>dimension “Y” for Ozone</li>
<li>dimension “color” for the month.</li>
</ul>
<p>Although color is used most often to represent an extra dimension in the data, other aesthetics you may consider are shape, size, line width and line type.</p>
<div id="colors" class="section level3 unnumbered">
<h3>Colors</h3>
<p>Colors can be defined in a variety of ways:</p>
<ul>
<li>color name</li>
<li>existing color palette</li>
<li>custom color palette</li>
</ul>
<p>Below is a panel displaying all named colors you can use in R</p>
<p><img src="bookdown-demo_files/figure-html/color-names-1.png" width="100%" /></p>
<p>When you provide a literal (character) for the color aesthetic it will simply be that color. If you want to map a property (e.g. “Month”) to a range of colors, you should use a color palette. Since ggplot has build-in color palettes, you can simply use <code>color=&lt;my-third-dimension-variable&gt;</code>. This variable mapping to color can be either a factor (discrete scale) or numeric (continuous scale).
The ggplot function will map the variable the default color palette.</p>
<p>Here are some ways to work with color palettes</p>
<div id="the-default-palette" class="section level4 unnumbered">
<h4>The default palette</h4>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="ggplot2.html#cb16-1"></a>sp &lt;-<span class="st"> </span><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(Sepal.Length, Sepal.Width)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Species))</span>
<span id="cb16-2"><a href="ggplot2.html#cb16-2"></a>sp</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/color-palette-default-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="manual-palettes" class="section level4 unnumbered">
<h4>Manual palettes</h4>
<p>You can specify your own colors using <code>scale_color_manual()</code> for scatter plots or <code>scale_fill_manual()</code> for boxplots and bar plots.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="ggplot2.html#cb17-1"></a>sp <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/color-palette-manual-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Here is a nice set of colors:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="ggplot2.html#cb18-1"></a>custom_col &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#FFDB6D&quot;</span>, <span class="st">&quot;#C4961A&quot;</span>, <span class="st">&quot;#F4EDCA&quot;</span>, </span>
<span id="cb18-2"><a href="ggplot2.html#cb18-2"></a>                <span class="st">&quot;#D16103&quot;</span>, <span class="st">&quot;#C3D7A4&quot;</span>, <span class="st">&quot;#52854C&quot;</span>, <span class="st">&quot;#4E84C4&quot;</span>, <span class="st">&quot;#293352&quot;</span>)</span>
<span id="cb18-3"><a href="ggplot2.html#cb18-3"></a><span class="kw">show_palette</span>(custom_col, <span class="dt">cols=</span><span class="kw">length</span>(custom_col))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/custom-palette1-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Here is a colorblind-friendly palette:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="ggplot2.html#cb19-1"></a><span class="co"># The palette with grey:</span></span>
<span id="cb19-2"><a href="ggplot2.html#cb19-2"></a>cbp1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#999999&quot;</span>, <span class="st">&quot;#E69F00&quot;</span>, <span class="st">&quot;#56B4E9&quot;</span>, <span class="st">&quot;#009E73&quot;</span>,</span>
<span id="cb19-3"><a href="ggplot2.html#cb19-3"></a>          <span class="st">&quot;#F0E442&quot;</span>, <span class="st">&quot;#0072B2&quot;</span>, <span class="st">&quot;#D55E00&quot;</span>, <span class="st">&quot;#CC79A7&quot;</span>)</span>
<span id="cb19-4"><a href="ggplot2.html#cb19-4"></a></span>
<span id="cb19-5"><a href="ggplot2.html#cb19-5"></a><span class="kw">show_palette</span>(cbp1, <span class="dt">cols=</span><span class="kw">length</span>(cbp1))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/custom-palette2-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>When you pass a palette that is longer than the number of levels in your factor, R will only use as many as required:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="ggplot2.html#cb20-1"></a>sp <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> cbp1)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/color-palette-manual2-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="rcolorbrewer-palettes" class="section level4 unnumbered">
<h4>RColorBrewer palettes</h4>
<p>R provides the “RColorBrewer” package. The <code>brewer.pal</code> function has several palettes for various applications at your disposal. Have a look at <code>brewer.pal.info</code>, which lists all:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="ggplot2.html#cb21-1"></a><span class="kw">library</span>(RColorBrewer)</span>
<span id="cb21-2"><a href="ggplot2.html#cb21-2"></a>knitr<span class="op">::</span><span class="kw">kable</span>(brewer.pal.info)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">maxcolors</th>
<th align="left">category</th>
<th align="left">colorblind</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">BrBG</td>
<td align="right">11</td>
<td align="left">div</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">PiYG</td>
<td align="right">11</td>
<td align="left">div</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">PRGn</td>
<td align="right">11</td>
<td align="left">div</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">PuOr</td>
<td align="right">11</td>
<td align="left">div</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">RdBu</td>
<td align="right">11</td>
<td align="left">div</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">RdGy</td>
<td align="right">11</td>
<td align="left">div</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">RdYlBu</td>
<td align="right">11</td>
<td align="left">div</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">RdYlGn</td>
<td align="right">11</td>
<td align="left">div</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">Spectral</td>
<td align="right">11</td>
<td align="left">div</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">Accent</td>
<td align="right">8</td>
<td align="left">qual</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">Dark2</td>
<td align="right">8</td>
<td align="left">qual</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">Paired</td>
<td align="right">12</td>
<td align="left">qual</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">Pastel1</td>
<td align="right">9</td>
<td align="left">qual</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">Pastel2</td>
<td align="right">8</td>
<td align="left">qual</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">Set1</td>
<td align="right">9</td>
<td align="left">qual</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">Set2</td>
<td align="right">8</td>
<td align="left">qual</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">Set3</td>
<td align="right">12</td>
<td align="left">qual</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">Blues</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">BuGn</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">BuPu</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">GnBu</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">Greens</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">Greys</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">Oranges</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">OrRd</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">PuBu</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">PuBuGn</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">PuRd</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">Purples</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">RdPu</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">Reds</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">YlGn</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">YlGnBu</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">YlOrBr</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">YlOrRd</td>
<td align="right">9</td>
<td align="left">seq</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>For instance, here is <code>Pastel2</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="ggplot2.html#cb22-1"></a><span class="kw">show_palette</span>(<span class="kw">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&quot;Pastel2&quot;</span>), <span class="dt">cols =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/rcolorbrewer-pastel-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Here, an RColorBrewer palette is used with the Iris data.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="ggplot2.html#cb23-1"></a><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(Sepal.Length, Sepal.Width)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb23-2"><a href="ggplot2.html#cb23-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Species)) <span class="op">+</span></span>
<span id="cb23-3"><a href="ggplot2.html#cb23-3"></a><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values=</span><span class="kw">brewer.pal</span>(<span class="dv">6</span>, <span class="st">&quot;Dark2&quot;</span>)) <span class="co">#only 3 required</span></span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/rcolorbrewer-palette-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="shapes" class="section level3 unnumbered">
<h3>Shapes</h3>
<p>These are the shapes available in ggplot2 (and base R as well).</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="ggplot2.html#cb24-1"></a>shapes &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb24-2"><a href="ggplot2.html#cb24-2"></a>  <span class="dt">shape =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">19</span>, <span class="dv">22</span>, <span class="dv">21</span>, <span class="dv">24</span>, <span class="dv">23</span>, <span class="dv">20</span>),</span>
<span id="cb24-3"><a href="ggplot2.html#cb24-3"></a>  <span class="dt">x =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">24</span> <span class="op">%/%</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb24-4"><a href="ggplot2.html#cb24-4"></a>  <span class="dt">y =</span> <span class="op">-</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">24</span> <span class="op">%%</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb24-5"><a href="ggplot2.html#cb24-5"></a>)</span>
<span id="cb24-6"><a href="ggplot2.html#cb24-6"></a><span class="kw">ggplot</span>(shapes, <span class="kw">aes</span>(x, y)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-7"><a href="ggplot2.html#cb24-7"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape =</span> shape), <span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb24-8"><a href="ggplot2.html#cb24-8"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> shape), <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">nudge_x =</span> <span class="fl">0.15</span>) <span class="op">+</span></span>
<span id="cb24-9"><a href="ggplot2.html#cb24-9"></a><span class="st">  </span><span class="kw">scale_shape_identity</span>() <span class="op">+</span></span>
<span id="cb24-10"><a href="ggplot2.html#cb24-10"></a><span class="st">  </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="fl">4.1</span>) <span class="op">+</span></span>
<span id="cb24-11"><a href="ggplot2.html#cb24-11"></a><span class="st">  </span><span class="kw">theme_void</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/shapes-overview,-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Warning: do not clutter your plot with too many dimensions/aesthetics!</p>
</div>
<div id="lines" class="section level3 unnumbered">
<h3>Lines</h3>
<p>Geoms that draw lines have a “linetype” parameter.</p>
<p>Legal values are the strings “blank”, “solid”, “dashed”, “dotted”, “dotdash”, “longdash”, and “twodash”. Alternatively, the numbers 0 to 6 can be used (0 for “blank”, 1 for “solid”, …).</p>
<p>You can set line type to a constant value. For this you use the linetype geom parameter. For instance, <code>geom_line(data=d, mapping=aes(x=x, y=y), linetype=3)</code> sets the line type of all lines in that layer to 3, which corresponds to a dotted line), but you can also use it dynamically.</p>
<p>Here is an example where the female and male deaths in the UK for 72 successive months are plotted.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="ggplot2.html#cb25-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> deaths, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> deaths, <span class="dt">linetype=</span>sex)) <span class="op">+</span></span>
<span id="cb25-2"><a href="ggplot2.html#cb25-2"></a><span class="st">    </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/linecolor-dim-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="size" class="section level3 unnumbered">
<h3>Size</h3>
<p>The size of the plotting symbol can also be used as an extra “dimension” in your visualization. Here is an example showing the solar radiation of the airquality data as third dimension.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="ggplot2.html#cb26-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">na.omit</span>(airquality), </span>
<span id="cb26-2"><a href="ggplot2.html#cb26-2"></a>       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Wind, <span class="dt">y =</span> Ozone, <span class="dt">size=</span>Solar.R)) <span class="op">+</span></span>
<span id="cb26-3"><a href="ggplot2.html#cb26-3"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>, <span class="dt">alpha=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/sizes-demo-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="geometries" class="section level2">
<h2><span class="header-section-number">1.6</span> Geometries</h2>
<div id="what-are-geometries" class="section level3 unnumbered">
<h3>What are geometries</h3>
<p>Geometries are the ways data can be visually represented. Boxplot, scatterplot and histogram are a few examples. There are <strong><em>many</em></strong> geoms available in ggplot2; type <code>geom_</code> in the console and you will get a listing. Even more are available outside the ggplot2 package. Here we’ll only explore a few.</p>
</div>
<div id="boxplot" class="section level3 unnumbered">
<h3>Boxplot</h3>
<p>Boxplot is one of the most-used data visualizations. It displays the 5-number summary containing from bottom to top: minimum, first quartile, median (= second quartile), third quartile, maximum. Outliers, usually defined as more than <code>1.5 * IQR</code> from the median, are displayed as separate points. Some color was added in the example below.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="ggplot2.html#cb27-1"></a>dr_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dose_response_tidy, <span class="kw">aes</span>(<span class="dt">x =</span> dose, <span class="dt">y =</span> response))</span>
<span id="cb27-2"><a href="ggplot2.html#cb27-2"></a>dr_plot <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="dt">fill=</span><span class="st">&#39;#E69F00&#39;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/plot_geom_boxplot-1.png" width="576" /></p>
</div>
<div id="jitter" class="section level3 unnumbered">
<h3>Jitter</h3>
<p>Jitter is a good alternative to boxplot when you have small sample sizes, or discrete measurements with many exact copies, resulting in much overlap. Use the width and height attributes to adjust the jittering.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="ggplot2.html#cb28-1"></a>dr_plot <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">0.1</span>, <span class="dt">height =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/plot_geom_jitter-1.png" width="576" /></p>
<p>Here, a split over the sexes is added. Suddenly, a dramatic dosage effect becomes apparent that was smoothed out when the two sexes were combined.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="ggplot2.html#cb29-1"></a>dr_plot <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">0.1</span>, <span class="dt">height =</span> <span class="dv">0</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> sex))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/plot_tidy_color-1.png" width="672" /></p>
<p>Alternatively, use a grid of plots</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="ggplot2.html#cb30-1"></a>dr_plot <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-2"><a href="ggplot2.html#cb30-2"></a><span class="st">    </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">0.1</span>, <span class="dt">height =</span> <span class="dv">0</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> sex)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-3"><a href="ggplot2.html#cb30-3"></a><span class="st">    </span><span class="kw">facet_wrap</span>( . <span class="op">~</span><span class="st"> </span>sex)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/plot_tidy_facet-1.png" width="672" /></p>
</div>
<div id="plot-overlays-boxplot-jitter" class="section level3 unnumbered">
<h3>Plot overlays: boxplot + jitter</h3>
<p>This example shows how you can overlay plots on top of each other as much as you like.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="ggplot2.html#cb31-1"></a>dr_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dose_response_tidy, <span class="kw">aes</span>(<span class="dt">x =</span> dose, <span class="dt">y =</span> response))</span>
<span id="cb31-2"><a href="ggplot2.html#cb31-2"></a>dr_plot <span class="op">+</span><span class="st"> </span></span>
<span id="cb31-3"><a href="ggplot2.html#cb31-3"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">fill=</span><span class="st">&#39;#E69F00&#39;</span>) <span class="op">+</span></span>
<span id="cb31-4"><a href="ggplot2.html#cb31-4"></a><span class="st">    </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">0.1</span>, <span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/plot-overlays-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="scatterplot-points" class="section level3 unnumbered">
<h3>Scatterplot: Points</h3>
<p>The <code>geom_point()</code> function is used to create the good old scatterplot of which we have seen several examples already.</p>
</div>
<div id="line-plots" class="section level3 unnumbered">
<h3>Line plots</h3>
<p>When points can be logically connected it may be a good idea to use a line to visualize trends, as we have seen in the <code>deaths</code> plot in section <a href="#Aesthetics"><strong>??</strong></a></p>
</div>
<div id="histograms" class="section level3 unnumbered">
<h3>Histograms</h3>
<p>A histogram is a means to visualize a distribution.</p>
<p>Here we look at the eruption intervals of the “faithful” geyser. A <code>binwidth</code> argument is used to adjust the number of bins. Alternative use the <code>bins</code> argument.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="ggplot2.html#cb32-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>faithful, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> waiting)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-2"><a href="ggplot2.html#cb32-2"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/histogram1-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>There are some statistics available to adjust what is shown on the y axis. The default that is used by <code>geom_histogram</code> is <code>stat(count)</code>, so if you don’t specify anything this will be used. But if you want it scaled to a maximum of 1, use <code>stat(count / max(count))</code>. The <code>stat()</code> function is a flag to ggplot2 that you want to use calculated aesthetics produced by the statistic.You can use any transformation of the statistic, e.g. <code>y = stat(log2(count))</code>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="ggplot2.html#cb33-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>faithful, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> waiting)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-2"><a href="ggplot2.html#cb33-2"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">3</span>, <span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">stat</span>(count <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(count)))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-3"><a href="ggplot2.html#cb33-3"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="dt">label =</span> <span class="st">&quot;normalized proportion&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/histogram2-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Alternatively, if you want percentages, you can use <code>y = stat(count / sum(count) * 100)</code>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="ggplot2.html#cb34-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>faithful, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> waiting)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-2"><a href="ggplot2.html#cb34-2"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">3</span>, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">stat</span>(count <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(count) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-3"><a href="ggplot2.html#cb34-3"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="dt">label =</span> <span class="st">&quot;%&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/histogram3-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="violin-plot" class="section level3 unnumbered">
<h3>Violin plot</h3>
<p>A violin plot is a compact display of a continuous distribution. It is a blend of geom_boxplot() and geom_density(): a violin plot is a mirrored density plot displayed in the same way as a boxplot. It is not seen as often as should be. An example best explains.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="ggplot2.html#cb35-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>airquality, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Month, <span class="dt">y =</span> Temp, <span class="dt">fill=</span>Month)) <span class="op">+</span></span>
<span id="cb35-2"><a href="ggplot2.html#cb35-2"></a><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/violinplot-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="barplot" class="section level3 unnumbered">
<h3>Barplot</h3>
<p>The bar plot is similar to a histogram in appearance, but quite different in intent. Where a histogram visualizes the density of a continuous variable, a bar plot tries to visualize the counts or weights of distinct groups.</p>
<p>Here is a small example where the ten subjects of the <code>sleep</code> dataset have been charted (the x axis), and the <code>extra</code> column provided the height of the bar, split over the two groups. When no weight is provided, the occurrences of the different group levels will be counted and sued as weight.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="ggplot2.html#cb36-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> sleep,</span>
<span id="cb36-2"><a href="ggplot2.html#cb36-2"></a>       <span class="dt">mapping =</span> <span class="kw">aes</span>(ID)) <span class="op">+</span></span>
<span id="cb36-3"><a href="ggplot2.html#cb36-3"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">weight =</span> extra, <span class="dt">fill =</span> group))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/barplot1-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="overview-of-the-main-geoms" class="section level3 unnumbered">
<h3>Overview of the main geoms</h3>
<p>There are many geoms and even more outside the ggplot2 package.
Here is a small overview of some of them.</p>
<table>
<caption><span id="tab:ggplot2-building-blocks-2">Table 1.2: </span>Some more geoms</caption>
<colgroup>
<col width="11%" />
<col width="88%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">function.</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">geom_abline()</td>
<td align="left">Add reference lines to a plot, either horizontal, vertical, or diagonal</td>
</tr>
<tr class="even">
<td align="left">geom_bar()</td>
<td align="left">A bar plot makes the height of the bar proportional to the number of cases in each group</td>
</tr>
<tr class="odd">
<td align="left">geom_density()</td>
<td align="left">Computes and draws kernel density estimate, which is a smoothed version of the histogram</td>
</tr>
<tr class="even">
<td align="left">geom_line()</td>
<td align="left">Connects the observations in order of the variable on the x axis</td>
</tr>
<tr class="odd">
<td align="left">geom_path()</td>
<td align="left">Connects the observations in the order in which they appear in the data</td>
</tr>
<tr class="even">
<td align="left">geom_qq()</td>
<td align="left">geom_qq and stat_qq produce quantile-quantile plots</td>
</tr>
<tr class="odd">
<td align="left">geom_smooth()</td>
<td align="left">Aids the eye in seeing patterns in the presence of overplotting</td>
</tr>
<tr class="even">
<td align="left">geom_violin()</td>
<td align="left">A violin plot is a compact display of a continuous distribution. It is a blend of geom_boxplot() and geom_density()</td>
</tr>
</tbody>
</table>
<p>If you want to know them all, simply type <code>?geom_</code> and select the one that looks like the thing you want.</p>
</div>
</div>
<div id="inheritance-of-aesthetics" class="section level2">
<h2><span class="header-section-number">1.7</span> Inheritance of aesthetics</h2>
<p>Like the main <code>ggplot()</code> function, every <code>geom_</code> function accepts its own <code>mapping = aes(...)</code>. The mapping is <em>inherited</em> from the ggplot() function, but you can specify your own “local” aesthetic mapping. Aesthetics defined within a geom_ function are scoped to that function only.</p>
<p>In the plot below you see how this works (it is not a nice plot anymore, I know).
Note that any aesthetic value specified outside the aes() function is simply a static property (in that scope).</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="ggplot2.html#cb37-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> airquality, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Solar.R, <span class="dt">y =</span> Ozone)) <span class="op">+</span></span>
<span id="cb37-2"><a href="ggplot2.html#cb37-2"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> Month), <span class="dt">method=</span><span class="st">&quot;lm&quot;</span>) <span class="op">+</span></span>
<span id="cb37-3"><a href="ggplot2.html#cb37-3"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Month), <span class="dt">alpha =</span> <span class="fl">0.7</span>) </span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdown-demo_files/figure-html/inheritace-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="faceting" class="section level2">
<h2><span class="header-section-number">1.8</span> Faceting</h2>
<p>Faceting is the process of splitting into multiple plots with exactly the same coordinate system where each plot show a subset of the data. It can be applied to any geom. The figure above could be improved slightly with this technique.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="ggplot2.html#cb39-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> airquality, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Solar.R, <span class="dt">y =</span> Ozone)) <span class="op">+</span></span>
<span id="cb39-2"><a href="ggplot2.html#cb39-2"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> Month), <span class="dt">method=</span><span class="st">&quot;lm&quot;</span>) <span class="op">+</span></span>
<span id="cb39-3"><a href="ggplot2.html#cb39-3"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Month), <span class="dt">alpha =</span> <span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>Month)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdown-demo_files/figure-html/facetting-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="experimenting-with-geoms-and-aesthetics" class="section level2">
<h2><span class="header-section-number">1.9</span> Experimenting with geoms and aesthetics</h2>
<p>The process in plotting using ggplot2 is usually very iterative.<br />
You start with the base plot, passing it the <strong><em>aesthetic</em></strong> for x and y, as shown above, and then experiment with <strong><em>geometries</em></strong>, <strong><em>colors</em></strong> and <strong><em>faceting</em></strong>.</p>
<p>Look at every result and ask yourself</p>
<ul>
<li>what story does is tell?</li>
<li>is it the story you seek to tell?</li>
</ul>
<p>Only after you finish this phase you should apply make-up (labels, texts).
Maybe new questions have arisen as a result of the plot you created?</p>
</div>
<div id="multivariate-categorical-data" class="section level2">
<h2><span class="header-section-number">1.10</span> Multivariate Categorical Data</h2>
<p>Visualizing multivariate categorical data requires another approach. Scatter- and line plots and histograms are all unsuitable for factor data. Here are some plotting examples that work well for categorical data. Copied and adapted from <a href="http://www.sthda.com/english/articles/32-r-graphics-essentials/129-visualizing-multivariate-categorical-data/">STHDA site</a>.</p>
<p>The first example deals with the builtin dataset <code>HairEyeColor</code>. It is a contingency table and a <code>table</code> object so it must be converted into a dataframe before use.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="ggplot2.html#cb41-1"></a>hair_eye_col_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(HairEyeColor)</span>
<span id="cb41-2"><a href="ggplot2.html#cb41-2"></a><span class="kw">head</span>(hair_eye_col_df)</span></code></pre></div>
<pre><code>##    Hair   Eye  Sex Freq
## 1 Black Brown Male   32
## 2 Brown Brown Male   53
## 3   Red Brown Male   10
## 4 Blond Brown Male    3
## 5 Black  Blue Male   11
## 6 Brown  Blue Male   50</code></pre>
<div id="bar-plots-of-contingency-tables" class="section level3">
<h3><span class="header-section-number">1.10.1</span> Bar plots of contingency tables</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="ggplot2.html#cb43-1"></a><span class="kw">ggplot</span>(hair_eye_col_df, <span class="kw">aes</span>(<span class="dt">x =</span> Hair, <span class="dt">y =</span> Freq)) <span class="op">+</span></span>
<span id="cb43-2"><a href="ggplot2.html#cb43-2"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Eye), </span>
<span id="cb43-3"><a href="ggplot2.html#cb43-3"></a>           <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, </span>
<span id="cb43-4"><a href="ggplot2.html#cb43-4"></a>           <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb43-5"><a href="ggplot2.html#cb43-5"></a>           <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.7</span>)) <span class="op">+</span><span class="st"> </span><span class="co">#causes overlapping bars</span></span>
<span id="cb43-6"><a href="ggplot2.html#cb43-6"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Sex) </span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/faceted-barplot-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="balloon-plot" class="section level3">
<h3><span class="header-section-number">1.10.2</span> Balloon plot</h3>
<p>Here is a dataset called housetasks that contains data on who does what tasks within the household.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="ggplot2.html#cb44-1"></a>(housetasks &lt;-<span class="st"> </span><span class="kw">read.delim</span>(</span>
<span id="cb44-2"><a href="ggplot2.html#cb44-2"></a>  <span class="kw">system.file</span>(<span class="st">&quot;demo-data/housetasks.txt&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;ggpubr&quot;</span>),</span>
<span id="cb44-3"><a href="ggplot2.html#cb44-3"></a>  <span class="dt">row.names =</span> <span class="dv">1</span></span>
<span id="cb44-4"><a href="ggplot2.html#cb44-4"></a>  ))</span></code></pre></div>
<pre><code>##            Wife Alternating Husband Jointly
## Laundry     156          14       2       4
## Main_meal   124          20       5       4
## Dinner       77          11       7      13
## Breakfeast   82          36      15       7
## Tidying      53          11       1      57
## Dishes       32          24       4      53
## Shopping     33          23       9      55
## Official     12          46      23      15
## Driving      10          51      75       3
## Finances     13          13      21      66
## Insurance     8           1      53      77
## Repairs       0           3     160       2
## Holidays      0           1       6     153</code></pre>
<p>A balloon plot is an excellent way to visualize this kind of data:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="ggplot2.html#cb46-1"></a>ggpubr<span class="op">::</span><span class="kw">ggballoonplot</span>(housetasks, </span>
<span id="cb46-2"><a href="ggplot2.html#cb46-2"></a>              <span class="dt">fill =</span> <span class="st">&quot;value&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/balloonplot1-1.png" width="80%" style="display: block; margin: auto;" />
As you can see the counts map to both size and color.
Balloon plots can also be faceted.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="ggplot2.html#cb47-1"></a>ggpubr<span class="op">::</span><span class="kw">ggballoonplot</span>(hair_eye_col_df, <span class="dt">x =</span> <span class="st">&quot;Hair&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Eye&quot;</span>, <span class="dt">size =</span> <span class="st">&quot;Freq&quot;</span>,</span>
<span id="cb47-2"><a href="ggplot2.html#cb47-2"></a>              <span class="dt">fill =</span> <span class="st">&quot;Freq&quot;</span>, <span class="dt">facet.by =</span> <span class="st">&quot;Sex&quot;</span>,</span>
<span id="cb47-3"><a href="ggplot2.html#cb47-3"></a>              <span class="dt">ggtheme =</span> <span class="kw">theme_bw</span>()) <span class="op">+</span></span>
<span id="cb47-4"><a href="ggplot2.html#cb47-4"></a><span class="st">  </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;C&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/balloonplot2-1.png" width="80%" style="display: block; margin: auto;" />
### Mosaic plot</p>
<p>A mosaic plot (library vcd) scales the tiles according to the count.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="ggplot2.html#cb48-1"></a><span class="kw">library</span>(vcd)</span></code></pre></div>
<pre><code>## Loading required package: grid</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="ggplot2.html#cb50-1"></a><span class="kw">mosaic</span>(HairEyeColor, <span class="co">#needs the table object</span></span>
<span id="cb50-2"><a href="ggplot2.html#cb50-2"></a>       <span class="dt">shade =</span> <span class="ot">TRUE</span>, </span>
<span id="cb50-3"><a href="ggplot2.html#cb50-3"></a>       <span class="dt">legend =</span> <span class="ot">TRUE</span>) </span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/mosaic-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="correspondence-analysis" class="section level3">
<h3><span class="header-section-number">1.10.3</span> Correspondence analysis</h3>
<p>This type needs at least 3 columns, otherwise you get hard-to solve errors!
Row names should not be in the first column, but assigned as <code>row.names</code>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="ggplot2.html#cb51-1"></a><span class="kw">library</span>(FactoMineR)</span>
<span id="cb51-2"><a href="ggplot2.html#cb51-2"></a><span class="kw">library</span>(factoextra)</span></code></pre></div>
<pre><code>## Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="ggplot2.html#cb53-1"></a>res.ca &lt;-<span class="st"> </span><span class="kw">CA</span>(housetasks, <span class="dt">graph =</span> <span class="ot">FALSE</span>)</span>
<span id="cb53-2"><a href="ggplot2.html#cb53-2"></a><span class="kw">fviz_ca_biplot</span>(res.ca, <span class="dt">repel =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/correspondence-analysis-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="advanced-plotting-aspects" class="section level2">
<h2><span class="header-section-number">1.11</span> Advanced plotting aspects</h2>
<div id="plot-panels-from-for-loops-using-gridextragrid.arrange" class="section level3">
<h3><span class="header-section-number">1.11.1</span> Plot panels from <code>for</code> loops using <code>gridExtra::grid.arrange()</code></h3>
<p>Sometimes you may wish to create a panel of plots using a <code>for</code> loop, similarly to the use of <code>par(mfrow = c(rwos, cols))</code> in base R. There are a few caveats to this seemingly simple notion.</p>
<p>For instance, to create a set of boxplots for a few columns of the <code>airquality</code> dataset, you would do something like this in base R:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="ggplot2.html#cb54-1"></a><span class="co"># set the number of rows and columns</span></span>
<span id="cb54-2"><a href="ggplot2.html#cb54-2"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb54-3"><a href="ggplot2.html#cb54-3"></a></span>
<span id="cb54-4"><a href="ggplot2.html#cb54-4"></a><span class="co"># iterate the column names</span></span>
<span id="cb54-5"><a href="ggplot2.html#cb54-5"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="kw">names</span>(airquality[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])) {</span>
<span id="cb54-6"><a href="ggplot2.html#cb54-6"></a>    <span class="kw">boxplot</span>(airquality[, n], </span>
<span id="cb54-7"><a href="ggplot2.html#cb54-7"></a>            <span class="dt">xlab =</span> n)</span>
<span id="cb54-8"><a href="ggplot2.html#cb54-8"></a>}</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/panel-plots-base-R-1.png" width="672" /></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="ggplot2.html#cb55-1"></a><span class="co"># reset par</span></span>
<span id="cb55-2"><a href="ggplot2.html#cb55-2"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>When you naively migrate this structure to a ggplot setting, it will become something like this.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="ggplot2.html#cb56-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb56-2"><a href="ggplot2.html#cb56-2"></a></span>
<span id="cb56-3"><a href="ggplot2.html#cb56-3"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="kw">names</span>(airquality[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])) {</span>
<span id="cb56-4"><a href="ggplot2.html#cb56-4"></a>    plt &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> airquality,</span>
<span id="cb56-5"><a href="ggplot2.html#cb56-5"></a>                  <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> n)) <span class="op">+</span></span>
<span id="cb56-6"><a href="ggplot2.html#cb56-6"></a><span class="st">        </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb56-7"><a href="ggplot2.html#cb56-7"></a><span class="st">        </span><span class="kw">xlab</span>(n)</span>
<span id="cb56-8"><a href="ggplot2.html#cb56-8"></a>    <span class="kw">print</span>(plt)</span>
<span id="cb56-9"><a href="ggplot2.html#cb56-9"></a>}</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/panel-plots-ggplot-1-1.png" width="30%" /><img src="bookdown-demo_files/figure-html/panel-plots-ggplot-1-2.png" width="30%" /><img src="bookdown-demo_files/figure-html/panel-plots-ggplot-1-3.png" width="30%" /><img src="bookdown-demo_files/figure-html/panel-plots-ggplot-1-4.png" width="30%" /></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="ggplot2.html#cb57-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>This is surely not the plot you would have expected: a single straight line, and no panel of plots. It turns out you can not use variables as selectors in <code>aes()</code>. You need to use <code>aes_string()</code> for that purpose.
Also note that if you omit the <code>print(plt)</code> call this outputs <em>nothing</em>, which is really quite confusing. You need to explicitely print the plot, not implicitly as you normally can.<br />
Here is a second version.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="ggplot2.html#cb58-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb58-2"><a href="ggplot2.html#cb58-2"></a></span>
<span id="cb58-3"><a href="ggplot2.html#cb58-3"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="kw">names</span>(airquality[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])) {</span>
<span id="cb58-4"><a href="ggplot2.html#cb58-4"></a>    plt &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> airquality,</span>
<span id="cb58-5"><a href="ggplot2.html#cb58-5"></a>                  <span class="dt">mapping =</span> <span class="kw">aes_string</span>(<span class="dt">y =</span> n)) <span class="op">+</span></span>
<span id="cb58-6"><a href="ggplot2.html#cb58-6"></a><span class="st">        </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb58-7"><a href="ggplot2.html#cb58-7"></a><span class="st">        </span><span class="kw">xlab</span>(n)</span>
<span id="cb58-8"><a href="ggplot2.html#cb58-8"></a>    <span class="kw">print</span>(plt)</span>
<span id="cb58-9"><a href="ggplot2.html#cb58-9"></a>}</span></code></pre></div>
<pre><code>## Warning: Removed 37 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="bookdown-demo_files/figure-html/panel-plots-ggplot-2-1.png" width="30%" /></p>
<pre><code>## Warning: Removed 7 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="bookdown-demo_files/figure-html/panel-plots-ggplot-2-2.png" width="30%" /><img src="bookdown-demo_files/figure-html/panel-plots-ggplot-2-3.png" width="30%" /><img src="bookdown-demo_files/figure-html/panel-plots-ggplot-2-4.png" width="30%" /></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="ggplot2.html#cb61-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>This works as required except for the panel-of-plots part. The <code>mfrow</code> option to <code>par()</code> does not work with <code>ggplot2</code>. This can be fixed by the use of the <code>gridExtra</code> package, together with the base R <code>do.call()</code> function.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="ggplot2.html#cb62-1"></a><span class="kw">library</span>(gridExtra)</span>
<span id="cb62-2"><a href="ggplot2.html#cb62-2"></a><span class="co"># a list to store the plots</span></span>
<span id="cb62-3"><a href="ggplot2.html#cb62-3"></a>my_plots &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb62-4"><a href="ggplot2.html#cb62-4"></a></span>
<span id="cb62-5"><a href="ggplot2.html#cb62-5"></a></span>
<span id="cb62-6"><a href="ggplot2.html#cb62-6"></a><span class="co">#use of indices instead of names is important!</span></span>
<span id="cb62-7"><a href="ggplot2.html#cb62-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb62-8"><a href="ggplot2.html#cb62-8"></a>    n &lt;-<span class="st"> </span><span class="kw">names</span>(airquality)[i]</span>
<span id="cb62-9"><a href="ggplot2.html#cb62-9"></a>    <span class="co">#omitting rows with NA for each single column</span></span>
<span id="cb62-10"><a href="ggplot2.html#cb62-10"></a>    plt &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> airquality[<span class="op">!</span><span class="kw">is.na</span>(airquality[, n]), ],</span>
<span id="cb62-11"><a href="ggplot2.html#cb62-11"></a>                  <span class="dt">mapping =</span> <span class="kw">aes_string</span>(<span class="dt">y =</span> n)) <span class="op">+</span></span>
<span id="cb62-12"><a href="ggplot2.html#cb62-12"></a><span class="st">        </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb62-13"><a href="ggplot2.html#cb62-13"></a><span class="st">        </span><span class="kw">xlab</span>(n)</span>
<span id="cb62-14"><a href="ggplot2.html#cb62-14"></a>    my_plots[[i]] &lt;-<span class="st"> </span>plt   <span class="co"># has to be integer, not name!</span></span>
<span id="cb62-15"><a href="ggplot2.html#cb62-15"></a>}</span>
<span id="cb62-16"><a href="ggplot2.html#cb62-16"></a><span class="co">#use do.call() to process the list in grid.arrange</span></span>
<span id="cb62-17"><a href="ggplot2.html#cb62-17"></a><span class="kw">do.call</span>(grid.arrange, <span class="kw">c</span>(my_plots, <span class="dt">nrow =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/panel-plots-ggplot-3-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>So the rules for useage of a for-loop to create a panel of plots:</p>
<ul>
<li>use <code>aes_string()</code> to specify your columns</li>
<li>store the plots in a list</li>
<li>use <code>grid.arrange()</code> to create the panel, wrapped in the <code>do.call()</code> function.</li>
</ul>
</div>
<div id="the-ggallyggpairs-function" class="section level3">
<h3><span class="header-section-number">1.11.2</span> The <code>GGally::ggPairs()</code> function</h3>
</div>
<div id="marginal-plots-using-ggextraggmarginal" class="section level3">
<h3><span class="header-section-number">1.11.3</span> Marginal plots using <code>ggExtra::ggMarginal()</code></h3>
</div>
</div>
<div id="final-tweaks" class="section level2">
<h2><span class="header-section-number">1.12</span> Final tweaks</h2>
<p>This section describes aspects that fall outside the standard realm of plot construction.</p>
<div id="scales-coordinates-and-annotations" class="section level3 unnumbered">
<h3>Scales, Coordinates and Annotations</h3>
<p>Scales and Coordinates are used to adjust the way your data is mapped and displayed. Here, a log10 scale is applied to the y axis using <code>scale_y_log10()</code> and the x axis is reversed (from high to low values instead of low to high) using <code>scale_x_reverse()</code>.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="ggplot2.html#cb63-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> cars, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> speed, <span class="dt">y =</span> dist)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb63-2"><a href="ggplot2.html#cb63-2"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb63-3"><a href="ggplot2.html#cb63-3"></a><span class="st">    </span><span class="kw">scale_y_log10</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb63-4"><a href="ggplot2.html#cb63-4"></a><span class="st">    </span><span class="kw">scale_x_reverse</span>() </span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/tweeking-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>In other contexts, such as geographic information analysis, the scale is extremely important.
The default coordinate system in ggplot2 is <code>coord_cartesian()</code>. In the plot below, a different coordinate system is used.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="ggplot2.html#cb64-1"></a><span class="co"># function to compute standard error of mean</span></span>
<span id="cb64-2"><a href="ggplot2.html#cb64-2"></a>se &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sqrt</span>(<span class="kw">var</span>(x)<span class="op">/</span><span class="kw">length</span>(x)) </span>
<span id="cb64-3"><a href="ggplot2.html#cb64-3"></a></span>
<span id="cb64-4"><a href="ggplot2.html#cb64-4"></a>DF &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">variable =</span> <span class="kw">as.factor</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>), <span class="dt">value =</span> <span class="kw">log2</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">11</span>))</span>
<span id="cb64-5"><a href="ggplot2.html#cb64-5"></a></span>
<span id="cb64-6"><a href="ggplot2.html#cb64-6"></a><span class="kw">ggplot</span>(DF, <span class="kw">aes</span>(variable, value, <span class="dt">fill =</span> variable)) <span class="op">+</span></span>
<span id="cb64-7"><a href="ggplot2.html#cb64-7"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb64-8"><a href="ggplot2.html#cb64-8"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> value <span class="op">-</span><span class="st"> </span><span class="kw">se</span>(DF<span class="op">$</span>value), </span>
<span id="cb64-9"><a href="ggplot2.html#cb64-9"></a>                      <span class="dt">ymax =</span> value <span class="op">+</span><span class="st"> </span><span class="kw">se</span>(DF<span class="op">$</span>value), </span>
<span id="cb64-10"><a href="ggplot2.html#cb64-10"></a>                      <span class="dt">color =</span> variable), </span>
<span id="cb64-11"><a href="ggplot2.html#cb64-11"></a>                      <span class="dt">width =</span> <span class="fl">.2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb64-12"><a href="ggplot2.html#cb64-12"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="kw">nlevels</span>(DF<span class="op">$</span>variable)) <span class="op">+</span></span>
<span id="cb64-13"><a href="ggplot2.html#cb64-13"></a><span class="st">    </span><span class="kw">coord_polar</span>() </span></code></pre></div>
<pre><code>## Warning: Use of `DF$value` is discouraged. Use `value` instead.

## Warning: Use of `DF$value` is discouraged. Use `value` instead.</code></pre>
<p><img src="bookdown-demo_files/figure-html/polarplot-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="labels" class="section level3 unnumbered">
<h3>Labels</h3>
<p>You have seen the <code>xlab()</code>, <code>ylab()</code>, and <code>labs()</code> functions at work already.</p>
</div>
<div id="themes" class="section level3 unnumbered">
<h3>Themes</h3>
<p>The theme is used to make changes to the overall appearance of the plot. Two approaches exist. The simplest one is selecting a specific theme and make some minor adjustments at most.
Here are is the minimal theme where the text sizes have been modified somewhat.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="ggplot2.html#cb66-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> airquality, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>Temp, <span class="dt">y=</span>Ozone)) <span class="op">+</span></span>
<span id="cb66-2"><a href="ggplot2.html#cb66-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">color=</span>Month)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb66-3"><a href="ggplot2.html#cb66-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;loess&quot;</span>) <span class="op">+</span></span>
<span id="cb66-4"><a href="ggplot2.html#cb66-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="st">&quot;Temperature &quot;</span> (degree<span class="op">~</span>F))) <span class="op">+</span></span>
<span id="cb66-5"><a href="ggplot2.html#cb66-5"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Ozone (ppb)&quot;</span>) <span class="op">+</span></span>
<span id="cb66-6"><a href="ggplot2.html#cb66-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">color=</span><span class="st">&quot;Month&quot;</span>) <span class="op">+</span></span>
<span id="cb66-7"><a href="ggplot2.html#cb66-7"></a><span class="st">  </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">14</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 37 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 37 rows containing missing values (geom_point).</code></pre>
<p><img src="bookdown-demo_files/figure-html/themes1-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Note that if the <code>color = Month</code> aesthetic would have been put in the main ggplot call, the smoother would have been split over the Month groups.</p>
<p>Alternatively, the theme can be specified completely, as show below.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="ggplot2.html#cb70-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> airquality, <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>Temp, <span class="dt">y=</span>Ozone)) <span class="op">+</span></span>
<span id="cb70-2"><a href="ggplot2.html#cb70-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">color=</span>Month)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb70-3"><a href="ggplot2.html#cb70-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;loess&quot;</span>) <span class="op">+</span></span>
<span id="cb70-4"><a href="ggplot2.html#cb70-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Temperature (F)&quot;</span>) <span class="op">+</span></span>
<span id="cb70-5"><a href="ggplot2.html#cb70-5"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Ozone (ppb)&quot;</span>) <span class="op">+</span></span>
<span id="cb70-6"><a href="ggplot2.html#cb70-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">color=</span><span class="st">&quot;Month&quot;</span>) <span class="op">+</span></span>
<span id="cb70-7"><a href="ggplot2.html#cb70-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb70-8"><a href="ggplot2.html#cb70-8"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb70-9"><a href="ggplot2.html#cb70-9"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>, <span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">face =</span> <span class="st">&quot;bold.italic&quot;</span>),</span>
<span id="cb70-10"><a href="ggplot2.html#cb70-10"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">face =</span> <span class="st">&quot;bold.italic&quot;</span>),</span>
<span id="cb70-11"><a href="ggplot2.html#cb70-11"></a>        <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>),</span>
<span id="cb70-12"><a href="ggplot2.html#cb70-12"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>),</span>
<span id="cb70-13"><a href="ggplot2.html#cb70-13"></a>        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 37 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 37 rows containing missing values (geom_point).</code></pre>
<p><img src="bookdown-demo_files/figure-html/themes2-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>As you can see, there are <code>element_text()</code>, <code>element_line()</code> and <code>element_rect()</code> functions to specify these types of plot elements. The <code>element_blank()</code> function can be used in various theme aspects to prevent it from being displayed.</p>
<div id="adjust-or-set-global-theme" class="section level4">
<h4><span class="header-section-number">1.12.0.1</span> Adjust or set global theme</h4>
<p>You can specify within your document or R session that a certain theme should be used throughout. You can do this by using the <code>theme_set()</code>, <code>theme_update()</code> and <code>theme_replace()</code> functions, or with the esoteric <code>%+replace%</code> operator. Type <code>?theme_set</code> to find out more.</p>
</div>
</div>
<div id="annotation" class="section level3 unnumbered">
<h3>Annotation</h3>
<p>A final layer that can be added one containing <strong><em>annotations</em></strong>. Annotations are elements that are added manually to the plot. This can be a text label, a fictitious data point, a shaded box or an arrow indicating a region of interest.</p>
<p>In the <code>annotate()</code> method, you specify the geom you wish to add (e.g. “text”, “point”)
The panel below demonstrates a few.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="ggplot2.html#cb74-1"></a>(outlier &lt;-<span class="st"> </span>airquality[<span class="op">!</span><span class="kw">is.na</span>(airquality<span class="op">$</span>Ozone) <span class="op">&amp;</span><span class="st"> </span>airquality<span class="op">$</span>Ozone <span class="op">&gt;</span><span class="st"> </span><span class="dv">150</span>, ])</span></code></pre></div>
<pre><code>##     Ozone Solar.R Wind Temp Month Day TempFac
## 117   168     238  3.4   81   Aug  25    high</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="ggplot2.html#cb76-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">na.omit</span>(airquality), <span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">x=</span>Temp, <span class="dt">y=</span>Ozone)) <span class="op">+</span></span>
<span id="cb76-2"><a href="ggplot2.html#cb76-2"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin=</span><span class="dv">72</span>, <span class="dt">xmax=</span><span class="dv">77</span>, <span class="dt">ymin=</span><span class="dv">0</span>, <span class="dt">ymax=</span><span class="dv">50</span>, </span>
<span id="cb76-3"><a href="ggplot2.html#cb76-3"></a>           <span class="dt">alpha=</span><span class="fl">0.1</span>, <span class="dt">color=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb76-4"><a href="ggplot2.html#cb76-4"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;point&quot;</span>, <span class="dt">x =</span> outlier<span class="op">$</span>Temp, <span class="dt">y =</span> outlier<span class="op">$</span>Ozone, </span>
<span id="cb76-5"><a href="ggplot2.html#cb76-5"></a>           <span class="dt">color =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb76-6"><a href="ggplot2.html#cb76-6"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping=</span><span class="kw">aes</span>(<span class="dt">color=</span>Month)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb76-7"><a href="ggplot2.html#cb76-7"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;loess&quot;</span>) <span class="op">+</span></span>
<span id="cb76-8"><a href="ggplot2.html#cb76-8"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Temperature (F)&quot;</span>) <span class="op">+</span></span>
<span id="cb76-9"><a href="ggplot2.html#cb76-9"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Ozone (ppb)&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb76-10"><a href="ggplot2.html#cb76-10"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> outlier<span class="op">$</span>Temp, <span class="dt">y =</span> outlier<span class="op">$</span>Ozone <span class="dv">-5</span>, <span class="dt">label =</span> <span class="st">&quot;Outlier&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb76-11"><a href="ggplot2.html#cb76-11"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="dt">x =</span> outlier<span class="op">$</span>Temp <span class="op">+</span><span class="st"> </span><span class="dv">5</span>, <span class="dt">xend =</span> outlier<span class="op">$</span>Temp <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, </span>
<span id="cb76-12"><a href="ggplot2.html#cb76-12"></a>           <span class="dt">y =</span> outlier<span class="op">$</span>Ozone <span class="op">+</span><span class="st"> </span><span class="dv">4</span>, <span class="dt">yend =</span> outlier<span class="op">$</span>Ozone, </span>
<span id="cb76-13"><a href="ggplot2.html#cb76-13"></a>           <span class="dt">color =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">arrow =</span> <span class="kw">arrow</span>()) </span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdown-demo_files/figure-html/annotation-1.png" width="80%" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-tidy-data">
<p>Wickham, Hadley. 2014. “Tidy Data.” <em>The Journal of Statistical Software</em> 59 (10). <a href="http://www.jstatsoft.org/v59/i10/">http://www.jstatsoft.org/v59/i10/</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="developing-a-custom-visualization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-ggplot2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
